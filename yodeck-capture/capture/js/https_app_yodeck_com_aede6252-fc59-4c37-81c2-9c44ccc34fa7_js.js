var window={"VWO":{"_":{}},"location":{"href":"https://app.yodeck.com/login","search":""},"_vwoCc":{"dAM":1}},document={"cookie":"csrftoken=EcoA6ieiVMOx0gAAaBMkfdiQWVosoOkU; _vwo_uuid_v2=D94FCA3A04ED2865DC2DE06E3063799D0|174325c433214bf5b53340898b31286f","URL":"https://app.yodeck.com/login","referrer":""};window.document=document;(function(){"use strict";function e(e){}const t=self;function i(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{d(n.next(e))}catch(e){r(e)}}function a(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}d((n=n.apply(e,t||[])).next())})}window.setInterval=t.setInterval.bind(t),window.setTimeout=t.setTimeout.bind(t),window.clearInterval=t.clearInterval.bind(t),window.clearTimeout=t.clearTimeout.bind(t),window.addEventListener=t.addEventListener.bind(t),window.encodeURIComponent=t.encodeURIComponent.bind(t),window.decodeURIComponent=t.decodeURIComponent.bind(t),window.JSON=self.JSON,document=window.document,window.window=window,t._onMessage=e,window.workerThread=t,window.VWO.modules={vwoUtils:{cookies:{}},utils:{},tags:{},phoenixPlugins:{events:{predefinedEvents:{}}}};var n="function"==typeof SuppressedError?SuppressedError:function(e,t,i){var n=new Error(i);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};class s{formatErrorObject(e){return"string"==typeof e&&(e={msg:e}),e}setCustomError(e){const t=this;window.VWO._.customError=function(i){i=t.formatErrorObject(i),e(i)}}}const r=e=>{try{window.VWO._.customError(e)}catch(e){}};let o;const a={test:e=>{var t;return o=null===(t=window.VWO)||void 0===t?void 0:t.phoenix,window.workerThread&&o&&e===o.store.getters},transformer:function(e){return e===o.store.getters.settings.campaigns||e===o.store.getters.allSettings.dataStore.campaigns?"vwojFnGPlugCamp":e===o.store.getters.allSettings?"vwojFnGPlugAllSet":e},parse:(e,t)=>{if("vwojFnGPlugCamp"===t)return window._vwo_exp;if("vwojFnGPlugAllSet"===t){const e=Object.assign({},window.VWO._.allSettings);return delete e.triggers,delete e.tags,e}return t}},d=[a],l={stringify:function(e,t,i){try{return JSON.stringify(e,function(e,n){if(!i){const e=d.filter(e=>e.test(n));if(e.length>0){const i=t=>e.reduce((e,t)=>t.transformer(e),t);return JSON.parse(l.stringify(n,t,i))}}i&&(n=i(n));const s=e?this:t;var r;return n instanceof Function||"function"==typeof n?n.type==="vwoWrappedFn_"+(window.mainThread?"WT":"MT")?"_NuPreW"+n.name.slice(0,n.name.indexOf("_")+1):(r=n.toString()).length<8||"function"!==r.substring(0,8)?"_NuFrRa"+window.functionWrapper.wrap(n,s)+"_":"_NuFrNf"+window.functionWrapper.wrap(n,s)+"_":n instanceof RegExp?"_PxEgEr_"+n:n})}catch(e){return r({msg:"JSONfn.stringify failed!",url:"jsonFn.ts",source:e}),""}},parse:function(e,t){if(!e)return e;function i(e){const t=e+"_wrappedFn",i={[t](...t){const i={type:"callWrappedFunction",id:e,args:l.stringify(t)};return window.fetcher.request(i).send()}}[t];return i.type="vwoWrappedFn_"+(window.mainThread?"WT":"MT"),i}const n=!!t&&/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/;return JSON.parse(e,function(e,t){for(const i of d)t=i.parse(e,t);var s;if("string"!=typeof t)return t;if(t.length<8)return t;if(s=t.substring(0,7),n&&t.match(n))return new Date(t);if("_NuPreW"===s){const e=t.match(/_NuPreW([0-9]*)_/)[1];return window.functionWrapper.unwrap(e)}if("_NuFrNf"===s){const e=t.match(/_NuFrNf([0-9]*)_/)[1];return i(e)}if("_PxEgEr"===s)return eval(t.slice(8));if("_NuFrRa"===s){const e=+t.match(/_NuFrRa([0-9]*)_/)[1];return i(e)}return t})},clone:function(e,t){return this.parse(this.stringify(e),t)}};let c=0;const u={},g={};function h(e,t,i){const n=this.postMessage.bind(this);if("response"===(null==e?void 0:e.type)){const t=e;return{resolve:function(e){let i=t.encapsulatedData;const n=t.isErrorPresent;i&&(i="function"==typeof e?e(t.encapsulatedData):t.encapsulatedData),n?g[t.twoWayCommId](i):u[t.twoWayCommId](i)}}}{const s={type:"response",encapsulatedData:e,twoWayCommId:t,isErrorPresent:i};return{send:function(){try{return n(s),!0}catch(e){return!1}}}}}function v(e){if(this.sendingLayer=this.postMessage,"request"===(null==e?void 0:e.type)){const t=e,n=t.encapsulatedData;return{resolve:e=>i(this,void 0,void 0,function*(){try{const i=yield e(n);return h.call(this,i,t.twoWayCommId).send(),!0}catch(e){const i=l.stringify(e.message);return h.call(this,i,t.twoWayCommId,!0).send(),!1}})}}{const t={type:"request",encapsulatedData:e,twoWayCommId:++c};return{send:()=>new Promise((e,i)=>{try{u[t.twoWayCommId]=e,g[t.twoWayCommId]=i,this.sendingLayer(t)}catch(e){console.log(e),i(e)}})}}}var p;!function(e){e[e.Object=0]="Object",e[e.Property=1]="Property",e[e.Document=2]="Document",e[e.Variable=3]="Variable",e[e.OverWrite=4]="OverWrite",e[e.Delete=5]="Delete"}(p||(p={}));class w{constructor(){this.masterObject={}}static isObject(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e}static createProxy(e,t,i){if(e.__isProxy||!this.isObject(e))return e;const n=e;return Object.defineProperty(n,"__transferData",{value:!0,enumerable:!1,writable:!0}),new Proxy(n,{set:(e,n,s)=>{if("__isProxy"===n||e[n]===s)return!0;if(typeof e[n]==typeof s&&"function"!=typeof s&&JSON.stringify(s)===JSON.stringify(e[n]))return!0;if(this.isObject(s)?e[n]=this.proxify(s,t,i+n.toString()+"."):e[n]=s,"__transferData"===n||!e.__transferData)return!0;const r={path:i+n.toString()+".",value:s};return r.value=l.stringify(s,e),t({type:"sync",data:r,syncType:p.Object}),!0},get:(e,t)=>"__isProxy"===t||e[t],deleteProperty:(e,n)=>{if(n in e){if(delete e[n],!e.__transferData)return!0;const s={path:i.toString(),key:n};t({type:"sync",data:JSON.stringify(s),syncType:p.Delete})}return!0}})}isKey(e){return e in this.masterObject}static proxify(e,t,i){return this.isObject(e)?(Object.keys(null!=e?e:{}).forEach(n=>{this.isObject(e[n])&&(e[n]=this.proxify(e[n],t,i+n+"."))}),this.createProxy(e,t,i)):e}register(e,t,i){t in this.masterObject&&console.error("Key already exists!"),null==e&&(e={});const n=w.proxify(e,i,t+".");return this.masterObject[t]={proxy:n},n}append(e,t){return t in this.masterObject||console.error("Key doesn't exist!"),JSON.stringify(e)!==JSON.stringify(this.masterObject[t].proxy)&&console.error(`The object doesn't match the object registered under the key ${t}!`),this.masterObject[t].proxy}static getProxy(e,t,i){return this.proxify(e,t,i+".")}static sync(e,t,i,n,s){if(null==e||!e.__isProxy)return e;let r=null,o=i+".";return 1===n.length?(e.__transferData=!1,e[n[0]]=this.proxify(t,s,o+n[0]+"."),e.__transferData=!0,e):(r=e[n[0]],n.forEach((e,t)=>{o+=e+".",0!==t&&t!==n.length-1&&(e in r||(r.__transferData=!1,r[e]=this.proxify({},s,o),r.__transferData=!0),r=r[e])}),r.__transferData=!1,r[n.pop()]=this.proxify(t,s,o),r.__transferData=!0,e)}}const{toString:E}=Object.prototype;function f(e){return"[object Object]"===E.call(e)}function _(e){return"[object Array]"===E.call(e)}const m={CAMPAIGN_FLOW_START:"cFS",TEST_NOT_RUNNING:"tNR",CAMPAIGN_FLOW_END:"cFE",REGISTER_CONVERSION:"vwo_rC",CONVERT_GOAL_FOR_ALL_EXPERIMENTS:"cGFAE",UNHIDE_ALL_VARIATIONS:"uAV",DIMENSION_TAG_PUSHED:"dTP",CONVERT_VISIT_GOAL_FOR_EXPERIMENT:"cVGFE",UNHIDE_SECTION:"uS",EXCLUDE_URL:"eURL",BEFORE_REDIRECT_TO_URL:"bRTR",URL_CHANGED:"uC",HIDE_ELEMENTS:"hE",ELEMENT_LOAD_ERROR:"eLTTE",NOT_REDIRECTING:"vwo_notRedirecting",VISIBILITY_TRIGGERED:"vwo_visibilityTriggered",VARIATION_APPLIED:"vwo_vA",VARIATION_APPLIED_ERROR:"vwo_variationAppliedError",ELEMENT_LOAD_TIMER_STOP:"eLTSt",SEND_NEW_VISITOR_CALL:"sNVC",CONVERT_REVENUE_GOALS_FOR_EXPERIMENT:"cRGFE",CHOOSE_COMBINATION:"cC",START_APPLY_CHANGES:"sAC",END_APPLY_CHANGES:"eAC",CAMPAIGN_COMBI_CREATED:"cCC",ELEMENT_LOADED:"eL",ELEMENT_NOT_LOADED:"eNL",MATCH_WILDCARD:"mW",DELETE_CSS_RULE:"dCSSR",SPLIT_READY_TO_REDIRECT:"sURL",SESSION:"vwo_session",NEW_SESSION:"newSession",UNHIDE_VARIATION:"uV",NEW_SESSION_CREATED:"newSessionCreated",PAUSE:"pause",SPLIT_URL:"sURL",SHOULD_EXECUTE_LIB_ERROR:"shouldExecLib",UPDATE_SETTINGS_CALL:"uSC",EXCLUDE_GOAL_URL:"eGURL",HEATMAP_CLICK:"hCl",POST_URL_CHANGE:"hC",AFTER_SAMPLING_TRIGGER:"sT",CONVERT_ALL_VISIT_GOALS_FOR_EXPERIMENT:"cAVGFE",OPT_OUT:"oO",POST_INIT:"vwo_postInit",PAGE_VIEW:"vwo_pageView",ELEMENT_CHANGES_APPLIED:"elementChangesApplied",REGISTER_HIT:"registerHit",REDIRECT_DECISION:"rD",RETRACK_VISITOR:"retrackVisitor",CAMPAIGN_NOT_ELIGIBLE:"runCampaign.notEligible",UNHIDE_ELEMENT:"unhideElement",TOGGLE_VISIBILITY_LOCK:"runCampaign.toggleVisibilityLock",CAMPAIGN_READY:"runCampaign.campaignReady",MODIFIED_ELEMENT:"runTestCampaign.modifiedEl",ERROR:"error",SSR_COMPLETE:"vwo_mutationObserved",SET_ENV:"setEnvironment",ACTIVATED:"vwo_activated",_ACTIVATED:"vwo__activated",RECORDING_NOT_ELIGIBLE:"rNE",VARIATION_SHOWN:"vwo_variationShown",NEW_SURVEY_FOUND:"nSF",SYNC_VISITOR_PROP:"vwo_syncVisitorProp",TAG_EVALUATED:"vwo_tagEval",HTML_ELEMENT_LOADED:"vwo_elementLoaded",HTML_ELEMENT_HYDRATED:"vwo_elementHydrated",CAMPAIGN_UNLOADED:"vwo_campUnload",CAMPAIGNS_LOADED:"vwo_campaignsLoaded",EXECUTE_FUNNEL_FOR_GOAL_CAMPAIGN:"executeFunnelCampForGoalCampaign",EDITOR_APPLY_CHANGES_COMPLETE:"editorApplyChangesComplete",INIT_VWO_INTERNALS:"initVWOInternals",SET_CAMPAIGN_TO_OBSERVE:"setCampaignToObserve",SEGMENTATION_EVALUATED:"sE",SEGMENTATION_FAILED:"sF",ELEMENTS_SHOWN_WITHOUT_CHANGES:"eSWC",CUSTOM_CONVERSION:"vwo_conversion",REVENUE_CONVERSION:"vwo_revenue",DOM_SUBMIT:"vwo_dom_submit",DOM_CLICK:"vwo_dom_click",DOM_HOVER:"vwo_dom_hover",DOM_CHANGE:"vwo_dom_change",ELEMENT_VIEWED:"vwo_dom_elementViewed",GOAL_CONVERTED:"vwo_goalConverted",GOAL_VISIT:"vwo_goalVisit",EVALUATE_GOAL_PAGE_FOR_PREJS:"vwo_evalPreCampJs",GROUP_WINNER_CHOOSEN:"vwo_groupWinnerChosen",CHECK_SEGMENTATION:"checkSegmentation",TRACK_NEW_SESSION_CREATED:"tnSC",TRACK_SESSION_CREATED:"tSC",PAGE_UNLOAD:"vwo_pageUnload",SPA_VISIBILITY_SERVICE:"visibilityForSpa",SESSION_INIT_COMPLETE:"vwo_sessionInitComplete",TIB_DONE:"vwo_topInitializeBeginDone",TOGGLE_MUT_OBSERVER:"toggleMutationObserver",DOM_CONTENTLOADED:"vwo_dom_DOMContentLoaded",SPLIT_VARIATION_SHOWN:"splitVariationShown",VWO_EXECUTED:"vE",ACTIVATE_API_TRIGGERED:"aAT",CAMPAIGN_TAG_EXECUTED:"cTE",RUN_REVERT_TAGS:"runrT",VARIATION_SHOWN_SENT:"vwo_variationShownSent",PAGE_EXIT:"pageExitEvent",COOKIE_CONSENT_ACCEPTED:"cCA",COOKIE_CONSENT_ACCEPTED_INSIGHTS:"cCAI",COOKIE_CONSENT_REJECTED_INSIGHTS:"cCRI",COOKIE_CONSENT_REJECTED:"cCR",COOKIE_CONSENT_TIMEOUT:"cCT",COOKIE_CONSENT_CAMPAIGN_BLOCKED:"cCCB",LOAD_SURVEY_LIB:"loadSurveyLib",NATIVE_DOM_CONTENT_LOADED:"vwo_domReady",RECOM_BLOCK_SHOWN:"vwo_recommendation_block_shown",SYNC_EVENTS_COMPLETED:"vwo_syncEventsCallCompleted",SEND_SYNC_CALL:"vwo_sendSyncCall",LOAD_SETTINGS:"vwo_loadSettings",DEBUG_EVENT:"vwo_debugLogs",NEW_SESSION_TRACKED:"vwo_newSnTracked",GOAL_CONVERSION_FAILED:"vwo_goalConversionFailed",ENHANCE_LOGS:"vwo_enhanceLogs",MUTS_RECORDED:"vwo_mutsRecorded",ELEMENT_FOUND:"vwo_dom_elementFound",PAGE_MATCHED:"vwo_pageMatched"},O={SET_COOKIE:"sC",GET_COOKIE:"gC",ERASE_COOKIE:"eC",SET_THIRD_PARTY_COOKIE:"sTPC",SET_THIRD_PARTY_COOKIE_ERROR:"sTPCE"};let S="",y=()=>"",T=e=>e,C=e=>e,I=e=>!0;var N;window.VWO._.namespaceKeyWithAccId=T;const A=null===(N=window._vwoCc)||void 0===N?void 0:N.cookiePrefix,V=e=>A?e.startsWith(A)?e:`${A}${e}`:e,b=e=>{if(!A)return e;const t=e.replace(/^(\^)/,"").replace(/(\$)$/,"");return`^${A.replace(/([.*+?^${}()|[\]\\])/g,"\\$1")}${t}$`};function R(e,t={sendErrorLog:!1},i){try{return e()}catch(e){return t.sendErrorLog&&setTimeout(()=>{try{r({msg:t.msg||"safelyGetValue failed!",url:t.url||"errorHandler.ts",source:t.source||e})}catch(e){}},100),i}}function P(e,t={sendErrorLog:!0}){return R(()=>e.toLowerCase(),t,"")}class D{constructor(){this.hascPBEexp=!1,this.cPBEexpTypes=new Set,this.cPBInit=!1,this.handleEmptyValue=e=>""===e?"~":e,this.revertEmptyValue=e=>"~"===e?"":e,this.encodeData=e=>{const t=Object.entries(e);let i="";for(let e=0;e<t.length;e++){const[n,s]=t[e],{sId:r,mId:o,p:a,variation:d}=s,l=`p.rU:${encodeURIComponent(this.handleEmptyValue(a.rU))},p.t:${encodeURIComponent(this.handleEmptyValue(a.t))},p.u:${encodeURIComponent(this.handleEmptyValue(a.u))}`;i+=`${n}:${this.handleEmptyValue(r)},${this.handleEmptyValue(o)},${l},${this.handleEmptyValue(d)}|`}return i.slice(0,-1)},this.decodeData=e=>{if("~"===e)return;const t={},i=e.split("|");for(let e=0;e<i.length;e++){const[n,...s]=i[e].split(":"),[r,o,...a]=s.join(":").split(","),d=this.revertEmptyValue(a.pop()||""),l={};for(let e=0;e<a.length;e++){const t=a[e],[i,...n]=t.split(":");if(i.startsWith("p.")){l[i.slice(2)]=this.revertEmptyValue(decodeURIComponent(n.join(":")))}}t[n]={sId:this.revertEmptyValue(r),mId:this.revertEmptyValue(o),p:l,variation:d}}return t},this.consentMode=window.VWO.consentMode||!1,this.goalCookieStore={},this.ccN=V("_vwo_consent")}initializecPBEexpConfig(){this.cPBInit=!0;const e=R(()=>window.VWO.consentMode.cConfig);e&&"P"===e.cPB&&e.cPBEexp&&0!==e.cPBEexp.length?(this.hascPBEexp=!0,this.cPBEexpTypes=new Set(e.cPBEexp)):this.hascPBEexp=!1}campBlockedActions(e){window.mainThread||(R(()=>{window.VWO.phoenix.trigger(m.COOKIE_CONSENT_CAMPAIGN_BLOCKED,{oldArgs:[e.id]}),"SPLIT_URL"===e.type&&window.VWO.phoenix.trigger(m.NOT_REDIRECTING)}),e.iB=!0)}isCampBlocked(e){const t=window.VWO.consentMode;if(!t)return!1;if(e.iB)return!0;if(!t.hT)return!1;if(this.cPBInit||this.initializecPBEexpConfig(),!this.hascPBEexp)return!1;const i=R(()=>"TARGETING"===e.iType.type)?"TARGETING":e.orgType||e.type;return!!this.cPBEexpTypes.has(i)&&(this.campBlockedActions(e),!0)}processQueue(){var e;const t=window.VWO.consentMode.deferredQueue||[];for(;t.length>0;){const i=t.shift();null===(e=i.payload)||void 0===e||e.call(i)}}extractSavedCalls(){const e=this.getSyncDataFromConsentCookie();if(e)return this.decodeData(e)}overrideCookies(e){const t=e._create;e._create=(...i)=>{if(!this.consentMode.dT)return this.consentMode.hT&&i[0].includes("_goal")?(this.setGoalCookie(i[0],i[1]),void this.consentMode.deferredQueue.push({method:"fn",payload:()=>t.apply(e,i)})):t.apply(e,i)};const i=e.createThirdParty;e.createThirdParty=function(...t){const n=window.VWO.consentMode;if(!n.dT){if(n.hT){const[s,r,o,a]=t;if(window.VWO.modules.utils.consentModeUtils.triggerEvent(O.SET_COOKIE,s,r,o,a,!0),"_vwo"!==s&&this._create(s,r,o,a),"_combi_choose"===s.slice(-13))return;return void n.deferredQueue.push({method:"fn",payload:()=>i.apply(e,t)})}return i.apply(e,t)}};const n=e.get;e.get=(...t)=>{if(!this.consentMode.dT||"_vis_opt_test_cookie"!==t[0]){if(this.consentMode.hT){const e=this.getGoalCookie(t[0]);if(e)return e}return n.apply(e,t)}};const s=e.waitForThirdPartySync;e.waitForThirdPartySync=function(t){return window.VWO.consentMode.hT?t():s.apply(e,t)}}initConsentMode(){const e=this.consentMode||{};if(e.goalLogs=[],window.VWO.consentMode.deferredQueue=window.VWO.consentMode.deferredQueue||[],e.timeOut&&(this.consentMode.wFC=!1,this.setTimeOutFlags(e),this.triggerEvent(m.COOKIE_CONSENT_TIMEOUT)),e.hT&&this.setupConsentAcceptedListener(e),"B"!==e.cConfig.cPB||e.timeOut||this.setupConsentTimeoutListener(e),"P"===e.cConfig.cPB&&this.handlePartiallyBlocked(e),e.preview)return this.handlePreviewMode(e);this.handleConsentRejected(),this.setupInsightsConsentActionListener()}setupInsightsConsentActionListener(){window.VWO._.phoenixMT.on(m.COOKIE_CONSENT_REJECTED_INSIGHTS,()=>{window.fetcher.setValue("VWO.consentMode.dTI",!0),this.triggerEvent(m.COOKIE_CONSENT_REJECTED_INSIGHTS)})}handlePartiallyBlocked(e){if(e.savedCalls=this.extractSavedCalls(),e.cCA&&e.savedCalls&&window.VWO._.phoenixMT.on("vwo_phoenixInitialized",()=>{this.syncSaved(e.savedCalls),this.updateConsentCookie("~"),delete e.savedCalls}),!1===e.hT&&e.preview&&!e.dT&&!e.cCA){let e;for(const t in window._vwo_exp){e=window._vwo_exp[t];break}const t=window.VWO._.cookies.get("_vis_opt_exp_"+e.id+"_combi");if(e.multiple_domains&&t){const i="SPLIT_URL"===e.type||null,n={id:e.id,mId:""};this.syncTpc(n,t,i,e,!0)}}}setupConsentAcceptedListener(e){const t=window.VWO._.phoenixMT.on(m.COOKIE_CONSENT_ACCEPTED,()=>{e.savedCalls&&(this.syncSaved(e.savedCalls),delete e.savedCalls),this.processQueue(),!e.preview&&this.triggerEvent(m.COOKIE_CONSENT_ACCEPTED),this.updateConsentCookie("~"),window.fetcher.setValue("VWO.consentMode.hT",!1),window.VWO._.phoenixMT.off(t)})}queueGoalLogs(e,t,i,n){const s=window.VWO.consentMode;if(!s||!s.preview)return!0;if(s.dT)return!1;if(!s.hT)return!0;if(!window.mainThread)return window.fetcher.getValue('VWO.modules.utils.consentModeUtils.queueGoalLogs("${{1}}","${{2}}", "${{3}}", "${{4}}")',null,{captureGroups:[e,t,i,n]}),!1;let{goalLogs:r}=s;return r.push({expId:e,goalId:t,revenue:i,success:n}),!1}triggerGoalLogs(){const e=window.VWO.consentMode.goalLogs;for(;e.length>0;){const t=e.shift(),{expId:i,goalId:n,revenue:s,success:r}=t;window.VWO.modules.tags.wildCardCallback({oldArgs:[i,n,s,r],campaignId:i,goalId:n},m.REGISTER_CONVERSION)}}handlePreviewMode(e){e.hT&&window.VWO.phoenix&&window.VWO.phoenix('on("${{1}}", "${{2}}")',null,{captureGroups:[m.URL_CHANGED,()=>{window.fetcher.setValue("VWO.consentMode.goalLogs",[])}]}),this.setupConsentAcceptedListenerForPreview(e),this.setupConsentRejectedListenerForPreview()}setupConsentTimeoutListener(e){window.VWO._.phoenixMT.on(m.COOKIE_CONSENT_TIMEOUT,()=>{this.triggerEvent(m.COOKIE_CONSENT_TIMEOUT),this.setTimeOutFlags(e)})}setTimeOutFlags(e){e.dTI=!0,window.fetcher.setValue("VWO.consentMode.dTI",!0),e.dT=!0,window.fetcher.setValue("VWO.consentMode.dT",!0),e.wFC&&window.fetcher.setValue("VWO.consentMode.wFC",!1)}setupConsentAcceptedListenerForPreview(e){window.VWO._.phoenixMT.on(m.COOKIE_CONSENT_ACCEPTED,()=>{this.triggerEvent(m.COOKIE_CONSENT_ACCEPTED),this.triggerGoalLogs(),e.wFC&&window.fetcher.setValue("VWO.consentMode.wFC",!1),!e.dT&&window.fetcher.setValue("VWO.consentMode.dT",!1),window.fetcher.setValue("VWO.consentMode.hT",!1)})}setupConsentRejectedListenerForPreview(){window.VWO._.phoenixMT.on(m.COOKIE_CONSENT_REJECTED,()=>{this.triggerEvent(m.COOKIE_CONSENT_REJECTED),window.fetcher.setValue("VWO.consentMode.dT",!0)})}handleConsentRejected(){window.VWO._.phoenixMT.on(m.COOKIE_CONSENT_REJECTED,()=>{window.fetcher.setValue("VWO.consentMode.dT",!0)})}triggerEvent(e){window.VWO.phoenix&&window.VWO.phoenix('trigger("${{1}}")',null,{captureGroups:[e]})}getGoalCookie(e){const t=e;return this.goalCookieStore[V(t)]}setGoalCookie(e,t){return window.mainThread&&window.fetcher.getValue('VWO.modules.utils.consentModeUtils.setGoalCookie("${{1}}","${{2}}")',null,{captureGroups:[e,t]}),this.goalCookieStore[e]=t}deferOnConsent(e,t,i,n,s,r,...o){if(!this.consentMode)return;const{dT:a,hT:d,deferredQueue:l}=this.consentMode;if(a)return!0;if(d){if(["applySyncRequest","handlerForReqFromWT","processVariationAppliedCallback"].includes(e)){if("processVariationAppliedCallback"===e)return l.push({method:e,payload:()=>i.apply(n,o)});if(!s.includes("_goal"))return!1;if(this.setGoalCookie(s,r),"handlerForReqFromWT"===e)return l.push({method:e,payload:()=>document.cookie=o[0]})}return s&&s.name===m.VARIATION_SHOWN&&this.saveForSync(r.d),i&&i(n||{}),l.push({method:e,payload:()=>R(()=>t[e].apply(t,o))}),!0}}prepareDataForSync(e,t,i){const n={d:{}};n.d.msgId=e.mId,n.d.visId=e.mId.split("-")[0],n.d.sessionId=e.sId;const s={title:e.p.t,url:e.p.u,referrerUrl:e.p.rU};return this.consentMode.customParams=s,n.d.event={props:{page:s,id:t,variation:e.variation,isFirst:1},name:m.VARIATION_SHOWN,time:Date.now()},null!=i&&(n.d.event.props.isSplitVariation=i),n}addCustomParams(e){const t=this.consentMode;return!t||(!t.customParams||(!e.includes(m.VARIATION_SHOWN)&&!e.includes("l.gif")||"P"!==t.cConfig.cPB||!("P"===t.cConfig.cPB&&!t.hT)))}syncSaved(e){const t={VWO:{firedTime:Date.now()},executingTagTrigger:null,name:m.VARIATION_SHOWN,props:{},time:Date.now()};Object.keys(e).map(i=>{const n=e[i],s=window._vwo_exp[i];let r=null,o=null;if("SPLIT_URL"===s.type&&(r=!0,o="1"!=n.variation),!window.VWO._.cookies.get("_vis_opt_exp_"+i+"_combi"))return;const a=this.prepareDataForSync(n,i,o);window.VWO.modules.tags.dataSync.utils.addDataFromMTAndSend(null,null,a,null,!0,null,t,+i),this.syncImg(n,i,s),this.syncTpc(n,i,r,s)})}syncTpc(e,t,i,n,s=!1){if(!n.multiple_domains)return;const r=[`_vwo_uuid_${t}`,e.mId.split("-")[0],3650,void 0,t,void 0,n];!s&&window.VWO._.cookies.createThirdParty(...r),r[0]=`_vis_opt_exp_${t}_combi`,r[1]=e.variation,r[3]=100,window.VWO._.cookies.createThirdParty(...r),null!=i&&(r[0]=`_vis_opt_exp_${e.id}_split`,window.VWO._.cookies.createThirdParty(...r))}syncImg(e,t,i){let n=window.VWO.modules.utils.libUtils.extraData2();const s=encodeURIComponent(n);n=i.ps||void 0===i.ps?"&ed="+s:"";const r="l.gif?experiment_id="+t+"&account_id="+window._vwo_acc_id+"&cu="+encodeURIComponent(e.p.u)+"&combination="+e.variation+"&s=1&sId="+e.sId+"&u="+e.mId.split("-")[0]+n;window.VWO.modules.tags.dataSync.utils.sendCall(null,{url:r},null,null,!0)}saveForSync(e){let t=this.getSyncDataFromConsentCookie(),i=t?this.decodeData(t):{};const n={rU:e.event.props.page.referrerUrl,u:e.event.props.page.url,t:e.event.props.page.title},s={sId:e.sessionId,mId:e.msgId,p:n,variation:e.event.props.variation},r=Object.assign(Object.assign({},i),{[e.event.props.id]:s});let o=this.encodeData(r);this.updateConsentCookie(o)}getSyncDataFromConsentCookie(){const e=`${this.ccN}=`,t=document.cookie.split("; ").find(t=>t.startsWith(e));if(t){const e=decodeURIComponent(t.split("=")[1]).split(":");if(e.length>1)return e.shift(),"~"===e[0]?null:e.join(":")}return null}updateConsentCookie(e){const t=document.cookie.match(new RegExp(`(^|;\\s*)${this.ccN}=([^;]*)`)),i=t?t[2]:null;let n="";if(i){n=decodeURIComponent(i).split(":")[0]}const s=encodeURIComponent(`${n}:${e}`);window.VWO.consentMode.setCookie(s)}}const x=function(){const e=window.VWO.consentMode;return!!e&&!!e.dT};let L=null;const U=function(e){return i(this,void 0,void 0,function*(){const t=window.VWO.consentMode;if(!t)return!0;const{hTI:i,dTI:n}=t;return!n&&(!i||(L||(L=new Promise(t=>{e.on(m.URL_CHANGED,()=>{t(!1),L=null}),e.on(m.COOKIE_CONSENT_ACCEPTED_INSIGHTS,()=>t(!0)),e.on(m.COOKIE_CONSENT_REJECTED_INSIGHTS,()=>t(!1))})),yield L))})},W=new D;window.VWO.modules.utils.consentModeUtils=W;let M=!1;function k(e){return e.split(";").reduce((e,t)=>{const i=t.indexOf("=");if(-1!==i){const n=t.substring(0,i).trim(),s=t.substring(i+1).trim();e[n]=s}else e[t.trim()]="";return e},{})}class G{constructor(){this.operations=[]}push(e,t){this.operations.push({name:e,value:t})}pop_front(){this.operations.splice(0,1)}fullfil(e,t=!0){const i=k(e);t&&this.pop_front(),this.operations.forEach(e=>{i[e.name]=e.value});return Object.entries(i).map(e=>e.join("=")).join("; ")}}class F{static internalUtils(){var e;return{isCookiePayloadObject:e=>!(!f(e)||!["value","fromThread","origin"].reduce((t,i)=>t&&i in e,!0)),isCurrentContextMT:!!(null===(e=null===window||void 0===window?void 0:window.mainThread)||void 0===e?void 0:e.webWorker)}}getSetter(e){let t;return t=new G,i=>{if("string"==typeof i)i={value:i};else if(!F.internalUtils().isCookiePayloadObject(i))return void console.error("Invalid value type!");const{value:n,fromThread:s}=i;let{origin:r}=i,o=!0;if(F.internalUtils().isCurrentContextMT||"MAIN"===s)document.__cookie=n,o="MAIN"!==s;else{{const e=n.indexOf("="),i=n.substring(0,e).trim(),s=k(n);let a=!1;(s.expires&&new Date(s.expires)<new Date(Date.now())||"0"===s["max-age"])&&(a=!0);const d=k(document.__cookie);a?i in d?delete d[i]:o=!1:(d[i]=s[i],t.push(i,s[i]),r="WORKER"),document.__cookie=Object.entries(d).map(e=>e.join("=")).join(";")}}return"MAIN"===s&&(document.__cookie=t.fullfil(document.__cookie,"WORKER"===r)),o&&e({type:"sync",data:{propertyName:"cookie",value:{value:F.internalUtils().isCurrentContextMT?document.__cookie:n,fromThread:F.internalUtils().isCurrentContextMT?"MAIN":"WORKER",origin:M?"WORKER":r}},syncType:p.Document}),!0}}}function H(e){if(!F.internalUtils().isCookiePayloadObject(e))return void console.error("Invalid value type!");const{value:t}=e;if(window.VWO.consentMode){if(x())return;let e=t.split("=");if(W.deferOnConsent("handlerForReqFromWT",null,null,null,e[0],e[1],t))return}M=!0,document.cookie=t,M=!1}let j={},$;class B{static register(e,t){this.registerProperty(e,t)}static registerProperty(e,t){if(document){if(e in window.document){let i;i=Object.getOwnPropertyDescriptor(window.document,e);const n={enumerable:i.enumerable,configurable:i.configurable,get:()=>document["__"+e],set:this.internalUtils.getSetter(e,t)};Object.defineProperty(window.document,"__"+e,i),Object.defineProperty(window.document,e,n)}}else console.error("The property doesn't exist on the `DOCUMENT` object.")}static sync({propertyName:e,value:t}){document[e]=t}}B.internalUtils={getSetter:(e,t)=>{if("cookie"===e)return(new F).getSetter(t);return i=>(JSON.stringify(document["__"+e])===JSON.stringify(i)||(document["__"+e]=i,t({type:"sync",data:{propertyName:e,value:document["__"+e]},syncType:p.Document})),!0)},isKeyNonConfigurable:e=>{var t,i,n;const s=[document,null===(t=null===window||void 0===window?void 0:window.Document)||void 0===t?void 0:t.prototype,null===(i=null===window||void 0===window?void 0:window.HTMLDocument)||void 0===i?void 0:i.prototype];for(let t=0;t<s.length;t++)if(!1===(null===(n=Object.getOwnPropertyDescriptor(s[t]||{},e))||void 0===n?void 0:n.configurable))return!0;return!1}};class K{static register(e,t,i,n){i in e?console.error("The property must not pre-exist inside the object."):Object.defineProperty(e,i,{enumerable:!0,configurable:!1,get:()=>e[`__${i}`],set:s=>(e[`__${i}`]=s,n({type:"sync",data:{identifier:t,property:i,value:s},syncType:p.Property}),!0)})}}const z={get:e=>{try{0;return window.localStorage.getItem(e)}catch(e){return""}},set:(e,t)=>{try{return window.localStorage.setItem(e,t)}catch(e){return""}},remove:e=>{try{return window.localStorage.removeItem(e)}catch(e){return!1}},getItem:function(e){return this.get(e)},setItem:function(e,t){this.set(e,t)},deleteAll:function(){},deleteItem:function(e){this.remove(e)}};function Y(e){$=e}function J(){class e{constructor(e){this.__transferData=!0,this.length=(null==e?void 0:e.length)||0,this.value=e||{},this.callback=window.fetcher.postMessage.bind(window.fetcher)}key(e){if(e>=this.length)return null;const t=Object.keys(this.value);for(let i=0;i<t.length;i++)if(i===e)return t[i]}getItem(e){return e in this.value?this.value[e]:null}setItem(e,t){if(e in this.value){if(this.value[e]===t)return}else this.length++;return this.value[e]=t,this.callback({data:{key:e,value:t},type:"sync",syncType:{type:"custom",method:"localStorage",operation:"setItem"}}),null}removeItem(e){return e in this.value?(this.length--,delete this.value[e],this.callback({data:{key:e},type:"sync",syncType:{type:"custom",method:"localStorage",operation:"removeItem"}}),null):null}clear(){return 0===this.length||(this.length=0,this.value={},this.callback({data:{},type:"sync",syncType:{type:"custom",method:"localStorage",operation:"clear"}})),null}}window.localStorage=new e(window.localStorage)}function X(e){if("number"!=typeof e.syncType){switch(window.localStorage.__transferData&&(window.localStorage.__transferData=!1),e.syncType.operation){case"setItem":try{window.localStorage.setItem(e.data.key,e.data.value)}catch(t){"_vwo_eventHistSession"!==e.data.key&&"_vwo_eventHist"!==e.data.key||z.remove(e.data.key)}break;case"removeItem":window.localStorage.removeItem(e.data.key);break;case"clear":window.localStorage.clear();break;default:return}window.localStorage.__transferData&&(window.localStorage.__transferData=!0)}}window.VWO._.localStorageService=z;class q{}q.syncLocalStorage=J;class Q extends q{constructor(){super(),this.objectSyncer=new w}register(e,t,i={},n="",s=!1){if("object"!=typeof i||Array.isArray(i))return;const r=window.fetcher.postMessage.bind(window.fetcher);switch(e){case"custom":if("localStorage"!==t)throw new Error("Unknown property name!");Q.syncLocalStorage();break;case p.Object:{const e=this.objectSyncer.register(i,t,r);return s&&r({data:{value:JSON.stringify(i),path:t},type:"sync",syncType:p.OverWrite}),e}case p.Property:K.register(i,n,t,r);break;case p.Document:B.register(t,r);break;default:console.error("Unknown 'syncAblesEnum' type!")}}append(e,t){return this.objectSyncer.append(e,t)}static sync(e,t){var i;const{data:n}=e;if("object"!=typeof e.syncType||"custom"!==e.syncType.type)switch(e.syncType){case p.Object:{n.value=l.parse(n.value);const e=n.path.substring(0,n.path.lastIndexOf(".")).split(".");window[e[0]]=w.sync(window[e[0]],n.value,e[0],e.splice(1),t);break}case p.Document:B.sync(n);break;case p.Property:case p.Variable:t(n);break;case p.OverWrite:if(!("__transferData"in(null!==(i=window[n.path])&&void 0!==i?i:{})))return void(window[n.path]=JSON.parse(n.value));window[n.path]=w.getProxy(JSON.parse(n.value),t,n.path);break;case p.Delete:{const e=JSON.parse(n),t=e.path.substring(0,e.path.lastIndexOf(".")).split(".").reduce((e,t)=>Object.keys(e).length?e[t]:window[t],{}),i=e.key;i in t&&(t.__transferData=!1,delete t[i],t.__transferData=!0);break}default:console.error("Unknown 'syncAblesEnum' type!")}else{if("localStorage"!==e.syncType.method)return;X(e)}}declare(e,t){K.register(window,"window",e,t)}}const Z=(e,t)=>{if(e&&"function"==typeof e&&e.bind)try{e=e.bind(t)}catch(t){if(/(cannot be invoked without 'new')|(Cannot call a class constructor without |new|)/i.test(t.message))return e;console.error(t)}return e};function ee(e,t,i={}){if("window"===e)return window;let n=window;const{captureGroups:s=null,filter:r}=i,o=e.split("."),a=o.length;for(let e=0;e<a;e++){let t=o[e];if(t.endsWith(")")){const e=t.substring(0,t.indexOf("("));let i=t.substring(t.indexOf("("));i="["+i.slice(1,i.length-1)+"]";const r=i.slice(1,i.length-1).split(",");r.forEach((e,t)=>{e.startsWith('"')||(r[t]='"vwoCurrThreadRef'+e+'"')});const o=JSON.parse(i,(e,t)=>{let i;if("string"==typeof t){if(i=t.match(/\${{([0-9]*)}}/))return s[i[1]-1];if(i=t.match(/vwoCurrThreadRef(.*)/))return ee(i[1])}return t});n=n[e](...o)}else{let e=!1;t.endsWith("?")&&(t=t.slice(0,-1),e=!0);const i=n[t];if(n=Z(i,n),e&&null==n)return n}}if(r){const e={};r.forEach(t=>{e[t]=n[t]}),n=e}return n}const te=function(e){return window.functionWrapper.unwrap(e.id)(...l.parse(e.args))},ie=function(e){var t,n;return i(this,void 0,void 0,function*(){switch(e.type){case"callWrappedFunction":{let t=te(e);return t&&"function"==typeof t.then&&(t=yield t),l.stringify(t)}case"vwoClassInstanceBridge":{const t=e.path.dest.lastIndexOf(".");let i=window,n=e.path.dest;-1!==t&&(i=ee(e.path.dest.slice(0,t)),n=e.path.dest.substr(t+1));const s=i[n],[r,o]=new s(...e.args);return o.otherSide=(...t)=>{const i=e.path.src+"."+r+"."+t[0];return t[0]=i,window.fetcher.getValue(...t)},""+r}default:{let i,s;if("setValue"===(e=l.parse(e)).type){-1==e.path.lastIndexOf(".")&&(e.path="window."+e.path);const t=e.path;e.path=t.slice(0,t.lastIndexOf(".")),i=t.slice(t.lastIndexOf(".")+1)}(null===(t=e.config)||void 0===t?void 0:t.captureGroups)&&(e.config.captureGroups=l.parse(e.config.captureGroups));const r=s=ee(e.path,e.args,null==e?void 0:e.config);return(null===(n=e.config)||void 0===n?void 0:n.constructable)?s=new r(...e.args):"function"==typeof r&&(s=r(...e.args||[])),i&&(s=r[i]=e.val),s=yield s,l.stringify(s)}}})};class ne{}class se extends ne{init(){this.isMTInstance=!!R(()=>window.mainThread.webWorker),this.thread=this.isMTInstance?window.vwoChannelFW:null===window||void 0===window?void 0:window.workerThread,this.request=v,this.response=h,this.isMTInstance?this.thread.port1.onmessage=this.onMessage.bind(this):(this.thread.onmessage=this.isMessageChannel(this.thread)&&this.onMessage.bind(this),this.auxiliaryMessageHandler())}auxiliaryMessageHandler(){const e=this,t=function(i){const{vwoChannelToW:n,vwoChannelFW:s}=i.data;n&&s&&(window.vwoChannelToW=n,window.vwoChannelFW=s,e.thread=n,e.thread.onmessage=e.onMessage.bind(e),self.removeEventListener("message",t))};self.addEventListener("message",t)}isMessageChannel(e){return e&&e.port1 instanceof MessagePort&&e.port2 instanceof MessagePort}postMessage(e){try{this.isMTInstance?window.vwoChannelToW.port2.postMessage(e):window.vwoChannelFW.postMessage(e)}catch(e){console.error(e)}}onMessage(e){var t,i,n,s;const{data:r}=e;switch(r.type){case"initDone":window.vwo_initDone(r);break;case"request":this.request(r).resolve(ie);break;case"response":this.response(r).resolve(l.parse.bind(l));break;case"sync":{let e=()=>null;switch(r.syncType){case p.OverWrite:case p.Object:e=this.postMessage.bind(this);case p.Property:case p.Document:case p.Variable:case p.Delete:}Q.sync(r,e);break}default:window.VwoUnitTestsRunning&&("unit-test"===r.type?eval(r.code):"unit-test-result"===r.type&&(null===(i=null===(t=window.PromiseResolver)||void 0===t?void 0:t[r.id])||void 0===i||i.resolve(r))),null===(s=(n=this.thread)._onMessage)||void 0===s||s.call(n,e)}}getValue(e,t,i={}){let n;(null==i?void 0:i.captureGroups)&&(n=l.stringify(i.captureGroups));const s={path:e,args:t,config:Object.assign(Object.assign({},i),{captureGroups:n})};return this.request(l.stringify(s)).send().catch(()=>{})}setValue(e,t){const i={type:"setValue",path:e,val:t};return this.request(l.stringify(i)).send().catch(()=>{})}}const re=se;window.fetcher=new re;class oe{constructor(){this.id=0,this.store={}}wrap(e,t){const i=this.id++;return this.store=this.store||{},this.store[i]=t?e.bind(t):e,i}unwrap(e){return this.store[e]}}var ae="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function de(e){var t={exports:{}};return e(t,t.exports),t.exports}var le=function(e){return e&&e.Math==Math&&e},ce=le("object"==typeof globalThis&&globalThis)||le("object"==typeof window&&window)||le("object"==typeof self&&self)||le("object"==typeof ae&&ae)||function(){return this}()||Function("return this")(),ue=function(e){try{return!!e()}catch(e){return!0}},ge=!ue(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),he={}.propertyIsEnumerable,ve=Object.getOwnPropertyDescriptor,pe=ve&&!he.call({1:2},1),we=pe?function(e){var t=ve(this,e);return!!t&&t.enumerable}:he,Ee={f:we},fe=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},_e={}.toString,me=function(e){return _e.call(e).slice(8,-1)},Oe="".split,Se=ue(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return"String"==me(e)?Oe.call(e,""):Object(e)}:Object,ye=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},Te=function(e){return Se(ye(e))},Ce=function(e){return"object"==typeof e?null!==e:"function"==typeof e},Ie=function(e,t){if(!Ce(e))return e;var i,n;if(t&&"function"==typeof(i=e.toString)&&!Ce(n=i.call(e)))return n;if("function"==typeof(i=e.valueOf)&&!Ce(n=i.call(e)))return n;if(!t&&"function"==typeof(i=e.toString)&&!Ce(n=i.call(e)))return n;throw TypeError("Can't convert object to primitive value")},Ne={}.hasOwnProperty,Ae=function(e,t){return Ne.call(e,t)},Ve=ce.document,be=Ce(Ve)&&Ce(Ve.createElement),Re=function(e){return be?Ve.createElement(e):{}},Pe=!ge&&!ue(function(){return 7!=Object.defineProperty(Re("div"),"a",{get:function(){return 7}}).a}),De=Object.getOwnPropertyDescriptor,xe=ge?De:function(e,t){if(e=Te(e),t=Ie(t,!0),Pe)try{return De(e,t)}catch(e){}if(Ae(e,t))return fe(!Ee.f.call(e,t),e[t])},Le={f:xe},Ue=function(e){if(!Ce(e))throw TypeError(String(e)+" is not an object");return e},We=Object.defineProperty,Me=ge?We:function(e,t,i){if(Ue(e),t=Ie(t,!0),Ue(i),Pe)try{return We(e,t,i)}catch(e){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(e[t]=i.value),e},ke={f:Me},Ge=ge?function(e,t,i){return ke.f(e,t,fe(1,i))}:function(e,t,i){return e[t]=i,e},Fe=function(e,t){try{Ge(ce,e,t)}catch(i){ce[e]=t}return t},He="__core-js_shared__",je=ce[He]||Fe(He,{}),$e=je,Be=Function.toString;"function"!=typeof $e.inspectSource&&($e.inspectSource=function(e){return Be.call(e)});var Ke=$e.inspectSource,ze=ce.WeakMap,Ye="function"==typeof ze&&/native code/.test(Ke(ze)),Je=de(function(e){(e.exports=function(e,t){return $e[e]||($e[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.8.1",mode:"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})}),Xe=0,qe=Math.random(),Qe=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++Xe+qe).toString(36)},Ze=Je("keys"),et=function(e){return Ze[e]||(Ze[e]=Qe(e))},tt={},it=ce.WeakMap,nt,st,rt,ot=function(e){return rt(e)?st(e):nt(e,{})},at=function(e){return function(t){var i;if(!Ce(t)||(i=st(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return i}};if(Ye){var dt=$e.state||($e.state=new it),lt=dt.get,ct=dt.has,ut=dt.set;nt=function(e,t){return t.facade=e,ut.call(dt,e,t),t},st=function(e){return lt.call(dt,e)||{}},rt=function(e){return ct.call(dt,e)}}else{var gt=et("state");tt[gt]=!0,nt=function(e,t){return t.facade=e,Ge(e,gt,t),t},st=function(e){return Ae(e,gt)?e[gt]:{}},rt=function(e){return Ae(e,gt)}}var ht={set:nt,get:st,has:rt,enforce:ot,getterFor:at},vt=de(function(e){var t=ht.get,i=ht.enforce,n=String(String).split("String");(e.exports=function(e,t,s,r){var o,a=!!r&&!!r.unsafe,d=!!r&&!!r.enumerable,l=!!r&&!!r.noTargetGet;"function"==typeof s&&("string"!=typeof t||Ae(s,"name")||Ge(s,"name",t),(o=i(s)).source||(o.source=n.join("string"==typeof t?t:""))),e!==ce?(a?!l&&e[t]&&(d=!0):delete e[t],d?e[t]=s:Ge(e,t,s)):d?e[t]=s:Fe(t,s)})(Function.prototype,"toString",function(){return"function"==typeof this&&t(this).source||Ke(this)})}),pt=ce,wt=function(e){return"function"==typeof e?e:void 0},Et=function(e,t){return arguments.length<2?wt(pt[e])||wt(ce[e]):pt[e]&&pt[e][t]||ce[e]&&ce[e][t]},ft=Math.ceil,_t=Math.floor,mt=function(e){return isNaN(e=+e)?0:(e>0?_t:ft)(e)},Ot=Math.min,St=function(e){return e>0?Ot(mt(e),9007199254740991):0},yt=Math.max,Tt=Math.min,Ct=function(e,t){var i=mt(e);return i<0?yt(i+t,0):Tt(i,t)},It=function(e){return function(t,i,n){var s,r=Te(t),o=St(r.length),a=Ct(n,o);if(e&&i!=i){for(;o>a;)if((s=r[a++])!=s)return!0}else for(;o>a;a++)if((e||a in r)&&r[a]===i)return e||a||0;return!e&&-1}},Nt={includes:It(!0),indexOf:It(!1)},At=Nt.indexOf,Vt=function(e,t){var i,n=Te(e),s=0,r=[];for(i in n)!Ae(tt,i)&&Ae(n,i)&&r.push(i);for(;t.length>s;)Ae(n,i=t[s++])&&(~At(r,i)||r.push(i));return r},bt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Rt=bt.concat("length","prototype"),Pt=Object.getOwnPropertyNames||function(e){return Vt(e,Rt)},Dt={f:Pt},xt=Object.getOwnPropertySymbols,Lt={f:xt},Ut=Et("Reflect","ownKeys")||function(e){var t=Dt.f(Ue(e)),i=Lt.f;return i?t.concat(i(e)):t},Wt=function(e,t){for(var i=Ut(t),n=ke.f,s=Le.f,r=0;r<i.length;r++){var o=i[r];Ae(e,o)||n(e,o,s(t,o))}},Mt=/#|\.prototype\./,kt=function(e,t){var i=Ft[Gt(e)];return i==jt||i!=Ht&&("function"==typeof t?ue(t):!!t)},Gt=kt.normalize=function(e){return String(e).replace(Mt,".").toLowerCase()},Ft=kt.data={},Ht=kt.NATIVE="N",jt=kt.POLYFILL="P",$t=kt,Bt=Le.f,Kt=function(e,t){var i,n,s,r,o,a=e.target,d=e.global,l=e.stat;if(i=d?ce:l?ce[a]||Fe(a,{}):(ce[a]||{}).prototype)for(n in t){if(r=t[n],s=e.noTargetGet?(o=Bt(i,n))&&o.value:i[n],!$t(d?n:a+(l?".":"#")+n,e.forced)&&void 0!==s){if(typeof r==typeof s)continue;Wt(r,s)}(e.sham||s&&s.sham)&&Ge(r,"sham",!0),vt(i,n,r,e)}},zt=Object.keys||function(e){return Vt(e,bt)},Yt=Ee.f,Jt=function(e){return function(t){for(var i,n=Te(t),s=zt(n),r=s.length,o=0,a=[];r>o;)i=s[o++],ge&&!Yt.call(n,i)||a.push(e?[i,n[i]]:n[i]);return a}},Xt={entries:Jt(!0),values:Jt(!1)},qt=Xt.values;Kt({target:"Object",stat:!0},{values:function(e){return qt(e)}});var Qt=pt.Object.values,Zt=function(e,t,i){var n=Ie(t);n in e?ke.f(e,n,fe(0,i)):e[n]=i};Kt({target:"Object",stat:!0,sham:!ge},{getOwnPropertyDescriptors:function(e){for(var t,i,n=Te(e),s=Le.f,r=Ut(n),o={},a=0;r.length>a;)void 0!==(i=s(n,t=r[a++]))&&Zt(o,t,i);return o}});var ei=pt.Object.getOwnPropertyDescriptors,ti,ii,ni,si,ri,oi,ai;!function(e){e.DOM="vwo_dom"}(ti||(ti={})),function(e){e.WILD_CARD="*",e.TRIGGER="trigger",e.POST_INIT="post-init",e.TIMER="vwo_timer",e.TRIGGER_UPDATES="vwo_triggerUpdates"}(ii||(ii={})),function(e){e.URL_CHANGE="vwo_urlChange",e.LEAVE_INTENT="vwo_leaveIntent",e.CLICK_EVENT="vwo_dom_click",e.HOVER_EVENT="vwo_dom_hover",e.CHANGE_EVENT="vwo_dom_change",e.ELEMENT_VIEWED_EVENT="vwo_dom_elementViewed",e.SUBMIT_EVENT="vwo_dom_submit",e.PAGE_LOAD_EVENT="vwo_page_load"}(ni||(ni={})),function(e){e.PAGE_VIEW="vwo_pageView",e.PAGE_UNLOAD_EVENT="vwo_pageUnload"}(si||(si={})),function(e){e.EXIT_CONDITIONS="__exitConditions"}(ri||(ri={})),function(e){e.DOM_CONTENT_LOADED="DOMContentLoaded",e.SCROLL="scroll",e.CLICK="click",e.SUBMIT="submit"}(oi||(oi={})),function(e){e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR"}(ai||(ai={}));class di{constructor(e){this.setLevel(e)}setLevel(e="warn"){this.logLevel=ai[e.toUpperCase()]}info(e,t={}){this.customLog(ai.INFO,e,t)}debug(e,t={}){this.customLog(ai.DEBUG,e,t)}warn(e,t={}){var i,n;this.customLog(ai.WARN,e,t,null===(n=null===(i=window.VWO)||void 0===i?void 0:i._)||void 0===n?void 0:n.customError)}error(e,t={}){var i,n;this.customLog(ai.ERROR,e,t,null===(n=null===(i=window.VWO)||void 0===i?void 0:i._)||void 0===n?void 0:n.customError)}customLog(e,t,i,n=null){var s,r,o;if(e>=this.logLevel){const a=this.formatMessage(e,t,i);null===(o=null===(r=null===(s=window.VWOEvents)||void 0===s?void 0:s.store)||void 0===r?void 0:r.actions)||void 0===o||o.addLogsForDebugging(a),n?n(a):this.consoleLog(e,[a])}}consoleLog(e,t){switch(e){case ai.INFO:console.info(...t);break;case ai.WARN:console.warn(...t);break;case ai.ERROR:console.error(...t);break;default:console.log(...t)}}formatMessage(e,t,i){var n,s;const r=Object.keys(i).reduce((e,t)=>e.replace(new RegExp(`{{${t}}}`,"g"),i[t]),t),o=`${ti.DOM}_`;let a=i;const d=(null===(n=i.data)||void 0===n?void 0:n.vwoEventName)||i.vwoEventName;d!==o+oi.CLICK&&d!==o+oi.SUBMIT||(a=i.data?null===(s=i.data)||void 0===s?void 0:s.props:a.props,a=a||{name:d});let l=JSON.stringify;try{l=window.VWO._.native.JSON.stringify||JSON.stringify}catch(e){}return`VWO: [${ai[e].toUpperCase()}] [${(new Date).toUTCString()}] ${r} ${l(a)}`}}class li{static parseUrl(e){var t;try{e=decodeURIComponent(e)}catch(e){console.warn("Not a valid URL.")}const i=/^((((\w+)(:\/\/))?((\w+):(\w+)@)?(www\.)?)([^?#\/:\s]*)?:?([0-9][^?#\/\s]*)?)\/?([^?#\s]*)\??([^#]*)#?(.*)$/.exec(e.trim());if(!i)throw new Error("Not a valid URL.");let n;if(null===(t=window._vwoCc)||void 0===t?void 0:t.iQPE){n={};new URLSearchParams(window.location.search).forEach((e,t)=>{t&&(n[t]=e)})}else n=i[13]?i[13].split("&").reduce((e,t)=>{const[i,n=""]=t.split("=");return e[i]=n,e},{}):{};return i&&{url:i[0],origin:i[1].replace(i[6],""),protocol:i[4]||"",hasWWW:Boolean(i[9]),username:i[7]||"",password:i[8]||"",host:(i[9]||"")+i[10],domain:i[10],port:i[11]||"",path:i[12],query:i[13]||"",queryParams:n,fragment:i[14]||"",urlWithoutProtocol:i[0].replace(i[3],""),urlWithoutProtocolAndWww:i[0].replace(i[2],"")}}}var ci={LOGGER_LEVEL:"error"};const ui=li.parseUrl(window.location.href).queryParams.vwoLogLevel;var gi=new di(ui||ci.LOGGER_LEVEL);const{toString:hi}=Object.prototype;function vi(e){return"[object Object]"===hi.call(e)}function pi(e){return"[object Array]"===hi.call(e)}function wi(e){return"[object Null]"===hi.call(e)}function Ei(e){return"[object Undefined]"===hi.call(e)}function fi(e){return!Ei(e)&&!wi(e)}function _i(e){return!Number.isNaN(e)&&"[object Number]"===hi.call(e)}function mi(e){return"[object String]"===hi.call(e)}function Oi(e){return"[object Boolean]"===hi.call(e)}function Si(e){return e!=e}function yi(e){return"[object Date]"===hi.call(e)}function Ti(e){return"[object Function]"===hi.call(e)}function Ci(e){return"[object AsyncFunction]"===hi.call(e)}function Ii(e){return"[object RegExp]"===hi.call(e)}function Ni(e){return"[object Promise]"===hi.call(e)}function Ai(e){return vi(e)?"Object":pi(e)?"Array":wi(e)?"Null":Ei(e)?"Undefined":Si(e)?"NaN":_i(e)?"Number":mi(e)?"String":Oi(e)?"Boolean":yi(e)?"Date":Ii(e)?"Regex":Ti(e)?"Function":Ci(e)?"AsyncFunction":Ni(e)?"Promise":"Unknown Type"}class Vi{mergeNestedObjects(...e){return e.reduce((e,t)=>this.recursivelyMerge(e,t))}mergeNestedObjectsV2(e={mergeArrays:!1},...t){return t.reduce((t,i)=>this.recursivelyMerge(t,i,{},e))}createNestedObjects(e,t){let i=e;return t&&t.split(".").forEach(e=>{Object.prototype.hasOwnProperty.call(i,e)||(i[e]={}),i=i[e]}),i}clearNestedObject(e,t){let i=e;const n=t.split("."),s=n[n.length-1];for(let e=0;e<n.length-1;e++)i=i[n[e]];vi(i[s])?i[s]={}:delete i[s]}recursivelyMerge(e,t,i={},n={mergeArrays:!1}){if(vi(e)&&vi(t)){const s={};Object.keys(e).concat(Object.keys(t)).forEach(e=>{s[e]=1});const r=Object.getOwnPropertyDescriptors(e),o=Object.getOwnPropertyDescriptors(t);return Object.keys(s).forEach(s=>{o[s]?Object.defineProperty(i,s,o[s]):Object.defineProperty(i,s,r[s]),this.recursivelyMerge(e[s],t[s],i[s],n)}),i}return n.mergeArrays&&pi(e)&&pi(t)?(pi(i)||(i=[]),i.splice(0,i.length,...e.concat(t)),i):t||e}}var bi=new Vi,Ri,Pi,Di,xi;!function(e){e.SETTINGS="settings",e.CUSTOM="custom",e.TRIGGERS="triggers",e.TAGS="tags",e.EVENTS="events",e.DEBUG="debug",e.ROOT="root"}(Ri||(Ri={})),function(e){e.HISTORY="history"}(Pi||(Pi={})),function(e){e.LOGS="logs"}(Di||(Di={})),function(e){e.ALIAS="$alias"}(xi||(xi={}));class Li{constructor(){this.originalValues={[Ri.SETTINGS]:{},[Ri.CUSTOM]:{},[Ri.TRIGGERS]:{},[Ri.EVENTS]:{[Pi.HISTORY]:[]},[Ri.DEBUG]:{[Di.LOGS]:[]}},this.reset()}reset(){this.values=JSON.parse(JSON.stringify(this.originalValues)),this.setValues(this.values)}getValue(e=""){try{return e.split(".").reduce((e,t)=>e[t],this.values)}catch(e){return null}}setValues(e,t=""){const i=this.getNamespace(t);if(vi(e)){const t=i?bi.createNestedObjects(this.values,i):this.values;Object.keys(e).forEach(i=>{const n=Object.getOwnPropertyDescriptor(e,i);Object.prototype.hasOwnProperty.call(n,"get")?Object.defineProperty(t,i,n):t[i]=e[i]})}}clear(e){const t=this.getNamespace(e);bi.clearNestedObject(this.values,t)}getNamespace(e){return(null==e?void 0:e.startsWith("."))?e.substring(1):e}}Li.logger=new di("warn");var Ui=new Li;class Wi{constructor(){this.plugins={}}register(e){gi.debug(`Registering plugin '${e.pluginName}' in Plugins factory`),this.plugins[e.pluginName]=e}unregister(e){let t;t=mi(e)?e:e.pluginName,gi.debug(`Unregistering plugin '${t}' in Plugins factory`),this.plugins[t].removeAll(),delete this.plugins[t]}unregisterAll(){gi.debug("Unregistering all plugins in Plugins factory"),Object.keys(this.plugins).forEach(e=>{this.plugins[e].removeAll(),delete this.plugins[e]})}clearData(){gi.debug("Clearing the data of all the plugins"),Object.keys(this.plugins).forEach(e=>{this.plugins[e].clearData()})}}var Mi=new Wi,ki;!function(e){e.EVENT="event",e.EVENT_PROPS="eventProps",e.STORAGE="storage",e.FORMULA="formula",e.OPERATOR="operator",e.TAG="tag",e.CONDITION_LEVEL_OPERATOR="clOperator"}(ki||(ki={}));class Gi{get(e){return this[e]}set(e,t){this[e]=t}}var Fi=new Gi,Hi;!function(e){e[e.EXCLUDE_PASSED=1]="EXCLUDE_PASSED",e[e.INCLUDE_PASSED=2]="INCLUDE_PASSED",e[e.INCLUDE_FAILED=3]="INCLUDE_FAILED"}(Hi||(Hi={}));var ji=Hi,$i;!function(e){e.OR="o",e.AND="a"}($i||($i={}));var Bi=$i;class Ki{constructor(){this.experimentConfig={},this.pageConfig={},this.experimentConfigCache={},this.pageConfigCache={},this.previewParamsCleanedUrlCache={},this.pageMatchDataCache={},Ki.cleanerRegex=/(^https?:\/\/)?(w{3}\.)?(.*?)?((?:\/)(?:home|default|index)\.\w{3,4})?(\/)?([?#].*)?$/i,Ki.logicalOperators=[Bi.AND,Bi.OR]}static get currentUrl(){return window.location.href}setPageMatchData(e,t){this.pageMatchDataCache[e]||(this.pageMatchDataCache[e]=t)}getPageMatchData(e){return this.pageMatchDataCache[e]||null}clearPageMatchDataCache(){this.pageMatchDataCache={}}add(e,t){if(gi.debug("Adding pageGroup config to phoenix"),fi(e)&&(Object.hasOwnProperty.call(e,"ec")&&e.ec.forEach(e=>{const t=Object.keys(e)[0];this.experimentConfig[t]||(this.experimentConfig[t]=e[t])}),Object.hasOwnProperty.call(e,"pc")&&e.pc.forEach(e=>{const t=Object.keys(e)[0];this.pageConfig[t]||(this.pageConfig[t]=e[t])})),fi(t)){if(pi(t.pc)){const e=this.getCache(Ki.currentUrl,!0);t.pc.forEach(t=>{e[t]={didMatch:!0,reason:ji.INCLUDE_PASSED,cacheHit:!0}})}if(pi(t.ec)){const e=this.getCache(Ki.currentUrl);t.ec.forEach(i=>{var n,s;const r=(null===(n=t[i])||void 0===n?void 0:n.grps)||[],o=(null===(s=t[i])||void 0===s?void 0:s.reg)||"";this.setPageMatchData(i,{matchedGrps:r,urlRegex:o}),e[i]={didMatch:!0,reason:ji.INCLUDE_PASSED,cacheHit:!0,hadNonTagMatch:!0}})}}}getCache(e,t){return t?(this.pageConfigCache=this.pageConfigCache||{},this.pageConfigCache[e]=this.pageConfigCache[e]||{},this.pageConfigCache[e]):(this.experimentConfigCache=this.experimentConfigCache||{},this.experimentConfigCache[e]=this.experimentConfigCache[e]||{},this.experimentConfigCache[e])}getPreviewParamsCleanedUrl(e){return e?(this.previewParamsCleanedUrlCache=this.previewParamsCleanedUrlCache||{},this.previewParamsCleanedUrlCache[e]||(this.previewParamsCleanedUrlCache[e]=Fi.get("jsLibUtils").getCleanedUrl(e,!0)),this.previewParamsCleanedUrlCache[e]):e}getIndexFileCleanedUrl(e){return e?(this.indexFileCleanedUrlCache=this.indexFileCleanedUrlCache||{},this.indexFileCleanedUrlCache[e]||(this.indexFileCleanedUrlCache[e]=e.replace(Ki.cleanerRegex,"$1$2$3$5$6")),this.indexFileCleanedUrlCache[e]):e}validatePage(e,t,i,{debug:n=!1,allowEmptyUrl:s=!1,data:r={campId:void 0,pgGrpId:void 0,cacheOnly:!1}}={}){const o=t?this.pageConfig[e]:this.experimentConfig[e];if(!o)return gi.info(`ConfigId ${e} is not present inside ${t?"pageConfig":"experimentConfig"}`),{didMatch:!1,reason:ji.INCLUDE_FAILED,cacheHit:!1};let a=i;s||a||(a=Ki.currentUrl);const d=this.getCache(a,t);if(d&&Object.hasOwnProperty.call(d,e))return gi.info(`Fetching value from cache for ${t?"pageConfigId":"experimentConfigId"} = ${e}`),d[e].cacheHit=!0,d[e];if(r.cacheOnly)return{didMatch:!1,reason:ji.INCLUDE_FAILED,cacheHit:!1};let l;const c=o.exc,u=o.inc;if(Array.isArray(c)&&c.length>0){const t=this.evaluateDSL(c,a,{debug:n||!1,allowEmptyUrl:s,data:r});if(t.didMatch)return l={didMatch:!t.didMatch,reason:ji.EXCLUDE_PASSED,cacheHit:!1},n||(d[e]=l),l}if(Array.isArray(u))if(u.length){const e=this.evaluateDSL(u,a,{debug:n||!1,allowEmptyUrl:s,data:r});l=e.didMatch?{didMatch:e.didMatch,reason:ji.INCLUDE_PASSED,cacheHit:!1,hadNonTagMatch:e.hadNonTagMatch}:{didMatch:e.didMatch,reason:ji.INCLUDE_FAILED,cacheHit:!1}}else l={didMatch:!0,reason:ji.INCLUDE_PASSED,cacheHit:!1};return l=l||{didMatch:!1,reason:ji.INCLUDE_FAILED,cacheHit:!1},n||(d[e]=l),l}evaluateDSL(e,t,{debug:i=!1,allowEmptyUrl:n=!1,data:s={campId:void 0,pgGrpId:void 0,cacheOnly:!1}}={}){let r=!1;if(!pi(e)||e.length<2)return gi.error("Invalid dsl tree",e),{didMatch:!1,hadNonTagMatch:!1};const o=[];e.forEach(e=>{var a,d;let l;if(e||(l=!1),mi(e)&&(l=e),pi(e))if(Ki.logicalOperators.includes(e[0]))l=this.evaluateDSL(e,t,{debug:i,allowEmptyUrl:n,data:s}),l.hadNonTagMatch&&(r=!0),l=l.didMatch;else{const[o,c,...u]=e,g=null===(a=Mi.plugins[ki.OPERATOR])||void 0===a?void 0:a.get(c);let h,v=!1;if(o.includes("url"))h=this.getIndexFileCleanedUrl(this.getPreviewParamsCleanedUrl(t));else if(o.startsWith("tags.")){v=!0;const e=o.split(".")[1];null===(d=Mi.plugins[ki.TAG])||void 0===d||d.get(e).fn(void 0,s),h=!0}else{const e=u[0];h=this.validatePage(e,!0,t,{debug:i,allowEmptyUrl:n,data:s}).didMatch,u[0]=!0}l=null==g?void 0:g(h,...u,{jsLibUtils:Fi.get("jsLibUtils"),pageUrl:!0,pgConfigId:s.pgGrpId}),!v&&l&&(r=!0)}o.push(l||!1)});const a=this.evaluateTree(o);return{didMatch:a,hadNonTagMatch:a&&r}}evaluateTree(e){let t=!1;switch(e[0]){case Bi.AND:t=!e.includes(!1);break;case Bi.OR:t=e.includes(!0)}return t}}var zi=new Ki;class Yi{constructor(){const e=function(e,t){Object.defineProperty(this,e,{get:t,enumerable:!0})}.bind(this);e("settings",()=>Ui.values[Ri.SETTINGS]),e("custom",()=>Ui.values[Ri.CUSTOM]),e("url",()=>window._vis_opt_url||window.location.href),e("refUrl",()=>window.document.referrer)}get triggers(){return Ui.values[Ri.TRIGGERS]}get tags(){return Ui.values[Ri.TAGS]}get pageGroupExperimentConfig(){return zi.experimentConfig}get pageGroupPageConfig(){return zi.pageConfig}get events(){return Ui.values[Ri.EVENTS]}get eventsHistory(){return this.events[Pi.HISTORY]}get window(){return window}addNameSpace(e=""){const t=e.split(".")[0];t in this||Object.defineProperty(this,t,{get:()=>Ui.values[t],configurable:!0,enumerable:!0})}getValue(e=""){return Ui.getValue(e)}getHistoryEvents(e){var t,i,n;const s=[];null===(t=this.events[Pi.HISTORY])||void 0===t||t.forEach(({name:t,event:i})=>{t===e&&s.push(i)});const r=null===(n=null===(i=window.VWO)||void 0===i?void 0:i._)||void 0===n?void 0:n.crossStore;let o=null==r?void 0:r.getLocal({key:Pi.HISTORY});return o&&(o=JSON.parse(o)),o&&o.forEach(({name:t,event:i})=>{t===e&&s.push(i)}),s}async getCrossStoreHistoryEvents(e){return new Promise(t=>{const i=[];window.fetcher.getValue("VWO._.crossStore.getLocal",[{key:Pi.HISTORY}]).then(n=>{let s;n&&(s=JSON.parse(n)),s&&s.forEach(({name:t,event:n})=>{t===e&&i.push(n)}),t(i)}).catch(()=>{t(i)})})}}var Ji=new Yi,Xi={MAX_EVENTS_HISTORY:1e4,MAX_LOGS_HISTORY:1e3,EVENTS_TO_PERSIST:["s.q","s.r"]};class qi{refreshState(e){Ui.setValues(e)}addValues(e,t=Ri.CUSTOM){const i=t===Ri.ROOT?"":t;Ui.setValues(e,i),i?Ji.addNameSpace(i):Object.keys(e).forEach(e=>{Ji.addNameSpace(e)})}set(e,t,i=Ri.CUSTOM){this.addValues({[e]:t},i)}clear(e){Ui.clear(e)}clearAll(){Ui.reset()}updateSettings(e,t=""){this.addValues(e,t?`${Ri.SETTINGS}.${t}`:Ri.SETTINGS)}addEventInHistory({name:e,event:t}){window.fetcher.getValue('window.VWO._.eventStore.storeEvent("${{1}}")',null,{captureGroups:[t]});const i=Ui.values[Ri.EVENTS][Pi.HISTORY];i.push({name:e,event:t}),i.length>Xi.MAX_EVENTS_HISTORY&&i.shift(),Xi.EVENTS_TO_PERSIST.indexOf(e)>-1&&window.fetcher.getValue("VWO._.crossStore.getLocal",[{key:Pi.HISTORY}]).then(i=>{let n=i;n?(n=JSON.parse(n),n.push({name:e,event:t})):n=[{name:e,event:t}],window.fetcher.getValue("VWO._.crossStore.set",[Pi.HISTORY,JSON.stringify(n)])}).catch(e=>{console.log(e)})}addLogsForDebugging(e){const t=Ui.values[Ri.DEBUG][Di.LOGS];t.push(e),t.length>Xi.MAX_LOGS_HISTORY&&t.shift()}updateTriggerState(e,t){this.addValues({state:t},`${Ri.TRIGGERS}.${e}`)}updateTriggerLastMetTS(e,t){this.addValues({lastMetTS:t},`${Ri.TRIGGERS}.${e}`)}updateTagState(e,t){qi.logger.debug(`Updating tag ${e} in store' with `,t),this.addValues(t,`${Ri.TAGS}.${e}`)}clearTriggerState(e=""){this.clear(e?`${Ri.TRIGGERS}.${e}`:Ri.TRIGGERS)}updateTriggerExecutionCount(e,t){this.addValues({executionCount:t},`${Ri.TRIGGERS}.${e}`)}}qi.logger=new di("warn");var Qi=new qi;class Zi{setStoragePlugin(e){this.storagePlugin=e}}var en=new Zi;const tn={SURVEY_ID:"{{survey_id}}"};function nn(e,t){if(e.filters)for(let i=0;i<e.filters.length;i++)if("string"!=typeof e.filters[i])for(let n=0;n<e.filters[i].length;n++)e.filters[i][n]===tn.SURVEY_ID&&(e.filters[i][n]=t);return e}class sn{async execute({callbacks:e,data:t,eventName:i}){let n=t;for(let t=0;t<e.length;t++)if(Ti(e[t])||Ci(e[t])){const s=await e[t](n,i);s&&(n=s)}}}var rn=new sn;function on(e){const t=e;return t.VWO=t.VWO||{firedTime:Date.now()},t.VWO.firedTime=t.VWO.firedTime||Date.now(),t}class an{constructor(){this.events={},this.eventIdsMapping={},this.globalInterceptors={},this.eventId=0,this.eventsFrequencyManager={}}setGlobalInterceptors(e={}){this.globalInterceptors=e}async trigger(e,t={},i={}){const n=on(t);e!==ii.TIMER&&gi.info(`Triggering event '${e}'`,{data:n,event:this.events[e]}),Object.values(ii).every(t=>!e.startsWith(t))&&!(null==n?void 0:n.preventWildCardEvent)&&(this.addComputedEventProps(e,n),await this.trigger(ii.WILD_CARD,n,{eventName:e}),Qi.addEventInHistory({name:e,event:n}));const s=this.events[e];let r;r=this.eventsFrequencyManager[e]?this.eventsFrequencyManager[e].then(()=>this.executeListeners(e,n,i,s)):this.executeListeners(e,n,i,s),this.eventsFrequencyManager[e]=r,await r}async executeListeners(e,t,i={},n){const s=null==n?void 0:n.length;if(s){const r=[],o=n.push;n.push=s=>{o.call(n,s),r.push(new Promise(n=>{queueMicrotask(async()=>{await rn.execute({callbacks:[this.globalInterceptors.before,s.before,s.fn,this.globalInterceptors.after,s.after],data:t,eventName:i.eventName||e}),this.eventIdsMapping[s.id].executionCount++,n(null)})}))};for(let o=0;o<s;++o){const s=n[o];gi.debug(`Synchronously executing listener for event '${s.id}' with event name '${e}'`),r.push(rn.execute({callbacks:[this.globalInterceptors.before,s.before,s.fn,this.globalInterceptors.after,s.after],data:t,eventName:i.eventName||e}).then(()=>{this.eventIdsMapping[s.id].executionCount++}))}await Promise.all(r),n.push=o}else e!==ii.TIMER&&gi.debug(`No callbacks for the event ${e}. Events List in eventBus is`,this.events)}on(e,t,{before:i,after:n}={}){var s;gi.debug(`Attaching listener for event name '${e}'`);const r=++this.eventId,o=Object.assign(Object.assign({id:r,fn:t},i&&{before:i}),n&&{after:n});return this.events[e]=this.events[e]||[],this.events[e].push(o),this.eventIdsMapping[r]={executionCount:0,event:o},null===(s=Mi.plugins[ki.EVENT])||void 0===s||s.addDomEvent(e),this.eventId}off(e,t){var i,n;gi.debug(`Removing a listener for event '${e}'`,{reference:t});const s=null===(i=this.events[e])||void 0===i?void 0:i.push;this.events[e]=null===(n=this.events[e])||void 0===n?void 0:n.filter(e=>Ti(t)?e.fn!==t:e.id!==Number(t)),s&&(this.events[e].push=s)}remove(e){gi.debug(`Removing all the listener for event '${e}'`),this.events[e]=[]}removeAll(){gi.debug("Removing all the listener for every event"),this.events={},this.eventIdsMapping={}}event(e){return{register(t,i){gi.debug(`Registering hooks for event ID '${e}'`,{hook:t}),this.eventIdsMapping[e][t]=i},get executionCount(){return this.eventIdsMapping[e].executionCount},get hasExecuted(){return Boolean(this.eventIdsMapping[e].executionCount)}}}addComputedEventProps(e,t){var i,n;const s=(null===(i=Mi.plugins[ki.EVENT_PROPS])||void 0===i?void 0:i.get("*"))||{},r=(null===(n=Mi.plugins[ki.EVENT_PROPS])||void 0===n?void 0:n.get(e))||{},o=Object.assign(Object.assign({},s),r);Object.keys(o).forEach(i=>{t[i]=o[i](t,e)})}}var dn=new an,ln;!function(e){e.AND="a",e.OR="o"}(ln||(ln={}));class cn{evaluateExpression(e){return e&&this.recursivelyEvaluateTree(0,e)}recursivelyEvaluateTree(e,t){const i=t[e];if(Oi(i))return Boolean(t[e]);if(pi(i))return Boolean(i[0]);if(!fi(i))return!0;const n=2*(e+1)-1,s=2*(e+1);return this.isValid(mi(i)?i:JSON.parse(JSON.stringify(i)),this.recursivelyEvaluateTree(n,t),this.recursivelyEvaluateTree(s,t))}isValid(e,t,i){switch(e){case ln.AND:return t&&i;case ln.OR:return t||i;default:throw new Error(e)}}}var un=new cn,gn;class hn{clearData(){}}!function(e){e.EVENT="event",e.FORMULA="formula",e.CUSTOM="custom",e.SETTINGS="settings",e.DEFAULT="default",e.STORAGE="storage",e.WINDOW="window",e.TAGS="tags"}(gn||(gn={}));const vn=(e,t)=>{try{return e()}catch(e){return t}},pn=e=>{vn(()=>window.VWO._.customError(e))};function wn(e){return vn(()=>e.toLowerCase(),"")}class En{async getValue({event:e,variableName:t,formulaValues:i}){if(gi.debug(`Extracting value of variable '${t}'`),pi(t)){return Promise.all(t.map(async t=>await this.extractVariableValue({event:e,variableName:t,formulaValues:i})))}return this.extractVariableValue({event:e,variableName:t,formulaValues:i})}async extractVariableValue({event:e,variableName:t,formulaValues:i}){var n,s;gi.debug(`Extracting value of variable '${t}'`);const{type:r,key:o}=this.getVariableTypeAndKey(t);let a,d=!1;switch(gi.debug(`Evaluated type and key of variable '${t}' are `,{type:r,key:o}),r){case gn.EVENT:a=e;break;case gn.FORMULA:a=i;break;case gn.CUSTOM:a=Ji.custom;break;case gn.SETTINGS:a=Ji.settings;break;case gn.WINDOW:a=this.getValueFromMtWindow(o);break;case gn.TAGS:try{a=o.startsWith("js")?await(null===(n=Mi.plugins[ki.TAG])||void 0===n?void 0:n.get(o).fn()):null===(s=Mi.plugins[ki.TAG])||void 0===s?void 0:s.get(o).fn}catch(e){}break;case gn.STORAGE:{const e=Mi.plugins[ki.STORAGE],t=o.split("."),[i,...n]=t,s=vn(()=>e.get(i)),r="cookies"===i;if("includes"===n[0]){const e=n[1];a=await vn(()=>s.includes(e,r))}else a=await vn(()=>s.getItem(n.join("."),r));break}default:a=Ji,d=!0}let l=r===gn.STORAGE||r===gn.WINDOW?a:this.extractValue(a,o);return l=r===gn.TAGS?a:l,d&&Ei(l)&&(l=this.getValueFromMtWindow(o)),gi.debug(`Evaluated value of variable '${t}' is '${l}'`),l}async getValueFromMtWindow(e){const t=window.fetcher||{getValue:e=>Promise.resolve(window[e])};let i;try{i=await t.getValue(e)}catch(e){}return i}getVariableTypeAndKey(e){gi.debug(`Getting type and key of variable '${e}'`);const t=e.split("."),i=vn(()=>t.splice(0,1)[0].toLowerCase());return Object.values(gn).includes(i)?{type:i,key:t.join(".")}:{type:gn.DEFAULT,key:e}}extractValue(e,t){try{return e[t]||t.split(".").reduce((e,t)=>e[t],e)}catch(e){return}}}var fn=new En;class _n{sum(e,t){return e.reduce((e,i)=>e+t.reduce((e,t)=>e+(Number(i[t])||0),0),0)}multiply(e,t){return e.reduce((e,i)=>e+t.reduce((e,t)=>e*(Number(i[t])||1),1),1)}}var mn=new _n;class On{static ordered(e,t){const i=On.getTriggerConditionsOrderState(e.id);for(let n=0;n<t.length;n++){const s=t[n];if(!i[s]&&!e.currentSatisfiedConditions[s])return!1;i[s]=!0,Qi.updateTriggerState(On.generateTriggerOrderingNamespace(e.id),i)}return!0}static strict(e,t){const i=Object.keys(On.getTriggerConditionsOrderState(e.id)).map(e=>Number(e)).sort((e,i)=>t.indexOf(e)-t.indexOf(i)),n=Object.keys(e.currentSatisfiedConditions).filter(t=>Boolean(e.currentSatisfiedConditions[t])).map(e=>Number(e)).sort((e,i)=>t.indexOf(e)-t.indexOf(i)),s=[...i,...n].slice(0,t.length);let r={};for(let i=0;i<s.length;i++){if(t[i]!==s[i]){r={};for(let e=0;e<n.length&&t[e]===n[e];e++)r[n[e]]=!0;return Qi.updateTriggerState(On.generateTriggerOrderingNamespace(e.id),r),!1}r[s[i]]=!0}return Qi.updateTriggerState(On.generateTriggerOrderingNamespace(e.id),r),s.length===t.length}static generateTriggerOrderingNamespace(e){return`${e}.order`}static getTriggerConditionsOrderState(e){return Ji.getValue(`${Ri.TRIGGERS}.${this.generateTriggerOrderingNamespace(e)}.state`)||{}}}var Sn={sum:mn.sum,multiply:mn.multiply,ordered:On.ordered,strict:On.strict};const yn={UNKNOWN_SET_API_TYPE:"Unknown type '{{type}}' found in set API.",EVENTS:{ALREADY_EXISTS:"Event with name '{{eventName}}' already exists. Please use 'update' API if you want to override it.",NOT_REGISTERED:"Event with name '{{eventName}}' has not been registered yet. Please use 'add' API to register it."},OPERATORS:{ALREADY_EXISTS:"Operator with name '{{operatorName}}' already exists. Please use 'update' API if you want to override it.",NOT_REGISTERED:"Operator with name '{{operatorName}}' has not been registered yet. Please use 'add' API to register it."},FORMULAS:{ALREADY_EXISTS:"Formula with name '{{formulaName}}' already exists. Please use 'update' API if you want to override it.",NOT_REGISTERED:"Formula with name '{{formulaName}}' has not been registered yet. Please use 'add' API to register it."},STORAGES:{ALREADY_EXISTS:"Storage with name '{{storageName}}' already exists. Please use 'update' API if you want to override it.",NOT_REGISTERED:"Storage with name '{{storageName}}' has not been registered yet. Please use 'add' API to register it."},TAGS:{ALREADY_EXISTS:"Tag with name '{{tagName}}' already exists. Please use 'update' API if you want to override it.",NOT_REGISTERED:"Tag with name '{{tagName}}' has not been registered yet. Please use 'add' API to register it."},EVENT_PROP:{ALREADY_EXISTS:"Event property with name '{{propName}}' already exists for event '{{eventName}}'. Please use 'update' API if you want to override it.",NOT_REGISTERED:"Event property with name '{{propName}}' has not been registered yet for event '{{eventName}}'. Please use 'add' API to register it."}},Tn={EVENTS:{NO_EVENT_TO_REMOVE:"Unable to remove Event '{{eventName}}' as it's not been registered."},OPERATORS:{NO_OPERATOR_TO_REMOVE:"Unable to remove Operator '{{operatorName}}' as it's not been registered."},FORMULAS:{NO_FORMULA_TO_REMOVE:"Unable to remove Formula '{{formulaName}}' as it's not been registered."},STORAGES:{NO_STORAGE_TO_REMOVE:"Unable to remove Storage '{{storageName}}' as it's not been registered."},TAGS:{NO_TAG_TO_REMOVE:"Unable to remove Tag '{{tagName}}' as it's not been registered."},EVENT_PROP:{NO_EVENT_PROP_TO_REMOVE:"Unable to remove Event property '{{propName}}' for event '{{eventName}}' as it's not been registered."}};class Cn extends hn{constructor(){super(),this.pluginName=ki.FORMULA,this.formulas={},this.initialize()}add(e,t){gi.debug(`Adding formula '${e}' in FormulasManager`),this.formulas[e]?gi.error(yn.FORMULAS.ALREADY_EXISTS,{formulaName:e}):this.formulas[e]=t}update(e,t){gi.debug(`Updating formula '${e}' in FormulasManager`),this.formulas[e]=t}get(e){return gi.debug(`Getting formula '${e}' in FormulasManager`),this.formulas[e]?this.formulas[e]:(gi.error(yn.FORMULAS.NOT_REGISTERED,{formulaName:e}),null)}remove(e){gi.debug(`Removing formula '${e}' in FormulasManager`),this.formulas[e]?delete this.formulas[e]:gi.warn(Tn.FORMULAS.NO_FORMULA_TO_REMOVE,{formulaName:e})}removeAll(){gi.debug("Removing all formulas in FormulasManager"),this.formulas={}}initialize(){Object.keys(Sn).forEach(e=>{this.add(e,Sn[e])})}}class In{evaluate(e=[],t){const i={};return e.forEach(e=>{const n=this.evaluateFormulaExpression(e,t);i[e.id]=n}),i}evaluateFilter(e,t){return e.reduce((e,t)=>this.evaluateFormulaExpression(t,e),t)}evaluateArgs(e,t){return e.map(e=>this.evaluateFormulaExpression(e,t))}evaluateFormulaExpression(e,t){var i;return(e.fn||(null===(i=Mi.plugins[ki.FORMULA])||void 0===i?void 0:i.get(e.type)))(fi(e.filters)?this.evaluateFilter(e.filters,t):t,fi(e.args)?e.args.map(e=>vi(e)?this.evaluateArgs([e],t)[0]:e):e.args)}}var Nn=new In,An,Vn;class bn{clearData(){}get persistedState(){return""}}function Rn(e){return e&&e instanceof bn}function Pn(e){return vi(e)&&!Rn(e)}!function(e){e.EQUAL="eq",e.NOT_EQUAL="neq",e.EQUAL_CASE_SENSITIVE="eqs",e.NOT_EQUAL_CASE_SENSITIVE="neqs",e.REGEX="reg",e.REGEX_CASE_SENSITIVE="regs",e.CONTAINS="cn",e.NOT_CONTAINS="ncn",e.BLANK="bl",e.NOT_BLANK="nbl",e.GREATER_THAN="gt",e.LESS_THAN="lt",e.GREATER_THAN_EQUAL="gte",e.LESS_THAN_EQUAL="lte",e.IN="in",e.NOT_IN="nin",e.EXEC="exec",e.SELECTOR="sel",e.IN_LOCATION="inloc",e.NOT_IN_LOCATION="ninloc",e.URL_REGEX="urlReg",e.NOT_URL_REGEX="nUrlReg",e.RANGE_COMPARISON="rg",e.PAGE_CONFIG_EVALUATION="pgc"}(An||(An={})),function(e){e.PAGE="PAGE",e.EVENT="EVENT",e.JS_VARIABLE="JS_VARIABLE"}(Vn||(Vn={}));class Dn{constructor(){this.serializeValidationQueue={}}async isValid(e,t,i,n,s={},r=!1){gi.debug(`Checking validity of trigger '${e}'`,{trigger:t,event:i,eventName:n}),this.saveEventState(e,n,!0);const{isValid:o,shouldRemoveEventListener:a}=await this.validateTrigger(t,i,{eventName:n,triggerName:e,exitTriggersMet:s,validateFromState:r});return this.saveTriggerState(e,this.hasTriggerMetBefore(e)||o),n!==ii.TRIGGER_UPDATES&&dn.trigger(ii.TRIGGER_UPDATES,{id:e,state:o?"1":"0",isDyn:(null==t?void 0:t.isDyn)?"1":"0"}),{isValid:o,shouldRemoveEventListener:a}}async validateTrigger(e,t,{eventName:i,triggerName:n,skipEventProps:s,exitTriggersMet:r,skipValidationIfTimer:o,validateFromState:a}={},d){return n?(this.serializeValidationQueue[n]=this.serializeValidationQueue[n]||Promise.resolve(),this.serializeValidationQueue[n]=this.serializeValidationQueue[n].then(()=>a?this.validateFromState(e,{triggerName:n,exitTriggersMet:r}):this.validateTriggerHandler(e,t,{eventName:i,triggerName:n,skipEventProps:s,exitTriggersMet:r,skipValidationIfTimer:o},d)),this.serializeValidationQueue[n]):this.validateTriggerHandler(e,t,{eventName:i,triggerName:n,skipEventProps:s,exitTriggersMet:r,skipValidationIfTimer:o},d)}async validateFromState(e,{triggerName:t}={}){const i={},n=e=>{const s=e=>()=>pi(e)?n(e):e?!1!==e.persistState&&this.hasConditionMetBefore(t,e.id)?(i[e.id]=!0,Promise.resolve([!0,this.getTimeStampForConditionMet(t,e.id)])):Promise.resolve([!1,0]):null;if(Rn(e[0])){return e[0].fn({},...e.slice(1).map(s))}return s(e[0])()};let s=e.cnds;e.dslv&&1!==e.dslv||(s=this.convertLevelOrderToTree(e.cnds,0),s=pi(s)?s:[s]);const r=(await n(s))[0],o=!e.formula||e.formula.every(e=>{var n,s;return null===(s=null===(n=Mi.plugins[ki.FORMULA])||void 0===n?void 0:n.get(e.type))||void 0===s?void 0:s({id:t,currentSatisfiedConditions:i},e.args)});return{isValid:o&&r,shouldRemoveEventListener:!1}}iterateAndValidate(e,t,i,n,s,r,o={}){const a=e=>async(o={})=>{if(pi(e))return this.iterateAndValidate(e,t,i,n,s,r,o);let a=!0,d=!1;if(i){if((!o.doNotUseCache||n!==e.event)&&!1!==e.persistState&&this.hasConditionMetBefore(i,e.id))return gi.debug("Trigger condition already met before. Skipping it's validation.",{triggerName:i,conditionId:e.id}),[!0,this.getTimeStampForConditionMet(i,e.id)];a=this.hasEventOccurred(i,e.event),e.hist&&e.event!==n&&(d=!0),a||gi.debug("Event hasn't occurred before. Skipping it's validation.",{triggerName:i,event:e.event})}if(n&&e.event!==n)return[!1,0];const l=(a||d)&&await this.validateTriggerOperand(e,e.event===n||(null==t?void 0:t.useUnsavedEvents)?t:{fromLocalStorage:!0},{eventName:e.event,skipEventProps:s,triggerName:i});return!l&&!1!==e.persistState&&this.hasConditionMetBefore(i,e.id)?[!0,this.getTimeStampForConditionMet(i,e.id)]:(i&&this.saveConditionState(i,e.id,l,n===e.event?t.VWO.firedTime:null),l&&!1!==e.persistState&&(r[e.id]=!0),[l,l?this.getTimeStampForConditionMet(i,e.id):0])};if(Rn(e[0])){return e[0].fn(o,...e.slice(1).map(a))}return a(e[0])()}convertLevelOrderToTree(e,t){if(!e[t])return null;if(mi(e[t])||Rn(e[t])){const i=[e[t]],n=this.convertLevelOrderToTree(e,2*(t+1)-1);n&&i.push(n);const s=this.convertLevelOrderToTree(e,2*(t+1));return s&&i.push(s),i}return e[t]}async validateTriggerHandler(e,t,{eventName:i,triggerName:n,skipEventProps:s,exitTriggersMet:r,skipValidationIfTimer:o}={},a){try{if(!e||!vi(e))return{isValid:!0,shouldRemoveEventListener:!1};if(o){const{cnds:t}=e,i=e=>pi(e)?e.some(i):!(!Pn(e)||e.event!==ii.TIMER);if(t.some(i))return{isValid:!0,shouldRemoveEventListener:!1}}const d={};let l=!1;if(i){const{cnds:r}=e,o=r.length,d=async e=>{if(pi(e))return void await Promise.all(e.map(d));a&&Pn(e)&&nn(e,a);let r=!1;if(Pn(e)&&e.event===i){let o=!0;(e.filters||[]).forEach(async e=>{mi(e)||"exec"===e[1]&&(o=!1)}),o&&(r=await this.validateTriggerOperand(e,t,{eventName:i,triggerName:n,skipEventProps:s}))}r&&(l=!0)};for(let e=0;e<o;++e)await d(r[e])}else l=!0;let c=null==e?void 0:e.cnds;e.dslv&&1!==e.dslv||(c=this.convertLevelOrderToTree(c,0),c=pi(c)?c:[c]);const u=(await this.iterateAndValidate(c,t,n,i,s,d,{}))[0];gi.debug("Generated tree conditions for trigger",{triggerName:n,treeConditions:u});const g=!e.formula||e.formula.every(e=>{var t,i;return null===(i=null===(t=Mi.plugins[ki.FORMULA])||void 0===t?void 0:t.get(e.type))||void 0===i?void 0:i({id:n,currentSatisfiedConditions:d},e.args)}),h=this.shouldRemoveEventListener(i,c,d,r);return{isValid:l&&g&&u,shouldRemoveEventListener:h}}catch(i){let s;throw(null==e?void 0:e.cnds)||(s=`Empty Triggger Present - ${n}`),126657===window._vwo_acc_id&&window.VWO._.customError&&window.VWO._.customError({msg:i.stack||i.message||"Something wrong in TValidator",url:"Error in triggerValidator",lineno:252,colno:5,source:JSON.stringify({triggerName:n,event:t,trigger:JSON.stringify(e),errMsg:i.message,errStk:i.stack})}),new Error(s||i)}}async validateTriggerOperand({filters:e,formula:t,id:i,hist:n},s,{eventName:r,triggerName:o,skipEventProps:a=!1}={}){var d;const l=Nn.evaluate(t,[s]);if(n&&Object.keys(n).length&&r&&s){const e=window.VWO.modules.eventHistHandler.getEventsByDate(r,n.dr,s);let t;if(null===(d=n.pf)||void 0===d?void 0:d.length){const i=this.evaluateDSL.bind(this),s=null==e?void 0:e.map(async e=>i(n.pf,{triggerName:o,eventName:r,event:e,formulaValues:l}));t=s&&await Promise.all(s),t=e.filter((e,i)=>t[i])}else t=e;Object.keys(n.data).length&&(s._meta=window.VWO.modules.eventHistHandler.getCumulativeData(t,n.data))}const c=null==e?void 0:e.map(async(e,t)=>{var n,d,c,u,g,h;if(mi(e))return e;const v=null===(u=null===(c=null===(d=null===(n=s)||void 0===n?void 0:n.preComputedConds)||void 0===d?void 0:d[o])||void 0===c?void 0:c[i])||void 0===u?void 0:u[t];if("boolean"==typeof v)return v;let[p,w,...E]=e;if((null===(g=window._vwoCc)||void 0===g?void 0:g.syncServerUrl)&&(E=await Promise.all(this.processRhsOperand(E))),a&&p.startsWith(`${gn.EVENT}.`))return!0;const f=await fn.getValue({event:s,variableName:p,formulaValues:l}),_=null===(h=Mi.plugins[ki.OPERATOR])||void 0===h?void 0:h.get(w),m={eventName:r,triggerName:o,jsLibUtils:Fi.get("jsLibUtils")};return w===An.PAGE_CONFIG_EVALUATION&&-1!==p.indexOf("page.referrerUrl")&&(m.allowEmptyUrl=!0),await(null==_?void 0:_(f,...E,m))||!1}),u=c&&await Promise.all(c);return!u||this.evaluateFilterExpression(u)}evaluateFilterExpression(e){if(!Oi(e[0]))return un.evaluateExpression(e);for(let t=e.length-1;t>=0;--t)if(!e[t])return!1;return!0}hasEventOccurred(e,t){return Boolean(Ji.getValue(`${Ri.TRIGGERS}.${this.generateTriggerEventId(e,t)}.state`))}hasConditionMetBefore(e,t){return Boolean(Ji.getValue(`${Ri.TRIGGERS}.${this.generateTriggerConditionId(e,t)}.state`))}getTimeStampForConditionMet(e,t){return Number(Ji.getValue(`${Ri.TRIGGERS}.${this.generateTriggerConditionId(e,t)}.lastMetTS`))}hasTriggerMetBefore(e){return Boolean(Ji.getValue(`${Ri.TRIGGERS}.${e}.state`))}saveTriggerState(e,t){Qi.updateTriggerState(e,t)}saveEventState(e,t,i){gi.debug("Saving trigger event's state i.e. it's event occurred or not.",{triggerName:e,eventName:t,state:i}),Qi.updateTriggerState(this.generateTriggerEventId(e,t),i)}saveConditionState(e,t,i,n){gi.debug("Saving trigger condition's state i.e. it's condition satisfied or not.",{triggerName:e,conditionId:t,state:i}),Qi.updateTriggerState(this.generateTriggerConditionId(e,t),i),i&&Qi.updateTriggerLastMetTS(this.generateTriggerConditionId(e,t),n)}generateTriggerConditionId(e,t){return`${e}.trigger.${t}`}generateTriggerEventId(e,t){return`${e}.event.${t}`}shouldRemoveEventListener(e,t,i,n){if(e===ii.TIMER){const e=t=>pi(t)?t.every(e):!(Pn(t)&&t.event===ii.TIMER&&!n[t.exitTrigger]&&!i[t.id]);return t.every(e)}return!1}async evaluateDSL(e,{triggerName:t,eventName:i,event:n,formulaValues:s}){if(pi(e)&&e.length>1){const r=e.map(async e=>{var r,o;let a;if(e||(a=!1),mi(e)&&(a=e),pi(e))if([Bi.AND,Bi.OR].includes(e[0]))a=this.evaluateDSL(e,{triggerName:t,eventName:i,event:n,formulaValues:s});else{let[d,l,...c]=e;(null===(r=window._vwoCc)||void 0===r?void 0:r.syncServerUrl)&&(c=await Promise.all(this.processRhsOperand(c)));const u=null===(o=Mi.plugins[ki.OPERATOR])||void 0===o?void 0:o.get(l),g=await fn.getValue({event:n,variableName:d,formulaValues:s});a=await(null==u?void 0:u(g,...c,{eventName:i,triggerName:t,jsLibUtils:Fi.get("jsLibUtils")}))||!1}return a}),o=r&&await Promise.all(r);return this.evaluateTree(o)}return!1}evaluateTree(e){let t=!1;switch(e[0]){case Bi.AND:t=!e.includes(!1);break;case Bi.OR:t=e.includes(!0)}return t}processRhsOperand(e){return e.map(e=>{if("string"==typeof e&&e.startsWith("{{")&&e.endsWith("}}")){const t=e.slice(2,-2);return fn.getValueFromMtWindow(t)}return e})}}var xn=new Dn;class Ln{constructor(){this.triggerEventListeners={}}initialize(e){Object.keys(e).forEach(t=>{this.triggerEventListeners[t]?Qi.updateTriggerExecutionCount(t,0):this.add(t,e[t])})}addFunctionBasedTriggers(e,t){Object.keys(t.ev).forEach(t=>{t!==si.PAGE_UNLOAD_EVENT?vn(()=>{Mi.plugins[ki.EVENT].updateConditions(t,[{triggerName:e,dslv:3}])}):this.setPageUnloadTrigger(e)})}add(e,t,i){var n;if(gi.debug(`Attaching event listeners for all the events using in '${e}' trigger conditions.`),3===(null==t?void 0:t.dslv))this.addFunctionBasedTriggers(e,t);else{const s={};this.triggerEventListeners[e]=this.triggerEventListeners[e]||{};const r=n=>{var o,a;if(pi(n))n.forEach(r);else if(Pn(n)){if(i&&nn(n,i),null===(o=Mi.plugins[ki.EVENT])||void 0===o||o.updateConditions(n.event,[this.extractDomEventFromCondition(e,n)]),!this.triggerEventListeners[e][n.event]){n.persistState&&this.executeTriggerValidatorOfHistoryEvents(e,t,n.event),n.hist&&(window.VWO.modules.eventHistHandler.triggerEvents.push({triggerName:e,trigger:t,eventName:n.event}),(null===(a=window._vwoCc)||void 0===a?void 0:a.syncServerUrl)||this.validateEventFromHistHandler(e,t,n.event));const i=dn.on(n.event,async(n,s)=>{await this.validateAndDispatchTriggerEvent(e,t,n,s,i)});this.triggerEventListeners[e][n.event]=i}if(n.exitTrigger){const i=this.getTriggerEventName(n.exitTrigger),r=dn.on(i,o=>{s[n.exitTrigger]=1;const a=this.triggerEventListeners[e][n.event];this.validateAndDispatchTriggerEvent(e,t,o,n.event,a,s),dn.off(i,r)});this.triggerEventListeners[e][i]=r}}};null===(n=null==t?void 0:t.cnds)||void 0===n||n.forEach(r)}}async validateTriggerFromHistory(e,t){let i=t;t.cnds&&(i=t.cnds);const n=null==i?void 0:i.map(async t=>{var i;if(null===(i=t)||void 0===i?void 0:i.event){const i=Ji.getHistoryEvents(t.event),n=await Ji.getCrossStoreHistoryEvents(t.event);let s=!1;const r=[...i,...n].map(async i=>{const{isValid:n}=await xn.isValid(e,{cnds:[t]},i,t.event);n&&(s=n)});return await Promise.all(r),s}return Array.isArray(t)?this.validateTriggerFromHistory(e,t):t}),s=await Promise.all(n);return un.evaluateExpression(s)}executeTriggerValidatorOfHistoryEvents(e,t,i){Ji.getHistoryEvents(i).forEach(n=>this.validateAndDispatchTriggerEvent(e,t,n,i))}async validateEventFromHistHandler(e,t,i){await xn.isValid(e,t,on({isCustomEvent:!0,fromLocalStorage:!0}),i)}async validateAndDispatchTriggerEvent(e,t,i,n,s,r,o=!1){var a,d,l;try{const a=this.getExecutionCount(e)||0;if(t.occurrence&&t.occurrence<=a)return;const{isValid:d,shouldRemoveEventListener:l}=await xn.isValid(e,t,i,n,r,o);l&&dn.off(n,s),d&&await this.dispatchTriggerEvent(e,t,i)}catch(t){if(126657===window._vwo_acc_id){const i=(null===(l=null===(d=null===(a=window.VWO)||void 0===a?void 0:a._)||void 0===d?void 0:d.allSettings)||void 0===l?void 0:l.triggers[e])||"defNotFound";window.VWO._.customError&&window.VWO._.customError({msg:t.stack||t.message||"Something wrong in validateAndDispatch",url:"Error in validateAndDispatch",lineno:252,colno:5,source:JSON.stringify({triggerName:e,triggerDef:i,errMsg:t.message,errStk:t.stack})})}}}async dispatchTriggerEvent(e,t,i){const n=this.getExecutionCount(e)||0;return t.occurrence&&t.occurrence<=n?Promise.resolve():(Qi.updateTriggerExecutionCount(e,n+1),dn.trigger(this.getTriggerEventName(e),i))}remove(e){gi.debug(`Removing event listeners of trigger '${e}'`),Object.entries(this.triggerEventListeners[e]).forEach(([e,t])=>{dn.off(e,t)}),delete this.triggerEventListeners[e]}removeAll(){Object.keys(this.triggerEventListeners).forEach(e=>{this.remove(e)})}extractDomEvents(e){gi.debug("Extracting DOM events from triggers config");const t={};return Object.keys(e).forEach(i=>{var n,s;null===(s=null===(n=e[i])||void 0===n?void 0:n.cnds)||void 0===s||s.forEach(e=>{if(Pn(e)){this.extractDomEventFromCondition(i,e)&&(t[e.event]=t[e.event]||[],t[e.event].push(Object.assign(Object.assign({},e),{triggerName:i})))}})}),t}extractDomEventFromCondition(e,t,i){if(3===i)return{};if(t.event===ni.CLICK_EVENT&&(null==t?void 0:t.aux)&&(window.VWO._.initClickWatcher=!0),t.event===si.PAGE_UNLOAD_EVENT)this.setPageUnloadTrigger(e);else if(wn(t.event).includes(`${ti.DOM}_`))return Object.assign(Object.assign({},t),{triggerName:e});return null}setPageUnloadTrigger(e){window.VWO._.pageUnloadTriggers=window.VWO._.pageUnloadTriggers||{},window.VWO._.pageUnloadTriggers[e]=!0}getTriggerEventName(e){return`${ii.TRIGGER}.${e}`}getExecutionCount(e){try{const t=Ji.getValue(`${Ri.TRIGGERS}.${e}.executionCount`);return null!=t?t:0}catch(e){return 0}}}var Un=new Ln;class Wn{log({event:e,data:t,getters:i,actions:n,vwoEvents:s}){console.log(e,t,i,n,s)}}var Mn=new Wn,kn={log:Mn.log},Gn=Object.freeze({__proto__:null,default:kn});class Fn extends hn{constructor(){super(),this.pluginName=ki.TAG,this.tags={},this.initialize()}add(e,t,{occurrence:i,scope:n,sync:s}={}){gi.debug(`Adding tag '${e}' in TagsManager`),this.tags[e]?gi.error(yn.TAGS.ALREADY_EXISTS,{tagName:e}):this.tags[e]={fn:t,occurrence:i,scope:n,sync:s}}update(e,t,{occurrence:i,scope:n,sync:s,fireUniquelyForEveryEvent:r}={}){gi.debug(`Updating tag '${e}' in TagsManager`),this.tags[e]={fn:t,occurrence:i,scope:n,sync:s,fireUniquelyForEveryEvent:r}}get(e){return gi.debug(`Getting tag '${e}' in TagsManager`),this.tags[e]?this.tags[e]:(gi.error(yn.TAGS.NOT_REGISTERED,{tagName:e}),null)}remove(e){gi.debug(`Removing tag '${e}' in TagsManager`),this.tags[e]?delete this.tags[e]:gi.warn(Tn.TAGS.NO_TAG_TO_REMOVE,{tagName:e})}removeAll(){gi.debug("Removing all tags in TagsManager"),this.tags={}}initialize(){Object.keys(Gn).forEach(e=>{this.add(e,Gn[e])})}}class Hn{flushTagData(e){delete this._vwoEventsInstance[e]}getVwoInstanceObject(){return this._vwoEventsInstance}async executeTagUniquelyForEveryEvent(e){if(!e||!e.tags)return;const t=[];Object.keys(e.tags).forEach(i=>{const n=e.tags[i];if(n){const s=n.data,r=this.getTagDetails(i).fn({data:s,event:e.event,getters:Ji,actions:Qi,vwoEvents:this._vwoEventsInstance});t.push(r)}}),await Promise.all(t)}async execute(e,t,i,n,s){var r,o,a,d,l,c;if(this._vwoEventsInstance=s,"metric"===t.id&&(null===(d=null===(a=null===(o=null===(r=window.VWO)||void 0===r?void 0:r.modules)||void 0===o?void 0:o.utils)||void 0===a?void 0:a.libUtils)||void 0===d?void 0:d.isBot2()))return;const u="metric"===t.id||"sampleVisitor"===t.id?t.data:await fn.getValue({variableName:`${Ri.SETTINGS}.${t.data}`}),g=this.generateTagId(t.id),h=Ji.tags[g].executionCount||0,v=this.getTagDetails(t.id);if(!_i(v.occurrence)||h<v.occurrence){gi.info(`Started executing tag '${t.id}' because of:`,i),Qi.updateTagState(g,{hasExecuted:!0,executionCount:(Ji.tags[g].executionCount||0)+1,stoppedByExitCondition:!1});const s=i.name;if(this._vwoEventsInstance[s]=this._vwoEventsInstance[s]||{},s&&n.fireUniquelyForEveryEvent)return this._vwoEventsInstance[s].event=this._vwoEventsInstance[s].event||i,this._vwoEventsInstance[s].tags=this._vwoEventsInstance[s].tags||{},this._vwoEventsInstance[s].tags[t.id]=this._vwoEventsInstance[s].tags[t.id]||{},this._vwoEventsInstance[s].tags[t.id].data=this._vwoEventsInstance[s].tags[t.id].data||[],void this._vwoEventsInstance[s].tags[t.id].data.push(u);n.sync||await Promise.resolve();const r=null===(c=null===(l=v.fn)||void 0===l?void 0:l.type)||void 0===c?void 0:c.startsWith("vwoWrappedFn");i.executingTagTrigger=n.triggerName,await v.fn({data:u,event:i,getters:Ji,actions:Qi,vwoEvents:r?null:e})}else gi.info(`Maximum occurrence of ${v.occurrence} has reached. Skipping executing tag '${t.id}'`)}generateTagId(e){return`${e}`}getTagDetails(e){var t;return null===(t=Mi.plugins[ki.TAG])||void 0===t?void 0:t.get(e)}}var jn=new Hn;let $n=0;class Bn{constructor(){this.rulesMap={}}initialize(e,t){this.vwoEventsInstance=e,Object.keys(t).forEach(e=>{this.remove(e),this.add(t[e],e)})}add(e,t){(pi(e.triggers)?e.triggers:[e.triggers]).forEach(i=>{this.rulesMap[i]?gi.debug(`Skipping adding the listeners for trigger ${i} as rulesMap exist`):this.attachTriggersListeners(this.vwoEventsInstance,i),this.rulesMap[i]=this.rulesMap[i]||[],e.tags.forEach(n=>{this.rulesMap[i].push(Object.assign(Object.assign({},e),{id:t,tags:[n]}))}),this.sortPriorityRuleTags(i)})}remove(e){gi.debug(`Removing all event listeners of rule '${e}'`),Object.keys(this.rulesMap).forEach(t=>{this.rulesMap[t]=this.rulesMap[t].filter(t=>t.id!==e)})}removeAll(){Object.keys(this.rulesMap).forEach(e=>{dn.remove(Un.getTriggerEventName(e)),delete this.rulesMap[e]})}generateRandomRuleId(){return $n++,`rule_${$n}`}attachTriggersListeners(e,t){dn.on(Un.getTriggerEventName(t),async i=>{const n=this.rulesMap[t].map(n=>{const s=n.tags.map(async s=>{var r,o,a;const d=fi(s.shouldConsiderParentExitCondition)?s.shouldConsiderParentExitCondition:n.shouldConsiderParentExitCondition,l=this.getExitConditions(i,n.exitCondition,s.exitCondition,d),c=await this.shouldExit(i,l),u=jn.generateTagId(s.id);if(Qi.updateTagState(u,{stoppedByExitCondition:c,lastExitConditions:l}),c)gi.info(`Exit condition(s) met. Not executing tag '${s.id}'`,l);else{const n=null===(o=null===(r=this.vwoEventsInstance.tags)||void 0===r?void 0:r.tags)||void 0===o?void 0:o[s.id];await jn.execute(Object.assign(Object.assign({},e),{[ri.EXIT_CONDITIONS]:l,clearData:e.clearData.bind(e)}),s,i,{sync:n.sync||(null===(a=i.props)||void 0===a?void 0:a.fireLinkedTagSync),fireUniquelyForEveryEvent:n.fireUniquelyForEveryEvent,triggerName:t},e)}});return s});await Promise.all(Array.prototype.concat.apply([],n))})}sortPriorityRuleTags(e){this.rulesMap[e].sort((e,t)=>{const i=e.tags[0],n=t.tags[0];return(fi(i.priority)&&-1!==i.priority?i.priority:1/0)-(fi(n.priority)&&-1!==n.priority?n.priority:1/0)})}assignExecutionProperty(e){const t=this.rulesMap[e],i={},n=["sync","fireUniquelyForEveryEvent"];for(let e=t.length-1;e>=0;e--){const s=t[e].tags[0],r=i[s.id]||jn.getTagDetails(s.id);Object.keys(n).forEach(e=>{const t=n[e];s[t]=r[t]}),i[s.id]=r}}getExitConditions(e,t,i,n=!0){const s=n?[...e[ri.EXIT_CONDITIONS]||[]]:[];return t&&s.push(t),i&&s.push(i),s}async shouldExit(e,t=[]){const i=t.length;for(let n=0;n<i;++n){const i=t[n];if(await xn.validateTriggerOperand({filters:i},e))return!0}return!1}}var Kn=new Bn;class zn{static get(e){const t=document.cookie.split("; ").find(t=>t.startsWith(`${e}=`));return(null==t?void 0:t.split("=")[1])||""}static expire(e){document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`}}class Yn{static init(){Yn.actualReferrer=zn.get("_vwo_referrer"),zn.expire("_vwo_referrer"),"string"!=typeof Yn.actualReferrer&&(Yn.actualReferrer=document.referrer)}static get(){return-1===window.location.search.search("_vwo_test_ref")?document.referrer||"":Yn.actualReferrer}}Yn.actualReferrer="";class Jn{static get(){const{queryParams:e}=li.parseUrl(document.URL);let t,i;const n=Yn.get();if(/facebook\.com|quora\.com|reddit\.com|imgur\.com|tapiture\.com|disqus\.com|9gag\.com|tumblr\.com|plus\.google|stumbleupon\.com|twitter\.com|linkedin|del\.icio\.us|delicious\.com|technorati|digg\.com| hootsuite|stumbleupon|myspace|bit\.ly|tr\.im|tinyurl|ow\.ly|reddit|m\.facebook\.com|youtube|flickr|pinterest\.com|^https:\/\/t\.co\/|tweetdeck/.test(n))return"soc";Jn.organicReferralSource()&&(t=!0);const{gclid:s,utm_medium:r}=e;if(n&&(i=!0),t&&s)return"pst";if(r){if("email"===wn(null==r?void 0:r.toString()))return"eml";if(null==r?void 0:r.toString().match(new RegExp("^(?:cpc|ppc|cpa|cpm|cpv|cpp)$","i")))return"pst"}else if(t)return"org";return i?"ref":"dir"}static organicReferralSource(){for(let e=0;e<Jn.organicReferrals.length;e++)if(-1!==Yn.get().indexOf(Jn.organicReferrals[e].s))return Jn.organicReferrals[e].i;return 0}}Jn.organicReferrals=[{s:"search.yahoo.com/",p:"p",i:1},{s:"www.google.",p:"q",i:2},{s:"www.bing.com/",p:"q",i:3},{s:".ask.com/",p:"q",i:4},{s:"www.search.com/",p:"q",i:5},{s:"www.baidu.com/",p:"wd",i:6},{s:"search.aol.com/",p:"q",i:7},{s:"duckduckgo.com/",p:"q",i:8}];const Xn={get url(){return window._vis_opt_url||window.location.href},get refUrl(){return Yn.get()},get trafficSource(){return Jn.get()},get queryParams(){return li.parseUrl(window._vis_opt_url||window.location.href).queryParams},get timeSpent(){const e=Date.now();return Math.floor((Date.now()-e)/1e3)},get scroll(){var e,t;const{scrollY:i,innerHeight:n}=window,s=100*i/((null===(e=document.body)||void 0===e?void 0:e.offsetHeight)-n);return{pxTop:i,pxBottom:(null===(t=document.body)||void 0===t?void 0:t.offsetHeight)-n-i,top:s,bottom:100-s}},get operatingSystem(){var e;const{visitorDetails:t}=Xn;if(null===(e=null==t?void 0:t.UA)||void 0===e?void 0:e.os)return t.UA.os;const{appVersion:i}=window.navigator;return i.includes("Win")?"windows":i.includes("Mac")?"macOS":i.includes("X11")?"unix":i.includes("Linux")?"linux":""},get browser(){var e,t;return null===(t=null===(e=Xn.visitorDetails)||void 0===e?void 0:e.UA)||void 0===t?void 0:t.br},get visitorDetails(){var e,t,i,n;return(null===(n=null===(i=null===(t=null===(e=window.VWO)||void 0===e?void 0:e._)||void 0===t?void 0:t.allSettings)||void 0===i?void 0:i.dataStore)||void 0===n?void 0:n.plugins)||{}},get userAgent(){return navigator.userAgent},get deviceType(){var e,t;return null===(t=null===(e=Xn.visitorDetails)||void 0===e?void 0:e.UA)||void 0===t?void 0:t.dt},get deviceName(){var e,t;return null===(t=null===(e=Xn.visitorDetails)||void 0===e?void 0:e.UA)||void 0===t?void 0:t.de},get visitorType(){var e,t;const i=null===(t=null===(e=window.VWO)||void 0===e?void 0:e.data)||void 0===t?void 0:t.vi;return(null==i?void 0:i.vt)||"new"},get oldVisitorType(){var e,t;const i=null===(t=null===(e=window.VWO)||void 0===e?void 0:e.data)||void 0===t?void 0:t.vi;return(null==i?void 0:i.vt)||"new"},get ip(){var e;return null===(e=Xn.visitorDetails)||void 0===e?void 0:e.IP},get country(){var e,t;return null===(t=null===(e=Xn.visitorDetails)||void 0===e?void 0:e.GEO)||void 0===t?void 0:t.cn},get countryCode(){var e,t;return null===(t=null===(e=Xn.visitorDetails)||void 0===e?void 0:e.GEO)||void 0===t?void 0:t.cc},get city(){var e,t;return null===(t=null===(e=Xn.visitorDetails)||void 0===e?void 0:e.GEO)||void 0===t?void 0:t.c},get region(){var e,t;return null===(t=null===(e=Xn.visitorDetails)||void 0===e?void 0:e.GEO)||void 0===t?void 0:t.r},get gpc(){var e,t;return null===(t=null===(e=Xn.visitorDetails)||void 0===e?void 0:e.GEO)||void 0===t?void 0:t.p},get loc(){var e,t,i;const{visitorDetails:n}=Xn;return{countryCode:null===(e=null==n?void 0:n.GEO)||void 0===e?void 0:e.cc,city:null===(t=null==n?void 0:n.GEO)||void 0===t?void 0:t.c,region:null===(i=null==n?void 0:n.GEO)||void 0===i?void 0:i.r}}};class qn{static initialize(e){Qi.addValues(e,Ri.ROOT),Qi.addValues(Xn,Ri.ROOT)}}class Qn{}var Zn;!function(e){e.LOCAL_STORAGE="localStorage",e.LOCAL_STORAGE_SERVICE="localStorageService"}(Zn||(Zn={}));class es extends Qn{constructor(){super(),this.storageName=Zn.LOCAL_STORAGE}get(){return window.localStorage}getItem(e){return window.localStorage.getItem(e)}set(e){Object.keys(e).forEach(t=>{window.localStorage.setItem(t,e[t])})}setItem(e,t){window.localStorage.setItem(e,t)}deleteAll(){window.localStorage.clear()}deleteItem(e){window.localStorage.removeItem(e)}includes(){return 0}}var ts=new es,is=Object.freeze({__proto__:null,localStorage:ts});class ns extends hn{constructor(){super(),this.pluginName=ki.STORAGE,this.storages={},this.initialize()}add(e,t){gi.debug(`Adding storage plugin '${t.storageName}' in StoragesManager`),this.storages[e]?gi.error(yn.STORAGES.ALREADY_EXISTS,{storageName:e}):this.storages[e]=t}update(e,t){gi.debug(`Updating storage plugin '${e}' in StoragesManager`),this.storages[e]=t}get(e){return gi.debug(`Getting storage plugin '${e}' in StoragesManager`),this.storages[e]?this.storages[e]:(gi.error(yn.STORAGES.NOT_REGISTERED,{storageName:e}),null)}remove(e){gi.debug(`Removing storage plugin '${e}' in StoragesManager`),this.storages[e]?delete this.storages[e]:gi.warn(Tn.STORAGES.NO_STORAGE_TO_REMOVE,{storageName:e})}removeAll(){gi.debug("Removing all storage plugins in StoragesManager"),this.storages={}}initialize(){Object.keys(is).forEach(e=>{this.add(e,is[e])})}}class ss extends hn{constructor(){super(),this.pluginName=ki.OPERATOR,this.operators={}}add(e,t){gi.debug(`Adding operator '${e}' in OperatorsManager`),this.operators[e]?gi.error(yn.OPERATORS.ALREADY_EXISTS,{operatorName:e}):this.operators[e]=t}update(e,t){gi.debug(`Updating operator '${e}' in OperatorsManager`),this.operators[e]=t}get(e){return gi.debug(`Getting operator '${e}' in OperatorsManager`),this.operators[e]?this.operators[e]:(gi.error(yn.OPERATORS.NOT_REGISTERED,{operatorName:e}),null)}remove(e){gi.debug(`Removing operator '${e}' in OperatorsManager`),this.operators[e]?delete this.operators[e]:gi.warn(Tn.OPERATORS.NO_OPERATOR_TO_REMOVE,{operatorName:e})}removeAll(){gi.debug("Removing all operators in OperatorsManager"),this.operators={}}initialize(e){Object.assign(this.operators,e)}}var rs=new ss;class os extends hn{constructor(e,{globals:t={}}={}){super(),this.pluginName=ki.EVENT,this.vwoEventsInstance=e,this.config={domEventsDebounceTime:t.domEventsDebounceTime},this.events={},this.initialize()}add(...e){var t,i;let n,s,r,o;vi(e[0])?([{eventName:n}]=e,s=e[0].on.bind(e[0]),r=null===(t=e[0].off)||void 0===t?void 0:t.bind(e[0]),o=null===(i=e[0].eventConditionsUpdate)||void 0===i?void 0:i.bind(e[0])):[n,s,r,o]=e,gi.debug(`Adding event listener '${n}' in EventsManager`),this.events[n]?gi.error(yn.EVENTS.ALREADY_EXISTS,{eventName:n}):(this.events[n]={on:s,off:r,eventConditionsUpdate:o},s(e=>this.triggerCustomEvent(n,e),{vwoEvents:this.vwoEventsInstance}))}updateCustomEvents(...e){var t;let i,n,s;vi(e[0])?([{eventName:i}]=e,n=e[0].on.bind(e[0]),s=null===(t=e[0].off)||void 0===t?void 0:t.bind(e[0])):[i,n,s]=e,gi.debug(`Updating event listener '${i}' in EventsManager`),this.events[i]={on:n,off:s},n(e=>this.triggerCustomEvent(i,e),{vwoEvents:this.vwoEventsInstance})}update(e){Object.keys(e).forEach(t=>{this.updateCustomEvents(t,e[t].fn)})}get(e){return gi.debug(`Getting event listener '${e}' definition from EventsManager`),this.events[e]?this.events[e]:(gi.error(yn.EVENTS.NOT_REGISTERED,{eventName:e}),null)}remove(e){var t,i;gi.debug(`Removing event listener '${e}' from EventsManager`),this.events[e]?(null===(i=(t=this.events[e]).off)||void 0===i||i.call(t),delete this.events[e],dn.remove(e)):gi.warn(Tn.EVENTS.NO_EVENT_TO_REMOVE,{eventName:e})}removeAll(){gi.debug("Removing all event listeners from EventsManager"),Object.keys(this.events).forEach(e=>{var t,i;null===(i=(t=this.events[e]).off)||void 0===i||i.call(t)}),dn.removeAll(),this.events={}}addDomEvent(e,t){var i,n,s,r;if(null===(r=null===(s=null===(n=null===(i=window.VWO)||void 0===i?void 0:i.modules)||void 0===n?void 0:n.utils)||void 0===s?void 0:s.libUtils)||void 0===r?void 0:r.isBot2())return;const{preDefinedEvents:o}=this.vwoEventsInstance;!this.events[e]&&wn(e).includes(`${ti.DOM}_`)&&(e===`${ti.DOM}_click`?this.add(new o.ClickDomEvent(t)):e===`${ti.DOM}_hover`?this.add(new o.HoverDomEvent(t)):e===`${ti.DOM}_change`?this.add(new o.ChangeDomEvent(t)):e===`${ti.DOM}_submit`?this.add(new o.SubmitDomEvent(t)):e===`${ti.DOM}_elementViewed`?this.add(new o.ElementViewedDomEvent(t)):this.add(new o.GenericDomEvent(e,t,this.config.domEventsDebounceTime)))}addEvent(e,t){if(e!==si.PAGE_VIEW||this.events[e])this.addDomEvent(e,t);else{const{preDefinedEvents:e}=this.vwoEventsInstance;this.add(new e.PageViewEvent(t))}}updateConditions(e,t){if(this.events[e]||this.addEvent(e,t),this.events[e]&&t&&null!==t[0]){const{eventConditionsUpdate:i}=this.events[e];i&&Array.isArray(t)&&i(t)}}triggerCustomEvent(e,t){dn.trigger(e,t)}initialize(){const{preDefinedEvents:e}=this.vwoEventsInstance;Object.keys(e).forEach(t=>{t.endsWith("DomEvent")||this.add(new e[t])})}}const as={[An.EQUAL]:(e,t)=>String(e).toLowerCase()===String(t).toLowerCase(),[An.NOT_EQUAL]:(e,t)=>!as[An.EQUAL](e,t),[An.EQUAL_CASE_SENSITIVE]:(e,t)=>String(e)===String(t),[An.NOT_EQUAL_CASE_SENSITIVE]:(e,t)=>!as[An.EQUAL_CASE_SENSITIVE](e,t),[An.REGEX](e,t){try{return new RegExp(t,"i").test(String(e))}catch(e){return!1}},[An.URL_REGEX](e,t,i){const n=null==i?void 0:i.jsLibUtils;return n?n.verifyUrl(e,t,null,null==i?void 0:i.pageUrl,{pgConfigId:null==i?void 0:i.pgConfigId}):as[An.REGEX](e,t)},[An.NOT_URL_REGEX]:(e,t,i)=>!as[An.URL_REGEX](e,t,i),[An.REGEX_CASE_SENSITIVE](e,t){try{return new RegExp(t).test(String(e))}catch(e){return!1}},[An.CONTAINS]:(e,t)=>String(e).toLowerCase().includes(String(t).toLowerCase()),[An.NOT_CONTAINS]:(e,t)=>!as[An.CONTAINS](e,t),[An.BLANK]:e=>!e,[An.NOT_BLANK]:e=>!as[An.BLANK](e),[An.GREATER_THAN](e,t){if(!fi(e)||!fi(t))return!1;const i=+e,n=+t;return _i(i)&&_i(n)&&i>n},[An.GREATER_THAN_EQUAL](e,t){if(!fi(e)||!fi(t))return!1;const i=+e,n=+t;return _i(i)&&_i(n)&&i>=n},[An.LESS_THAN](e,t){if(!fi(e)||!fi(t))return!1;const i=+e,n=+t;return _i(i)&&_i(n)&&i<n},[An.LESS_THAN_EQUAL](e,t){if(!fi(e)||!fi(t))return!1;const i=+e,n=+t;return _i(i)&&_i(n)&&i<=n},[An.NOT_IN_LOCATION](e,t){let i=!1;if(!t||0===t.length)return!1;for(let n=0;n<t.length;n++){const s=t[n];if(s===e.countryCode||s===`${e.countryCode}-${e.region}`||s===`${e.countryCode}-${e.region}-${e.city}`){i=!1;break}i=!0}return i},[An.IN_LOCATION](e,t){let i=!1;if(!t||0===t.length)return!1;for(let n=0;n<t.length;n++){const s=t[n];if(s===e.countryCode||s===`${e.countryCode}-${e.region}`||s===`${e.countryCode}-${e.region}-${e.city}`){i=!0;break}}return i},[An.IN]:(e,t)=>t.map(e=>String(e).toLowerCase()).includes(String(e).toLowerCase()),[An.NOT_IN]:(e,t)=>!as[An.IN](e,t),[An.RANGE_COMPARISON](e,t){try{let i=JSON.parse;try{i=window.VWO._.native.JSON.parse||JSON.parse}catch(e){}const n=i(e),s=t.split("'")[1].split("-"),r=s[0],o=s[1];return as[An.GREATER_THAN_EQUAL](n[0],parseInt(r,10))&&as[An.LESS_THAN_EQUAL](n[0],parseInt(o,10))}catch(e){return gi.info(`RANGE OPERATOR ERROR: ${e&&e.stack}`),!1}},[An.PAGE_CONFIG_EVALUATION]:(e,t,i)=>zi.validatePage(t,!1,e,i).didMatch};var ds=Object.assign(as,{sel:()=>!1,[An.EXEC](e,t,i={triggerName:""}){if(!e)return!1;let n;n=t&&"object"==typeof t?t.triggerName:i.triggerName;for(let i=0;i<e.length;i++){const s=e[i];if(!s)break;window.VWO._.pageNo=window.VWO._.pageNo||0;const{pageNo:r}=window.VWO._,o=()=>{r===window.VWO._.pageNo&&dn.trigger(Un.getTriggerEventName(n))};try{s(o,window.vwo_$,"string"==typeof t?{sel:t,triggerName:n}:void 0)}catch(e){gi.warn(`Issue with custom trigger ${null==s?void 0:s.toString()}`)}}return!1}});rs.initialize(ds);const ls={};class cs extends hn{constructor(){super(),this.pluginName=ki.EVENT_PROPS,this.eventsProps={},this.initialize()}add(e,t,i){gi.debug(`Adding computed prop '${t}' of event '${e}'.`),this.eventsProps[e]=this.eventsProps[e]||{},this.eventsProps[e][t]?gi.error(yn.EVENT_PROP.ALREADY_EXISTS,{propName:t,eventName:e}):this.eventsProps[e][t]=i}update(e,t,i){gi.debug(`Updating computed prop '${t}' of event '${e}'.`),this.eventsProps[e]=this.eventsProps[e]||{},this.eventsProps[e][t]=i}get(e,t){var i;return gi.debug(`Getting '${t||"all"}' computed prop of event '${e}'.`),t?(null===(i=this.eventsProps[e])||void 0===i?void 0:i[t])?this.eventsProps[e][t]:(gi.error(yn.EVENT_PROP.NOT_REGISTERED,{eventName:e,propName:t}),null):this.eventsProps[e]||{}}remove(e,t){var i;gi.debug(`Removing '${t||"all"}' computed prop of event '${e}'.`),t?(null===(i=this.eventsProps[e])||void 0===i?void 0:i[t])?delete this.eventsProps[e][t]:gi.warn(Tn.EVENT_PROP.NO_EVENT_PROP_TO_REMOVE,{eventName:e,propName:t}):this.eventsProps[e]={}}removeAll(){gi.debug("Removing all computed props of all events"),this.eventsProps={}}initialize(){Object.keys(ls).forEach(e=>{Object.keys(ls[e]).forEach(t=>{this.add(e,t,ls[e][t])})})}}class us extends bn{async fn(e,...t){const i=await Promise.all(t.map(t=>t(e)));let n=0;for(let e=i.length-1;e>=0;--e){const t=i[e];if(!t[0])return[!1,0];n=t[1]>n?t[1]:n}return[!0,n]}toJSON(){return"a"}}class gs extends bn{async fn(e,...t){const i=await Promise.all(t.map(t=>t(e)));let n=1/0,s=!1;for(let e=i.length-1;e>=0;--e){const t=i[e];t[0]&&(s=!0,n=t[1]<n?t[1]:n)}return[s,s?n:0]}toJSON(){return"o"}}class hs extends bn{constructor({data:e},{trigger:t,triggerName:i}){super(),[this.op]=e;const n=e[1];this.threshold="INF"===n?1/0:1e3*n,this.validateFromStateAndDispatchTriggerEvent=()=>Un.validateAndDispatchTriggerEvent(i,t,{},"",null,null,!0),this.isTimeoutCompleted=!1}lt(e,t){if(e[0]&&t[0]){this.previousLHS=e[1];const i=t[1]-e[1];if(i>=0&&i<=this.threshold)return[!0,t[1]]}return[!1,0]}gtn(e,t){if(!e[0])return[!1,0];if(this.isTimeoutCompleted)return[!0,e[1]+this.threshold];if(this.threshold===1/0)return[!1,0];if(t[1]>e[1])return this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.lt(e,t)[0]?[!1,0]:[!0,e[1]+this.threshold];if(!this.timeout||this.previousLHS!==e[1]){this.previousLHS=e[1],this.isTimeoutCompleted=!1;const t=e[1]+this.threshold-Date.now();this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.isTimeoutCompleted=!0,this.validateFromStateAndDispatchTriggerEvent()},t>0?t:0)}return[!1,0]}async fn(e,t,i){const n=await t({doNotUseCache:e.doNotUseCache||!this._persistedState}),s=i?await i({doNotUseCache:e.doNotUseCache||!this._persistedState}):[!1,0];if(n[0]&&!n[1])return[!0,0];if(!e.doNotUseCache&&this._persistedState)return this._persistedState;const r=this[this.op](n,s);return r[0]&&(this._persistedState=r),r}get persistedData(){var e;return null!==(e=JSON.stringify(this._persistedState))&&void 0!==e?e:""}toJSON(){return{op:"ts",data:[this.op,this.threshold/1e3]}}clearData(){clearTimeout(this.timeout),this.timeout=void 0,this.isTimeoutCompleted=!1,this._persistedState=null}}var vs=Object.freeze({__proto__:null,A:us,O:gs,TS:hs});class ps extends hn{constructor(){super(),this.pluginName=ki.CONDITION_LEVEL_OPERATOR,this.operators={},this.initialize()}add(e,t){gi.debug(`Adding Condition Level operator '${e}' in CLOperatorsManager`),this.operators[e]?gi.error(yn.OPERATORS.ALREADY_EXISTS,{operatorName:e}):this.operators[e]={definition:t,instances:[]}}update(e,t){gi.debug(`Updating operator '${e}' in CLOperatorsManager`),this.operators[e].definition=t}get(e,t,{trigger:i,triggerName:n}){gi.debug(`Getting operator '${e}' in CLOperatorsManager`);const s=this.operators[e.toUpperCase()];if(!s)return gi.error(yn.OPERATORS.NOT_REGISTERED,{operatorName:e}),null;const r=new s.definition(t,{trigger:i,triggerName:n});return s.instances.push(r),r}remove(e){gi.debug(`Removing operator '${e}' in CLOperatorsManager`),this.operators[e]?delete this.operators[e]:gi.warn(Tn.OPERATORS.NO_OPERATOR_TO_REMOVE,{operatorName:e})}removeAll(){gi.debug("Removing all operators in CLOperatorsManager"),this.operators={}}initialize(){Object.keys(vs).forEach(e=>{this.add(e,vs[e])})}clearData(){Object.keys(this.operators).forEach(e=>{this.operators[e].instances.forEach(e=>{e.clearData()})})}}class ws{execute(e,t){this.initializeStore(t.dataStore,t.storages,t.props),this.initializeOperators(t.operators),this.initializeFormulas(),this.initializeTags(t.tags),this.initializeEventsProps(t.eventsProps),this.initializeEvents(e,t.events,t.globals),this.initializeTriggers(t.triggers),this.initializePages(t.pages,t.pagesEval),this.initializeRules(e,t.rules)}clear(){Mi.unregisterAll(),Un.removeAll(),Kn.removeAll(),dn.removeAll(),Qi.clearAll()}initializeOperators(e){gi.debug("Initializing Operators");const t=Mi.plugins[ki.OPERATOR]||rs;Object.keys(e).forEach(i=>{t.update(i,e[i])}),Mi.register(t)}initializeFormulas(){gi.debug("Initializing Formulas"),Mi.register(Mi.plugins[ki.FORMULA]||new Cn)}initializeStore(e,t,i){gi.debug("Initializing Store");const n=Mi.plugins[ki.STORAGE]||new ns;Object.keys(t).forEach(e=>{n.update(e,t[e]),en.setStoragePlugin(n.get(e))}),Qi.addValues(e,Ri.SETTINGS),Qi.set("storages",n,Ri.ROOT),qn.initialize(i),Mi.register(n)}initializeEventsProps(e){gi.debug("Initializing Events computed props");const t=Mi.plugins[ki.EVENT_PROPS]||new cs;Object.keys(e).forEach(i=>{Object.keys(e[i]).forEach(n=>{t.update(i,n,e[i][n])})}),Mi.register(t)}initializeEvents(e,t,i){gi.debug("Initializing Events");const n=Mi.plugins[ki.EVENT]||new os(e,{globals:i});n.update(t),Mi.register(n)}initializeTriggers(e){gi.debug("Initializing Triggers"),Un.initialize(e)}initializePages(e,t){gi.debug("Initializing Pages"),zi.add(e,t)}initializeTags(e){gi.debug("Initializing Tags");const t=Mi.plugins[ki.TAG]||new Fn;Object.keys(e).forEach(i=>{const n=e[i];t.update(i,n.fn,{occurrence:n.occurrence,scope:n.scope,sync:n.sync,fireUniquelyForEveryEvent:n.fireUniquelyForEveryEvent})}),Mi.register(t)}initializeRules(e,t){gi.debug("Initializing Rules",t),Kn.initialize(e,t)}initializeCLOperators(){gi.debug("Initializing CL_Operators");const e=Mi.plugins[ki.CONDITION_LEVEL_OPERATOR]||new ps;Mi.register(e)}}var Es=new ws,fs,_s;!function(e){e.OR="OR"}(fs||(fs={})),function(e){e.ALL="*"}(_s||(_s={}));class ms{static or(...e){return e._validationType=fs.OR,e}static validateJSON(e,t,i="settings"){try{if(e){const n=e._validationType===fs.OR&&pi(e)?e:[e],s=e._validationType===fs.OR&&pi(e)?e.find(e=>Ai(e)===Ai(t)):e;if(!ms.isSchemaMatching(n,t))return ms.logger.info(`Settings schema validation failed for '${i}'.`,{expectedSchema:ms.getStringifiedSchemaValues(e),actualValue:t}),ms.getNewInitializedValue(e);if(vi(s))Object.keys(t).forEach(e=>{t[e]=ms.validateJSON(s[e]||s[_s.ALL],t[e],`${i}.${e}`)});else if(pi(s))return t.map((e,t)=>ms.validateJSON(s[0]===ms.RECURSION?n:s[0],e,`${i}.${t}`))}return t}catch(e){return ms.logger.error("Got exception while validating settings schema",{err:e}),t}}static isSchemaMatching(e,t){return e.some(e=>Ai(t)===Ai(e)||Ai(t)===(null==e?void 0:e.name))}static getNewInitializedValue(e){if(Ti(e))return new e;let t=e;return e._validationType===fs.OR&&pi(e)&&(t=e.find(e=>ms.isArraySchema(e)||ms.isObjectSchema(e))||e[0]),ms.isObjectSchema(t)?{}:ms.isArraySchema(t)?[]:void 0}static isArraySchema(e){return"Array"===e.name||pi(e)}static isObjectSchema(e){return"Object"===e.name||vi(e)}static getStringifiedSchemaValues(e){return Ti(e)?e.name:pi(e)?e.map(e=>ms.getStringifiedSchemaValues(e)):vi(e)?Object.keys(e).reduce((t,i)=>Object.assign(Object.assign({},t),{[i]:ms.getStringifiedSchemaValues(e[i])}),{}):e}}ms.logger=new di("warn"),ms.RECURSION="r";class Os{constructor(e,...t){var i;this.vwoEventsInstance=e,this.currentSettings={},this.baseSettings={globals:{},dataStore:{},props:{},operators:{},eventsProps:{},events:{},triggers:{},pages:{ec:[],pc:[]},pagesEval:{ec:[],pc:[]},tags:{},rules:{},storages:{},jsLibUtils:{}},this.replace(...t),Fi.set("jsLibUtils",null===(i=this.currentSettings)||void 0===i?void 0:i.jsLibUtils)}add(...e){Es.initializeCLOperators();const t=this.preProcessSettings(e);return this.currentSettings.pagesEval={},this.currentSettings=bi.mergeNestedObjects(this.currentSettings,...t),this.initialize(),this.currentSettings}replace(...e){return this.resetSettings(),this.add(...e)}remove(){this.resetSettings(),Es.clear()}initialize(){Es.execute(this.vwoEventsInstance,this.currentSettings)}resetSettings(){this.currentSettings=Object.assign({},this.baseSettings)}preProcessSettings(e){let t=this.preProcessRules(e);for(let e=this.preProcessSettings.length-1;e>=0;--e){const i=t[e];if(i.triggers){const e={};Object.keys(i.triggers).forEach(t=>{e[t]=this.preProcessTriggers(t,i.triggers[t])}),i.triggers=e}}return t=this.preProcessCampaigns(t),this.getValidatedSettings(t)}getValidatedSettings(e){const t={id:ms.or(String,Number),type:String,filters:[ms.or(String,Array)],args:Array,fn:Function},i=[{dataStore:Object,props:Object,operators:{"*":Function},eventsProps:{"*":{"*":Function}},events:{"*":{fn:Function}},triggers:{"*":{cnds:[ms.or(String,Boolean,null,Array,[ms.RECURSION],{id:ms.or(String,Number),event:String,filters:[ms.or(String,Array)],formula:[t],op:String,data:[ms.or(String,Number)]})],formula:[t]}},tags:{"*":{fn:ms.or(Function,Object.getPrototypeOf(async function(){}).constructor),occurrence:Number,scope:String}},rules:{"*":{triggers:ms.or(String,[String]),tags:[{id:String,priority:Number,exitCondition:[ms.or(String,Array)],shouldConsiderParentExitCondition:Boolean}],exitCondition:[ms.or(String,Array)],shouldConsiderParentExitCondition:Boolean}},storages:{"*":Object}}];return ms.validateJSON(i,e)}preProcessRules(e){const t={},i=this;return Object.keys(this.currentSettings.rules).forEach(e=>{const n=this.currentSettings.rules[e],s=[];n.tags.forEach(e=>{s.push(JSON.stringify(i.sortTag(e)))}),t[n.triggers[0]]=s}),e.map(e=>{let{rules:n}=e;if(n=n||[],pi(n)){const e={};n.forEach(n=>{let s=!1;const r=[],o=Kn.generateRandomRuleId(),a={triggers:n.triggers,tags:[]};n.tags.forEach(e=>{const o=n.triggers[0],a=JSON.stringify(i.sortTag(e));t[o]=t[o]||[],t[o].includes(a)||(s=!0,t[o].push(a),r.push(e))}),s&&(a.tags=r,e[o]=a)}),n=e}return Object.assign(Object.assign({},e),{rules:n})})}sortTag(e){return Object.keys(e).sort().reduce((t,i)=>(t[i]=e[i],t),{})}preProcessCampaigns(e){return e.map(e=>{if(vi(e.triggers)&&fi(e.triggers)&&vi(e.dataStore)&&fi(e.dataStore)){const{triggers:t}=e,{campaigns:i}=e.dataStore;Object.keys(i).forEach(e=>{const n=i[e].triggers[0];vi(t[n])&&fi(t[n])&&(t[n].occurrence=1)})}return e})}preProcessTriggers(e,t){var i;if(t&&t.cnds&&t.cnds.length>=0){const n=(i,s,r)=>{if(pi(i))i.forEach(n);else if(i){if(mi(i)||fi(i.op)){const n=mi(i)?i:i.op;r[s]=Mi.plugins[ki.CONDITION_LEVEL_OPERATOR].get(n,i,{trigger:t,triggerName:e})}fi(i.persistState)||"vwo_postInit"===i.event&&(i.persistState=!0)}};null===(i=t.cnds)||void 0===i||i.forEach(n)}return t}}class Ss{static getTriggersConditionInfo(e,t){const i=t=>pi(t)?t.map(i):Pn(t)?Object.assign(Object.assign({},t),{hasEventFired:xn.hasEventOccurred(e,t.event),arePartialConditionsMet:xn.hasConditionMetBefore(e,t.id)}):Rn(t)?`${JSON.stringify(t)} -> ${t.persistedState}`:"string"==typeof t?t:JSON.stringify(t);return t.map(i)}static tag(e,t){var i;const n=jn.generateTagId(t),s=Ji.tags[n],r=null===(i=Mi.plugins[ki.TAG])||void 0===i?void 0:i.get(t),o=Object.values(e.currentSettings.rules).filter(e=>e.tags.some(e=>e.id===t)).reduce((e,t)=>{const i=pi(t.triggers)?t.triggers:[t.triggers];return e.push(...i),e},[]).reduce((t,i)=>{const n=Ji.triggers[i];return Object.assign(Object.assign({},t),{[i]:{areConditionsMet:n.state,cndsState:this.getTriggersConditionInfo(i,e.currentSettings.triggers[i].cnds)}})},{});return{hasExecuted:s.hasExecuted||!1,executionCount:s.executionCount||0,fn:r.fn,occurrence:r.occurrence||null,scope:r.scope||null,stoppedByExitCondition:s.stoppedByExitCondition,lastExitConditions:s.lastExitConditions,dependentTriggers:o}}static trigger(e,t){return{areConditionsMet:Ji.triggers[t].state,cndsState:this.getTriggersConditionInfo(t,e.currentSettings.triggers[t].cnds)}}static page(e,t,i){const n=zi.validatePage(e,t,i,{debug:!0});let s=t?"pageConfig":"experimentConfig";if(n){switch(n.reason){case ji.EXCLUDE_PASSED:s=`Url matches the excludes of ${s}`;break;case ji.INCLUDE_FAILED:s=`Url does not match the includes of ${s}`;break;case ji.INCLUDE_PASSED:s=`Url matches the includes of ${s}`}return delete n.reason,Object.assign(Object.assign({},n),{brief:s})}}}var ys="1.1.22";const Ts=function(){};class Cs{constructor(e,t){this.toJSON=()=>{const e=Object.assign({},this);return delete e.preDefinedEvents,e},this.store={state:Ui,getters:Ji,actions:Qi},this.eventBus=dn,this.preDefinedEvents=null==t?void 0:t.preDefinedEvents,this.debug={tag:e=>Ss.tag(this.settings,e),trigger:e=>Ss.trigger(this.settings,e),page:(e,t,i)=>Ss.page(e,t,i)},this.rules=Kn,this.triggers=Un,this.pageGroup=zi,Object.assign(this,this.getEventMethods()),Yn.init(),this.activate(e)}get version(){return ys}add(...e){this.settings.add(...e),dn.trigger(ii.POST_INIT)}replace(...e){this.settings.replace(...e),dn.trigger(ii.POST_INIT)}on(e,t,{before:i,after:n}={}){if(mi(e))return dn.on(e,t,{before:i,after:n});const s=Date.now()*Math.floor(1e3*Math.random()),r=s.toString();this.tags.add(s,t),this.rules.add({triggers:[r],tags:[{id:r}]},this.rules.generateRandomRuleId());const o=this.settings.preProcessTriggers(r,e);return this.settings.currentSettings.triggers[r]=o,Un.add(r,o),s}async validateTrigger(e,t={},i,n){return gi.info("Validating Trigger conditions through API",{trigger:e,event:t}),(await xn.validateTrigger(e,t,i,n)).isValid}validateTriggerFromHistory(e,t){return Un.validateTriggerFromHistory(e,t)}validateAndDispatchTriggerEvent(e,t,i,n,s,r,o=!1){return Un.validateAndDispatchTriggerEvent(e,t,on(i),n,s,r,o)}destroy(){this.settings.remove()}async isValid(e,t,i){await xn.isValid(e,t,on({isCustomEvent:!0,fromLocalStorage:!0}),i)}activate(e){gi.info("Activating Phoenix!"),this.settings=new Os(this,...e),this.initializeValues(),dn.trigger(ii.POST_INIT)}getEventMethods(){return{on:this.on,off:dn.off.bind(dn),removeEvent:dn.remove.bind(dn),async trigger(e,t={},i,n=[]){try{Object.defineProperty(t,ri.EXIT_CONDITIONS,{value:this[ri.EXIT_CONDITIONS],enumerable:!1,writable:!0});try{await dn.trigger(e,t),n.length>0&&await Promise.all(n.map(i=>{try{const n=window.VWO._.allSettings.triggers||{};return n[i]||(n[i]={},pn({msg:"Trigger not found in trigger store",url:"Trigger.ts",lineno:266,colno:5,source:JSON.stringify({eName:e,triggerId:i})})),this.triggers.dispatchTriggerEvent(i,n[i],t)}catch(e){return pn({msg:e.message||"Error while firing DSL 3 trigger events",url:"Trigger.ts",lineno:266,colno:5,source:JSON.stringify({event:t,errMsg:e.message,errStk:e.stack})}),Promise.resolve()}}));const i=vn(()=>jn.getVwoInstanceObject()[e]);e&&i&&(jn.flushTagData(e),await jn.executeTagUniquelyForEveryEvent(i))}catch(e){}(Ti(i)||Ci(i))&&await i(t)}catch(e){window.VWO._.customError&&window.VWO._.customError({msg:e.stack||e.message||"Something wrong",url:"Trigger.ts",lineno:252,colno:5,source:JSON.stringify({event:t,opt_url:window._vis_opt_url,errMsg:e.message,errStk:e.stack})})}},getEvent:dn.event.bind(dn)}}initializeValues(){this.operators=Mi.plugins[ki.OPERATOR],this.formulas=Mi.plugins[ki.FORMULA],this.events=Mi.plugins[ki.EVENT],this.storages=Mi.plugins[ki.STORAGE],this.tags=Mi.plugins[ki.TAG],this.eventsProps=Mi.plugins[ki.EVENT_PROPS]}deactivate(){this.trigger=Ts,this.add=Ts}clearData(){Mi.clearData()}}Cs.version=ys;class Is{constructor(){this.storageLookUpKey="_vwo_store_content"}sendDebugLogForSyncList(e,t,i={listVal:null}){try{const n=e.fns.list,s=Object.keys(n),r=[],o=[];for(const e of s){const t=n[e],[i,s]=JSON.parse(e);1===t.val?r.push(s):o.push(s)}t(Object.assign(Object.assign({},i),{listMatched:r.length>0?r:void 0,listUnmatched:o.length>0?o:void 0}))}catch(e){}}otherSide(...e){return e[0]="VWO.modules.vwoUtils.contentSync."+e[0],e[2]&&(e[2]={captureGroups:e[2]}),window.fetcher.getValue(...e)}}const Ns=function(...e){window.fetcher.getValue("VWO._.triggerEvent",e)};class As{}function Vs(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t}function bs(e,t){window.fetcher.getValue("VWO.modules.vwoUtils.urlUtils.customEvent",[e,t])}var Rs=parseInt(+new Date/1e3,10),Ps,Ds=function(){return Ps||(Ps=window.VWO.data.ts||Rs)};const xs=Object.keys;function Ls(e,t){if(!(e instanceof Array))return-1;for(var i=0;i<e.length;i++)if(t===e[i])return i;return-1}function Us(e){var t=Ds(),i=parseInt(+new Date/1e3,10)-Rs;return e?t+i:1e3*(t+i)+ +new Date%1e3}function Ws(e,t,i){var n,s,r,o=!1;return-1===t||i?(s=requestAnimationFrame,r=cancelAnimationFrame):(s=setTimeout,r=clearTimeout),function(...i){o&&(r(n),n=null),n=s(function(){e.apply(this,i)},t),o=!0}}function Ms(e,t){return e.length>t?e.slice(0,t-1)+"...":e}function ks(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}function Gs(){}try{Gs.prototype=Object.create(Array.prototype),Object.defineProperty(Gs.prototype,"clear",{value:void 0,writable:!0,enumerable:!1})}catch(e){}function Fs(e,t,i){if(void 0!==i){const n=e.includes("?")?"&":"?";e+=`${n}${t}=${encodeURIComponent(i)}`}return e}const Hs=({url:e,method:t="POST",cacheBurst:n=!1,body:s,includeCredentials:r=!0,useBeacon:o=!1},{onSuccessCallback:a=()=>null,onErrorCallback:d=()=>null}={})=>i(void 0,void 0,void 0,function*(){n&&(e=Fs(Fs(e,"eTime",Us()),"v",window.VWO.v_e));try{if(o&&navigator&&"sendBeacon"in navigator&&"function"==typeof navigator.sendBeacon)return navigator.sendBeacon(e,JSON.stringify(s)),void a({});const i=yield fetch(e,Object.assign(Object.assign({method:t},ks(s)?{body:JSON.stringify(s)}:{}),{credentials:r?"include":"omit"}));if(i.ok)return a(i),i;throw new Error(i.statusText)}catch(e){throw d(e),e}});window.VWO._.networkClient={request:Hs};const js=window.VWO._.networkClient,$s=window.VWO.TRACK_SESSION_COOKIE_EXPIRY_CUSTOM||1/48,Bs="_vis_opt_",Ks="_vwo_",zs={TRACK_GLOBAL_COOKIE_NAME:"_vwo_ds",TRACK_SESSION_COOKIE_NAME:"_vwo_sn",TRACK_SESSION_COOKIE_EXPIRY:$s,SESSION_TIMER_EXPIRE:60*$s*60*1e3*24,COOKIE_VERSION:3,COOKIE_TS_INDEX:1,COOKIE_VERSION_INDEX:0,FIRST_SESSION_ID_INDEX:0,PC_TRAFFIC_INDEX:1,CURRENT_SESSION_ID:6,LAST_SESSION_ID:7,SESSION_COUNT_INDEX:8,RELATIVE_SESSION_ID_INDEX:0,PAGE_ID_INFORMATION_INDEX:1,SESSION_SYNCED_STATE_INDEX:4,TOTAL_TIME_SPENT_IN_A_SESSION_INDEX:6,PAGE_ID_EXPIRY:15,GLOBAL_OPT_OUT:"_vwo_global_opt_out",OPT_OUT:"_vis_opt_out",TEST_COOKIE:"_vis_opt_test_cookie",COOKIE_JAR:"_vwo",SAME_SITE:"_vwo_ssm",UUID:"uuid",UUID_V2:"uuid_v2",VWO_COOKIE_QUERY_PARAM:"vwo_q",DEFAULT_EXPIRY:100,UUID_COOKIE_EXPIRY:365.2425};function Ys(){return Math.min(window.VWO.TRACK_GLOBAL_COOKIE_EXPIRY_CUSTOM||window.VWO.data.rp||90,90)}function Js(){return{[Bs+"test_cookie"]:0,[Ks+"ds"]:Ys(),[Ks+"sn"]:$s,[Ks+"referrer"]:18e-5,[Ks+"uuid"]:3650,[Ks+"uuid_v2"]:366,[zs.SAME_SITE]:3650}}function Xs(e,t,i={leading:!1,trailing:!0}){const{leading:n,trailing:s}=i;let r=null,o=[],a=!1;return function(...i){if(o=i,r&&clearTimeout(r),n&&!a)return a=!0,e.apply(this,i);s&&(r=setTimeout(()=>{e.apply(this,o),a=!1},t))}}function qs(e,t){window.fetcher.getValue('VWO.modules.utils.helperFunctions.onUrlChange("${{1}}", "${{2}}")',null,{captureGroups:[e,t]})}const Qs=Xs,Zs="lT",er="sT",tr="ivp",ir="gp",nr="ca",sr=10,rr=2,or=function(){},ar="w",dr=[739074,714884,708439,765649],lr={VS_DATA:"vwoVsData",THIRD_PARTY_UUIDS:"_vwo_cD",ABM_META:"vwoAbmMeta"},cr={SPLIT_REDIRECT:"_vwo_split_redirect"},ur="_cd",gr=2e3,hr="vwoStandardTrigger",vr={get campaignCookies(){return new RegExp("_vis_opt_exp_(\\d+)_(.+)")},get uuidCookie(){return new RegExp("_vwo_uuid_(\\d+)")},get insightsCookies(){return new RegExp(`_vwo_(ds|sn|uuid${ur})`)}},pr="mutElg",wr=":";var Er={PARSE_TLD:"pTLD"},fr=["co","org","com","net","edu","au","ac"];function _r(e){var t,i=e.split("."),n=i.length,s=i[n-2];return s&&fr.includes(s)?(t=i[n-3]+"."+s+"."+i[n-1],Ns(Er.PARSE_TLD,e,t),t):(t=s+"."+i[n-1],Ns(Er.PARSE_TLD,e,t),t)}const mr="_vwo_referrer",Or=.00139;let Sr;const yr={updateReferrer(e){Sr=e},init(){0},get:()=>-1!==location.search.search("_vwo_test_ref")?document.referrer:Sr,set(){Sr&&jr.createThirdParty(mr,Sr,Or,void 0,void 0,!0,void 0)}};window.VWO.modules.vwoUtils.referrer=yr;const Tr={get navigator(){return navigator},get pageTitle(){return document.title},get doNotTrack(){return window.doNotTrack},get windowName(){return window.name},get currentUrl(){return window._vis_opt_url||window.location.href},get location(){return window.location},get document(){return window.location},get history(){return window.history},get accountId(){return window._vwo_acc_id},get smartCodeVersion(){return window._vwo_code_version},get serverUrl(){return window._vwo_server_url||"https://dev.visualwebsiteoptimizer.com/"},get vwoText(){return window._vwo_text},get vwoCode(){return window._vwo_code},get MutationObserver(){let e=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;return window.Zone&&window.Zone.__symbol__&&(e=window[window.Zone.__symbol__("MutationObserver")]),e},get vwoInternalProperties(){return window.VWO._},get cookie(){return document.cookie},get visDebug(){return window._vis_debug},get cookieDomain(){return window._vis_opt_domain||window._vwo_cookieDomain||_r(window.location.host||new URL(document.URL).host)},get cookiePath(){return window._vis_opt_cookiePath||"/"},get vwoStyle(){return window._vwo_style},get screen(){return window.screen},get vwoCss(){return window._vwo_css},get visOptUrl(){return window._vis_opt_url},get allSettings(){return window.VWO._.allSettings},get apiSectionCallback(){return window._vwo_api_section_callback},get encodeURIComponent(){return window.encodeURIComponent},get page(){return{title:Tr.pageTitle,url:Tr.currentUrl,referrerUrl:yr.get()}},get timeSpentInASession(){var e,t,i,n,s,r;return Math.floor(+Date.now()-1e3*+(null===(i=null===(t=null===(e=window.VWO.phoenix)||void 0===e?void 0:e.store)||void 0===t?void 0:t.getters)||void 0===i?void 0:i.sessionStart)?(+Date.now()-1e3*+(null===(r=null===(s=null===(n=window.VWO.phoenix)||void 0===n?void 0:n.store)||void 0===s?void 0:s.getters)||void 0===r?void 0:r.sessionStart))/1e3:0)},get vwoUUID(){return window._vwo_uuid},get daySinceLastVisit(){return window.fetcher.getValue("window._vwoSeg.dSLV")},get daySinceFirstSession(){return window.fetcher.getValue("window._vwoSeg.dSFS")},get sessionCount(){return window.fetcher.getValue("window._vwoSeg.sessionCount")},get hour(){return window.fetcher.getValue("window._vwoSeg.Hr")},get day(){return window.fetcher.getValue("window._vwoSeg.DoW")},get minute(){return window.fetcher.getValue("window._vwoSeg.Min")},get acc_day(){return window.fetcher.getValue("window._vwoSeg.accDoW")},get acc_hour(){return window.fetcher.getValue("window._vwoSeg.accHr")},get acc_minute(){return window.fetcher.getValue("window._vwoSeg.accMin")},get lang(){return window.fetcher.getValue("window._vwoSeg.bl")},get sameDayVisit(){return window.fetcher.getValue("window._vwoSeg.sDV")},get temp(){return window.fetcher.getValue("window._vwoSeg.temp")},get weather(){return window.fetcher.getValue("window._vwoSeg.Wthr")},get adEx(){return window.fetcher.getValue("window._vwoSeg.adEx")}};window.VWO.modules.dataStorePlugin=Tr;const Cr=()=>window.VWO,Ir=()=>Cr()._,Nr=()=>Ir().allSettings,Ar=()=>Nr().dataStore,Vr=()=>R(()=>Ar().plugins,{sendErrorLog:!1},{}),br=()=>R(()=>Ar().campaigns,{sendErrorLog:!0},{}),Rr=()=>R(()=>Nr().triggers,{sendErrorLog:!0},{}),Pr=e=>`_vis_opt_exp_${e}_split`,Dr=()=>!!R(()=>Vr().cDD,{sendErrorLog:!1},!1),xr=R(()=>Vr().UA.br,{sendErrorLog:!1},""),Lr="safari"===xr.toLowerCase();var Ur,Wr=window._vwo_acc_id,Mr=[],kr,Gr=!1,Fr=function(){for(var e=0;e<Mr.length;e++)Mr[e].d||(Mr[e].c(),Mr[e].d=!0)};function Hr(){return window._vis_debug}const jr={domain:void 0,_create:function(e,t,i,n,s,r,o,a){var d,l;Hr()&&0!==e.indexOf("debug")&&(e="debug"+e);const c=i>0;let u=window._vis_opt_cookieDays;window.VWO._.cLFE&&(r=!1),"_vwo_sn"!==e&&"_vwo_ds"!==e&&"_vis_opt_test_cookie"!==e&&!isNaN(u=parseFloat(u))&&isFinite(u)&&c&&(i=u);var g="";if(s?g+="; expires="+new Date(s).toGMTString():i?g+="; expires="+new Date((new Date).getTime()+864e5*i).toGMTString():!1===i&&(g="; expires=Thu, 01 Jan 1970 00:00:01 GMT"),n||(n=jr.domain),void 0!==n){n=(null===(l=null===(d=window.VWO._.allSettings.dataStore.plugins.DACDNCONFIG)||void 0===d?void 0:d.jsConfig)||void 0===l?void 0:l.dNISD)&&!window._vis_opt_domain?"":"; domain=."+n}const h=V(e+"="+(a&&a.ignoreUrlEncoding?t:encodeURIComponent(t))+g+(n||"")+"; path="+Tr.cookiePath);window.VWO._.ss&&!o?(document.cookie=h+"; secure; samesite=none; Partitioned;",6===window._vwo_acc_id&&e.indexOf("_vwo_ds")>-1&&!Gr&&(this.create(e,"",!1,n,1,r,!0),Gr=!0)):document.cookie=h},create:function(e,t,i,n,s,r,o,a){this._create(e,t,i,n,s,r,o,a),Ns(O.SET_COOKIE,e,t,i,s),bs("meta",{ckName:e,ckValue:t,ckDays:i,ckExpiryTs:s})},createWithCrossDomainCheck:function({name:e,value:t,days:i,domain:n,expiryTs:s,ignoreJar:r,ignoreSameSite:o}){R(()=>window.VWO.modules.utils.libUtils.shouldUseCrossDomainForInsights())?this.createThirdParty(e,t,i,n,void 0,!0,void 0,void 0,!0):this.create(e,t,i,n,s,r,o)},get:function(e,t,i,n){var s;e=e.trim(),!i&&Hr()&&(e="debug"+e),window.VWO._.cLFE,e=V(e);var r=document.cookie.match(new RegExp("(?:^|;)\\s*"+e.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")+"=(.*?)(?:;|$)","i"));return s=r&&decodeURIComponent(r[1]),Ns(O.GET_COOKIE,e,s),s},erase:function(e,t,i){this.create(e,"",!1,t,1,i),Ns(O.ERASE_COOKIE,e)},createThirdParty:function(e,t,i,n,s,r,o,a,d){if(!window.mainThread)return window.fetcher.getValue("VWO._.cookies.createThirdParty",[e,t,i,n,s,r,o,a,d]);let l=!1;s&&(l=o?o.multiple_domains:window._vwo_exp[s].multiple_domains),l||(l=d),"_vwo"!==e&&this._create(e,t,i,n),Hr()&&0!==e.indexOf("debug")&&(e="debug"+e),s&&l||r||"_vwo"===e?(vr.insightsCookies.test(e)?jr.debouncedTPCSync(Wr,e,t,i):jr.setThirdPartyCookie(Wr,e,t,i),Ns(O.SET_COOKIE,e,t,i,s,!0)):Ns(O.SET_THIRD_PARTY_COOKIE_ERROR,e,t,i,n)},setThirdPartyCookie:function(e,t,i,n){if(Dr())return;const s=window._vwo_server_url||"https://dev.visualwebsiteoptimizer.com";js.request({url:s+"ping_tpc.php?account="+e+"&name="+encodeURIComponent(t)+"&value="+encodeURIComponent(i)+"&days="+n+"&random="+Math.random(),method:"GET",cacheBurst:!0,useBeacon:!0},{onSuccessCallback:Fr,onErrorCallback:e=>{r({msg:"Error setting third party cookie",url:"cookies.ts"})}})},debouncedTPCSync:function(e,t,i,n){jr.debouncedTPCSyncFunction&&jr.debouncedTPCSyncFunction[t]||(jr.debouncedTPCSyncFunction=jr.debouncedTPCSyncFunction||{},jr.debouncedTPCSyncFunction[t]=Qs(jr.setThirdPartyCookie,gr,{leading:!0,trailing:!0})),jr.debouncedTPCSyncFunction[t](e,t,i,n)},waitForThirdPartySync:function(e){return i(this,void 0,void 0,function*(){window.mainThread?Mr.push({c:e}):yield window.fetcher.getValue('VWO._.cookies.waitForThirdPartySync("${{1}}")',null,{captureGroups:[e]})})},getAll:function(e=!1){if(e&&window.VWO._.isCookieFallbackEnabled)return window.fetcher.getValue("window.VWO._.cookies.getAll");const t=document.cookie.split(/; ?/),i={};for(let e=0;e<t.length;e++){const n=t[e].split("="),s=n[0],r=n[1];try{i[s]=r}catch(e){}}return i},getItem:function(e,t=!1){return t&&window.VWO._.isCookieFallbackEnabled?window.fetcher.getValue("window.VWO._.cookies.getItem",[e]):e.indexOf("_vis_opt_")>-1||e.indexOf("_vwo_")>-1?this.get(e)||this.get(e,!0):this.get(e,!0,!0,!0)},setItem:function(e,t){this.create(e,t)},includes:function(e,t=!1){if(t&&window.VWO._.isCookieFallbackEnabled)return window.fetcher.getValue("window.VWO._.cookies.includes",[e]);e=b(e);const i=new RegExp(e),n=Object.keys(jr.getAll());for(let e=0;e<n.length;e++)if(i.test(n[e]))return 1;return 0}};window.VWO._.cookies=jr;class $r{constructor(e){this.storageConfig=e}getValWithPref(e){const{prefer:t,cookieExpDays:i}=this.storageConfig,n=z.get(e),s=z.get(e);return"cookie"==t?z.set(e,n):"ls"==t&&jr.create(e,s,i),{cookie:JSON.parse(n),ls:JSON.parse(s)}}getVal(e){const{strategy:t,prefer:i}=this.storageConfig;for(const n of t)return"all"==n?this.getValWithPref(e)[i]:"ls"==n?JSON.parse(z.get(e)):jr.get(e)}setVal(e,t){const{strategy:i,cookieExpDays:n}=this.storageConfig;for(const s of i)"all"==s?(z.set(e,t),jr.create(e,t,n)):"cookie"==s?jr.create(e,t,n):z.set(e,t)}}const Br=ks(window._vwoCc)?window._vwoCc:{},Kr=e=>(Br.SPA_SPLIT=Br.SPA_SPLIT||{},!(!Br.SPA_SPLIT[e]&&!Br.SPA_SPLIT["*"])),zr=(()=>{const e=Br.debugConfig||{};return{CLICK_DEBUG:e.CLICK_DEBUG,TIMEOUT_DEBUG:e.TIMEOUT_DEBUG,GA_DEBUG:e.GA_DEBUG,URL_DEBUG:e.URL_DEBUG,VARIATION_SHOWN_DEBUG:e.VARIATION_SHOWN_DEBUG,IN_LIST_DEBUG:e.IN_LIST_DEBUG}})(),Yr=!!Br.debugLogs,Jr=()=>Br.syncServerUrl,Xr=Br.disableAsp,qr=!Br.vwoUuidV2Secure,Qr=R(()=>window.VWO._.useCdn)||!1,Zr=Br.enableRefreshLimit,eo=Br.expUrlChange,to=window._vwo_acc_id>1044e3||Br.enableLoader,io=!!Br.eblCSync,no=!!Br.hdPR,so=!!Br.oscH,ro=!!Br.cPM,oo=!!Br.svIdInSyncListDbgLog,ao=!!Br.wMS,lo=()=>R(()=>window._vwoCc.vPH)||!1,co=!!Br.mEPR,uo=!!Br.cA_csa,go=!!Br.dAM,ho=!!Br.observeHTML,vo=!!Br.mSSR,po=!!Br.mtUrlChange,wo=!!Br.allowWinnerSelection,Eo=Br.dNcLT,fo=!!Br.dsPCe,_o=!!Br.vTsPU,mo=!!Br.vTST,Oo=!!Br.sTVS,So=!!Br.aRVId,yo=!!Br.sMR,To=!!Br.aCSF,Co=!!Br.hBCS,Io=!!Br.fPVR,No=!!Br.nHE,Ao=!!Br.cDSTR;function Vo(e){const t=new URL(e);return t.searchParams.set("_cu",encodeURI(window.location.href)),t.toString()}const bo=e=>{const{url:t,data:i,success:n=()=>{},error:s=()=>{}}=e,r=new XMLHttpRequest;r.open("POST",Vo(t),!0),r.send(i),r.onload=()=>{n(r.responseText)},r.onerror=s};let Ro;function Po(e){if(!e)return e;try{e=window.decodeURIComponent(e)}catch(e){}return e}const Do=function(){if(void 0!==Ro)return Ro;const e=[],t=window.VWO._.allSettings.dataStore.campaigns;let i,n;for(let i in t)e.push(i);return Ro=!!(i=(window.location.search+window.location.hash).match(/.*_vis_test_id=(.*?)&.*_vis_opt_preview_combination=(.*?)(?:&|#|$)/))&&(!(!e.includes(i[1])||!t[i[1]]||void 0===t[i[1]].combs[n=Po(i[2])])&&n),Ro},xo=e=>window._vis_heatmap?e:e[0],Lo=()=>!!window._vis_debug;var Uo,Wo,Mo,ko,Go,Fo,Ho;!function(e){e.DOM="vwo_dom"}(Uo||(Uo={})),function(e){e.WILD_CARD="*",e.TRIGGER="trigger",e.POST_INIT="post-init",e.TIMER="vwo_timer",e.TRIGGER_UPDATES="vwo_triggerUpdates"}(Wo||(Wo={})),function(e){e.URL_CHANGE="vwo_urlChange",e.LEAVE_INTENT="vwo_leaveIntent",e.CLICK_EVENT="vwo_dom_click",e.HOVER_EVENT="vwo_dom_hover",e.CHANGE_EVENT="vwo_dom_change",e.ELEMENT_VIEWED_EVENT="vwo_dom_elementViewed",e.SUBMIT_EVENT="vwo_dom_submit",e.PAGE_LOAD_EVENT="vwo_page_load"}(Mo||(Mo={})),function(e){e.PAGE_VIEW="vwo_pageView",e.PAGE_UNLOAD_EVENT="vwo_pageUnload"}(ko||(ko={})),function(e){e.EXIT_CONDITIONS="__exitConditions"}(Go||(Go={})),function(e){e.DOM_CONTENT_LOADED="DOMContentLoaded",e.SCROLL="scroll",e.CLICK="click",e.SUBMIT="submit"}(Fo||(Fo={})),function(e){e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR"}(Ho||(Ho={}));class jo{constructor(e){this.setLevel(e)}setLevel(e="warn"){this.logLevel=Ho[e.toUpperCase()]}info(e,t={}){this.customLog(Ho.INFO,e,t)}debug(e,t={}){this.customLog(Ho.DEBUG,e,t)}warn(e,t={}){var i,n;this.customLog(Ho.WARN,e,t,null===(n=null===(i=window.VWO)||void 0===i?void 0:i._)||void 0===n?void 0:n.customError)}error(e,t={}){var i,n;this.customLog(Ho.ERROR,e,t,null===(n=null===(i=window.VWO)||void 0===i?void 0:i._)||void 0===n?void 0:n.customError)}customLog(e,t,i,n=null){var s,r,o;if(e>=this.logLevel){const a=this.formatMessage(e,t,i);null===(o=null===(r=null===(s=window.VWOEvents)||void 0===s?void 0:s.store)||void 0===r?void 0:r.actions)||void 0===o||o.addLogsForDebugging(a),n?n(a):this.consoleLog(e,[a])}}consoleLog(e,t){switch(e){case Ho.INFO:console.info(...t);break;case Ho.WARN:console.warn(...t);break;case Ho.ERROR:console.error(...t);break;default:console.log(...t)}}formatMessage(e,t,i){var n,s;const r=Object.keys(i).reduce((e,t)=>e.replace(new RegExp(`{{${t}}}`,"g"),i[t]),t),o=`${Uo.DOM}_`;let a=i;const d=(null===(n=i.data)||void 0===n?void 0:n.vwoEventName)||i.vwoEventName;d!==o+Fo.CLICK&&d!==o+Fo.SUBMIT||(a=i.data?null===(s=i.data)||void 0===s?void 0:s.props:a.props,a=a||{name:d});let l=JSON.stringify;try{l=window.VWO._.native.JSON.stringify||JSON.stringify}catch(e){}return`VWO: [${Ho[e].toUpperCase()}] [${(new Date).toUTCString()}] ${r} ${l(a)}`}}var $o=new jo("warn");class Bo{toAbsURL(e){return e?new URL(e,document.baseURI).href:e}isHashPresent(e){return-1!==e.indexOf("#")}isQueryParamPresent(e,t){var i=e.indexOf("#"),n=e.indexOf("?"),s=t?-1:e.indexOf("=");return-1===i?-1!==n||-1!==s:-1!==n&&i>n||-1!==s&&i>s}otherSide(...e){return e[0]="VWO.modules.vwoUtils.urlUtils."+e[0],window.fetcher.getValue(...e)}}const Ko={};function zo(e,t,i,n){return e+"||"+t+"||"+(i?"1":"0")+"||"+(n?"1":"0")}var Yo=function(e){return e.replace(/^(https?:\/\/)(?:w{3}\.)?(.*?)(?:\/(?:home|default|index)\..{3,4}|\/$)?(?:\/)?([\?#].*)?$/i,"$1$2$3").replace(/[?&]_vis_preview_data=[^&#]*/gi,"")},Jo=function(e){return e.replace(/^(https?:\/\/)(?:w{3}\.)?(.*?)(?:(?:home|default|index)\..{3,4})?([\?#].*)?$/i,"$1$2$3")},Xo=function(e){return Jo(e).replace(/\/\?/gi,"?")},qo=window._vis_opt_url,Qo;class Zo{constructor(){Qo=this}regexEscape(e){return e.replace(/[\-\[\]{}()*+?.,\/\\^$|#\s]/g,"\\$&")}cleanURL(e,t){return qo&&!t?qo:e.replace(/^(.*[^\*])(\/(home|default|index)\..{3,4})((\?|#).*)*$/i,"$1$4")}removeWWW(e,t){return e=e.replace(/^(https?:\/\/)(www\.)?(.*)$/i,"$1$3"),t&&(e=e.replace(/(^\*?|\/\/)www\./i,"$1")),e}stripSlashes(e,t,i){if(e=e.replace(/\/$/,""),t){var n=e.indexOf("/?");e.indexOf("?")-1===n&&(e=e.replace(/\/\?([^\?]*)(.*)/,"?$1$2"))}if(i){var s=e.indexOf("/#");e.indexOf("#")-1===s&&(e=e.replace(/\/#([^#]*)(.*)/,"#$1$2"))}return e}cleanPattern(e){let t="";return{regex:e.replace(/\(\?([a-zA-Z])\)/g,(...e)=>(e[1]&&(t+=e[1]),"")),flags:t}}matchRegex(e,t,i,n,s=!1){let r=e=>null;if(s){const s=zo(e,t,i,n);if(Object.prototype.hasOwnProperty.call(Ko,s))return Ko[s];r=e=>{Ko[s]=e}}const o=(()=>{if("string"!=typeof e||"string"!=typeof t)return!1;let s="ig";if(n){const{regex:i,flags:n}=Qo.cleanPattern(t);s=n||"g";try{return new RegExp(i,s).exec(e)||Qo.matchRelativeUrl(e,i,s)}catch(e){const n="Failed to create regex for the pattern: "+t+", the cleaned regex derived from the pattern is: "+i+" and regexFlag is: "+s;return $o.error(n),!1}}var r=function(i){return new RegExp(t,s).exec(e)||new RegExp(t,s).exec(i(e))||Qo.matchRelativeUrl(e,t,s,i)};let o=Yo,a=!1;390187==window._vwo_acc_id&&(a=!0),a&&(o=Xo);var d=r(o);return d&&!a?(o=Jo,i&&r(o)||d):d})();return r(o),o}matchRelativeUrl(e,t,i,n){if(0===e.indexOf("http"))return!1;const s=(new Bo).toAbsURL(e);var r=new RegExp(t,i).exec(s);return n&&!r&&(r=new RegExp(t,i).exec(n(s))),!!r}matchWildcard(e,t,i){if("string"!=typeof e||"string"!=typeof t)return!1;const n=new Bo;var s=n.isQueryParamPresent(t),r=n.isHashPresent(t),o=n.isQueryParamPresent(e),a=n.isHashPresent(e);s||(o&&a?e=e.replace(/^(.*?)(\?[^#]*)(#?.*)$/,"$1$3"):o&&!a&&(e=e.replace(/^(.*)(\?.*)$/,"$1"))),r||a&&(e=e.replace(/^(.*?)(#.*)$/,"$1")),"/"!==e&&(e=Qo.stripSlashes(e,o,a)),"/"!==t&&(t=Qo.stripSlashes(t,s,r));var d,l,c=new RegExp("^"+Qo.regexEscape(t).replace(/\\\*/g,"(.*)")+"$","gi");return c.test(e)?(c=new RegExp("^"+Qo.regexEscape(t).replace(/\\\*/g,"(.*)")+"$","gi"),!i||c.exec(e)):(e=Qo.removeWWW(e),t=Qo.removeWWW(t,!0),(c=new RegExp("^"+Qo.regexEscape(t).replace(/\\\*/g,"(.*)")+"$","gi")).test(e)?(c=new RegExp("^"+Qo.regexEscape(t).replace(/\\\*/g,"(.*)")+"$","gi"),!i||c.exec(e)):(d=Qo.cleanURL(t,!0),-1===t.indexOf("*")&&((l=Qo.removeWWW(n.toAbsURL(e)).replace(/\/$/,"").replace(/\/\?/,"?"))===t||l===d)||(e=Qo.cleanURL(e),t=d,!!(c=new RegExp("^"+Qo.regexEscape(t).replace(/\\\*/g,"(.*)")+"$","gi")).test(e)&&(c=new RegExp("^"+Qo.regexEscape(t).replace(/\\\*/g,"(.*)")+"$","gi"),!i||c.exec(e)))))}matchPlainURLs(e,t){try{const i=new URL(e),n=new URL(t);return i.href===n.href}catch(e){return!1}}}const ea=new Zo;window.VWO.modules.vwoUtils.url=ea,window.VWO._.matchRegex=ea.matchRegex;class ta{verifyUrl(e,t,i,n){let s=!1;const r=n?e:this.getCleanedUrl(e);if(t)if(n)s=!!ea.matchRegex(r,t,null,n);else{const i=this.getCleanedUrl(e,!0);s=!(!ea.matchRegex(r,t,null,n)&&!ea.matchRegex(i,t,!0,n))}else s=ea.matchWildcard(r,i)||ea.matchWildcard(e,i);return s}getCleanedUrl(e,t){if(!e)return;let i;return-1!==e.search(/_vis_(test_id|hash|opt_(preview_combination|random))=[a-z\.\d,]+&?/)?(i=e.replace(/_vis_(test_id|hash|opt_(preview_combination|random))=[a-z\.\d,]+&?/g,""),i=t?i.replace(/(\??&?)$/,""):i.replace(/(\/?\??&?)$/,"")):i=t?e:e.replace(/\/$/,""),i}compareUrlWithIncludeExcludeRegex(e,t,i,n){const s={};return i&&ea.matchRegex(e,i)?(s.didMatch=!1,s.reason=1,s):(s.didMatch=this.verifyUrl(e,t,n),s.reason=s.didMatch?2:3,s)}}const ia=new ta,na="ev",sa="dslv",ra=(e,t)=>5===R(()=>e.sections[1].urlModes[t]),oa=(e,t)=>!(!ra(e,t)&&4!==R(()=>e.sections[1].urlModes[t])),aa=({campaignObj:e,cookieValue:t,getters:i})=>{if(!t)return null;const[n,s=""]=R(()=>t.trim().split(wr),{},[]),r=decodeURIComponent(s);return oa(e,n)&&ea.matchPlainURLs(i.currentUrl,r)?n:null};class da{constructor(){this.uuid="",this.preview=Do,this.hideElExpression="{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}",this.urlCache={}}otherSide(...e){return e[0]="VWO.modules.utils.libUtils."+e[0],e[2]&&(e[2]={captureGroups:e[2]}),window.fetcher.getValue(...e)}isDomDependent(e){return"VISUAL_AB"===e||"VISUAL"===e}isTestingCampaign(e){return this.isDomDependent(e)||"SPLIT_URL"===e}generateUUID(){return"Jxxxxxxxxxxx4xxxyxxxxxx5xxxxxxxx9".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16).toUpperCase()})}shouldUseCrossDomainForInsights(e){if(Dr())return!1;const t=!!R(()=>window.VWO._.allSettings.dataStore.plugins.DACDNCONFIG.jsConfig.crDom);return e?t&&this.isDomIndependentCampaign(e.type):t}isBot2(){return window.VWO._.isBot||P(window.navigator.userAgent).indexOf("bot")>=0||P(window.navigator.userAgent).indexOf("spider")>=0||P(window.navigator.userAgent).indexOf("preview")>=0}isPageBasedGoal(e){return"SEPARATE_PAGE"===e||"CUSTOM_GOAL"===e||"REVENUE_TRACKING"===e}isSplitVariation(e){return"SPLIT_URL"===e.type&&e[tr]}getUUIDString(e){return e?"&u="+e:""}updateGoalsKind(e,t){const i={};return Object.keys(e).forEach(n=>{const s=e[n],r=s.mt;r&&Object.keys(s.goals).length&&Object.entries(r).forEach(([e,s])=>{const r=this.getGoalKind(s),o=s=>{!s||t&&!t[s]||(i[n]=i[n]||{},i[n][e]=s)};Array.isArray(r)?r.forEach(o):o(r)})}),t||(window.VWO._.goalsToBeConvertedSynchronously=i),i}getGoalKind(e){let t;const i=window.VWO._.allSettings.triggers[e],n=3===R(()=>i[sa]);n||R(()=>Object.keys(i.cnds).length)||r({msg:"Trigger definition is empty",event:{triggerName:e}});const s=e=>{switch(e){case m.DOM_CLICK:return"CLICK_ELEMENT";case m.DOM_SUBMIT:return"FORM_SUBMIT";case m.PAGE_UNLOAD:return"PAGE_UNLOAD";default:return""}};if(n)return Object.keys(i[na]).map(s);if("object"==typeof i.cnds[0]){t=s(i.cnds[0].event)}else{switch(i.cnds[1].event){case m.DOM_SUBMIT:case m.DOM_CLICK:t="ENGAGEMENT"}}return t}isXpathAllHead(e,t,i=!1){if(e.muts=e.muts||{},"boolean"==typeof e.muts.pvtMut&&!i)return e.muts.pvtMut;const n=t.split(",");let s=!0;for(let e=0;e<n.length;e++)if(n[e].trim()&&"head"!==P(n[e])){s=!1;break}return i||(e.muts.pvtMut=s),s}isPersonalizeCampaign(e){var t;return"TARGETING"===(null===(t=e.iType)||void 0===t?void 0:t.type)}isPersonalizeHoldback(e){return this.isPersonalizeCampaign(e)&&2===e.iType.v}doNotHideElements(e){return e&&"boolean"==typeof e}getMatchedCookies(e){let t=[];return document.cookie&&(t=document.cookie.match(e)||[]),t}getCombinationCookie(){let e=this.getMatchedCookies(/(?:^|;)\s?(_vis_opt_exp_\d+_combi=[^;$]*)/gi);e=e.map(function(e){try{const t=decodeURIComponent(e);return/_vis_opt_exp_\d+_combi=(?:\d+,?)+\s*$/.test(t)?t:""}catch(e){return""}});const t=[];return e.forEach(function(e){const i=e.match(/([\d,]+)/g);i&&t.push(i.join("-"))}),t.join("|")}isCurrentURLSplitVariation({chosenVariation:e,getters:t,campaignData:i}){if(oa(i,e))return!!aa({campaignObj:i,cookieValue:jr.get(Pr(i.id)),getters:t});let n="";const s=ia.getCleanedUrl(t.currentUrl),r=this.urlCache[i.id]=this.urlCache[i.id]||{},o=r[s]||r[t.currentUrl];if(void 0!==o)return o;let a=!1,d=t.currentUrl;const l=i.sections;return l[1].variationsRegex?(n=l[1].variationsRegex[e],a=ia.verifyUrl(t.currentUrl,n,null)):(n=l[1].variations[e],a=ea.matchWildcard(s,n),d=s),r[d]=!!a}checkForWrongConsent(e,t){return t&&"http:"===e.location.protocol}setCampaignAppliedFlag(e,t){uo&&e.ss&&e.ss.csa?e.cA=!1:e.cA=t}}class la{otherSide(...e){return e[0]="VWO.modules.tags.dataSync."+e[0],window.fetcher.getValue(...e)}}class ca{constructor(){this.allowedMetaDataProps={ogName:!0,source:!0}}otherSide(...e){return e[0]="VWO.modules.tags.dataSync.utils."+e[0],window.fetcher.getValue(...e)}evaluateDataForEventsCall(e,t,i){var n;let s=!0;const r=R(()=>i._vwo.eventDataConfig.addVwoPageMeta);this.syncAdditionalDataWithEventsData(null===(n=i._vwo)||void 0===n?void 0:n.eventDataConfig,i);const o=i.eventUuid,a={d:{}};if(a.d.msgId=`${t}-${+new Date}`,a.d.visId=t,o&&(a.d.eventUuid=o),a.d.event={props:this.excludeEventPropsNotToBeSynced(e,i.name,i.props),name:i.name,time:i.time},i.props.$metaData){const e={},t=i.props.$metaData;for(const i in t)Object.prototype.hasOwnProperty.call(this.allowedMetaDataProps,i)&&(e[i]=t[i]);Object.keys(e).length>0&&(a.d.event.props.vwoMeta=a.d.event.props.vwoMeta||{},Object.assign(a.d.event.props.vwoMeta,e)),delete a.d.event.props.$metaData}return i.props.$visitor&&(a.d.visitor=i.props.$visitor,delete i.props.$visitor,Object.keys(a.d.visitor.props).length<=0&&(s=!1)),a.d.event.props.page=this.getPageInfo(i.page,r),this.resetDataForCurrentEvent(i),{payload:a,shouldSyncCall:s}}getPageInfo(e,t){var i;return(e=e||Tr.page).cnnUrl=document.querySelector&&((null===(i=document.querySelector("link[rel='canonical']"))||void 0===i?void 0:i.href)||""),t&&(e.pageViewId=R(()=>window.tracklib.trackPageId)||R(()=>window.VWO._.track.trackPageId)||window.VWO._.pageId),e}syncAdditionalDataWithEventsData(e,t){if(e)for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&"shouldSyncData"!==i){const n=e[i];if(void 0===n)continue;t.props?t.props[i]=n:t[i]=n}}resetDataForCurrentEvent(e){var t;let i=(null===(t=e._vwo)||void 0===t?void 0:t.eventDataConfig)||{};(i||e.props)&&(i={},e.props={})}excludeEventPropsNotToBeSynced(e,t,i){var n,s,r,o,a,d,l;const c=["fireLinkedTagSync","isTrusted","page","$visitor","isCustomEvent","forceCall","VWO","vwo_doNotProcess_vS","addVwoPageMeta"];if(i.isCustomEvent)c.push("aux"),c.push("ins");else{const i=(null===(o=null===(r=null===(s=null===(n=e.currentSettings)||void 0===n?void 0:n.dataStore)||void 0===s?void 0:s.events)||void 0===r?void 0:r[t])||void 0===o?void 0:o.nS)||(null===(l=null===(d=null===(a=window.VWO._.allSettings.dataStore)||void 0===a?void 0:a.events)||void 0===d?void 0:d[t])||void 0===l?void 0:l.nS)||[];Array.prototype.push.apply(c,i)}if(!c||!c.length)return i;const u={},g=window.VWO._.allSettings.dataStore.events[t];for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e)){const t=i[e];c.indexOf(e)>-1?delete u[e]:u[e]=!g&&t?Ms(t,100):t}return u}}ca.UNREG_EVENT_LOCAL_STORAGE_NAME="vwoUnRegEvents";const ua={[m.VARIATION_SHOWN]:{ignoreMetricDataCheck:!0},[m.PAGE_VIEW]:{},[m.DOM_CLICK]:{},[m.DOM_HOVER]:{},[m.DOM_SUBMIT]:{},[m.CUSTOM_CONVERSION]:{},[m.REVENUE_CONVERSION]:{},[m.SYNC_VISITOR_PROP]:{ignoreMetricDataCheck:!0},[m.PAGE_UNLOAD]:{},[m.DEBUG_EVENT]:{ignoreMetricDataCheck:!0}},ga=e=>!!ua[e],ha=e=>!!R(()=>window.VWO._.allSettings.dataStore.events[e].nw);class va extends ca{constructor(){super(...arguments),this.vwoEventsToBeSynced=Object.assign({},ua)}shouldSendEventCall(e,t){var i;const n=t.name;if(!n)return!1;this.vwoEventsToBeSynced=Object.assign({},window.VWO._.SyncableEventsEnum);const s=this.vwoEventsToBeSynced[t.name];if(void 0===s&&!t.props.isCustomEvent&&!t.props.isSurveyEvent)return!1;if(!window.VWO._.allSettings.dataStore.events[n]){let e;try{e=JSON.parse(z.get(ca.UNREG_EVENT_LOCAL_STORAGE_NAME))||{}}catch(t){e={}}if(e[n])return!1;{e[n]=!0;const t=JSON.stringify(e);z.set(ca.UNREG_EVENT_LOCAL_STORAGE_NAME,t)}}if(t.props.isCustomEvent||t.props.isSurveyEvent||t.props.forceCall)return!0;if(!s||!s.ignoreMetricDataCheck){const e=null===(i=t._vwo)||void 0===i?void 0:i.eventDataConfig;if(!e||Object.keys(e).length<=0)return!1}if(t.name!==m.VARIATION_SHOWN)return!0;let r="non-analytics";location.href.includes("jsMode=Any")&&(r="analytics");const o=null==t?void 0:t.props,a=null==o?void 0:o.id;if(!o||!a)return!1;const d=e.currentSettings.dataStore.campaigns[a]||window._vwo_exp[a],l=window.VWO.modules.utils.libUtils.isSessionBasedCampaign2(d),c="SURVEY"===d.type;return!(!("analytics"===r||"non-analytics"===r&&o.isFirst)||l||c)}sendCall(e,t,i,n,s,r,o){return this.otherSide("sendCall",[e,t,i,n,s,r,o])}addDataFromMTAndSend(e,t,i,n,s,r,o,a){return Va(o.name),this.otherSide("addDataFromMTAndSend",[e,t,i,n,s,r,o,a])}getDataForEventsCall(e,t,n){return i(this,void 0,void 0,function*(){const i=window.VWO.modules.tags.sessionInfoService,{payload:s,shouldSyncCall:r}=this.evaluateDataForEventsCall(e,t,n);return s.d.sessionId=yield i.getSessionId(),{data:s,shouldSyncCall:r}})}}var pa=new va;class wa extends la{execute({event:e,getters:t,vwoEvents:n},s,r,o,a){return i(this,void 0,void 0,function*(){if(t.visDebug)return void(r=r||or)(o);if(pa.shouldSendEventCall(t,e)){a=a||(yield od.createUUIDCookie2(t,s));const{data:i,shouldSyncCall:n}=yield pa.getDataForEventsCall(t,a,e);n&&(yield pa.addDataFromMTAndSend(t,null,i,r,!0,o,e,null==s?void 0:s.id))}else(r=r||or)(o)})}}const Ea=new wa,fa=Ea.execute.bind(Ea);function _a(e,t){var i;const n=e.conflictingPropsData||{};if(!e.props){e.props={};const i=["name","props","_vwo","_meta","conflictingPropsData","eventUuid"];for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(i.includes(t)||(e.props[t]=e[t]));Object.assign(e.props,n),Object.keys(t).forEach(i=>{e.props[i]=t[i]})}e.aux&&(e.props.aux=e.aux),e.time=e.time||(null===(i=e.VWO)||void 0===i?void 0:i.firedTime)||+new Date}const ma={},Oa=e=>{const t=R(()=>e.name);return t===m.VARIATION_SHOWN&&"number"==typeof R(()=>+e.props.id)?`${m.VARIATION_SHOWN}_${e.props.id}`:t};function Sa({vwoEvents:e,getters:t,data:n,actions:s,event:r},o,a={},d=null){var l,c;return i(this,void 0,void 0,function*(){if(r.name=o||r.name,null===(l=ma[Oa(r)])||void 0===l?void 0:l.shouldWaitForCallbackExecution)return;let i;_a(r,a),(r.name===m.VARIATION_SHOWN||r.props.isSurveyEvent)&&(i=t.settings.campaigns[r.props.id]);const u=null===(c=r._vwo)||void 0===c?void 0:c.eventDataConfig;if(u){const i=Object.keys(u);for(let o=i.length-1;o>=0;--o){const a=i[o];r._vwo.eventDataConfig=u[a],delete u[a],yield fa({getters:t,event:r,data:n,actions:s,vwoEvents:e},null,d,r.props,a)}}else yield fa({getters:t,event:r,data:n,actions:s,vwoEvents:e},i,d,r.props)})}function ya(e,t,n,s=null,r=[]){const o=window.phoenix;n.name=n.name||t;const a=Oa(Object.assign({name:t},n));return ma[a]=ma[a]||{},ma[a].shouldWaitForCallbackExecution=!0,(e=e||o).trigger(t,n,function(e){return i(this,void 0,void 0,function*(){const i=o.store,n=i.getters;ma[Oa(e)].shouldWaitForCallbackExecution=!1,yield Sa({getters:n,actions:i.actions,event:e,vwoEvents:o,data:{}},t,{},s)})},r)}function Ta(e,t,i,n={},s=null){return ya(e,t,Object.assign({name:t,time:+new Date,props:i},n),s)}const Ca={variationShown(e,t,n){return i(this,void 0,void 0,function*(){"string"==typeof t.id&&(t.id=Number(t.id)),n||(n=window._vwo_exp[t.id]),e=e||window.phoenix,n&&void 0===n.isFirst&&(n.isFirst=t.isFirst),yield Ta(e,m.VARIATION_SHOWN,t,{},od.variationShownCallback)})},dimensionTagPushed(e,t){Ta(e=e||window.phoenix,m.DIMENSION_TAG_PUSHED,t)},unhideElement(e,t,i){i||Ta(e,m.UNHIDE_ELEMENT,void 0,t)}},Ia=e=>!!R(()=>window.VWO._.eventsSynced[e]),Na=()=>{window.VWO.phoenix.on(m.END_APPLY_CHANGES,()=>{const e=R(()=>window.VWO.phoenix.store.getters),t=e.eventsHistory||[],i=window.VWO._.allSettings.dataStore.events;if(t.length>0)try{const n=(e=>e.reduce((e,t)=>(e[t.name]=t.event,e),{}))(t);for(const t in i)if(ga(t)&&ha(t)&&n[t]&&!Ia(t)){const i=n[t];i.props=i.props||{},i.props.forceCall=!0,Sa({getters:e,actions:window.VWO.phoenix.store.actions,event:n[t],vwoEvents:window.VWO.phoenix,data:{}},t)}}catch(e){}})},Aa=()=>{window.VWO._.eventsSynced={}},Va=e=>{window.VWO._.eventsSynced=window.VWO._.eventsSynced||{},window.VWO._.eventsSynced[e]=!0};let ba;function Ra(e){ba=e}function Pa(e){window.VWO=null!=e?e:ba}window.VWO.modules.events={syncEventsDataToDataLayer:Sa,fireEventAndSyncData:ya,events:Ca,markEventSyncedWT:Va};const Da={VISITOR_IS_NOT_OPTED_OUT:"visitorIsNotOptedOut",VISITOR_IS_OPTED_OUT_COMPLETELY:"visitorIsOptedOutCompletely",VISITOR_IS_OPTED_OUT:"visitorIsOptedOut"};var xa;!function(e){e[e.OPTED_OUT_WITH_EXPERIENCE=0]="OPTED_OUT_WITH_EXPERIENCE",e[e.OPTED_OUT_PARTIALLY=1]="OPTED_OUT_PARTIALLY",e[e.OPTED_OUT_COMPLETELY=2]="OPTED_OUT_COMPLETELY"}(xa||(xa={}));class La{setOptOutStateConfig(){let e,t,i,n;switch(e=window.VWO._.isWorkerThread?window.phoenix.storages.storages.cookies.get("_vis_opt_out",!0):window.VWO._.cookies.get("_vis_opt_out",!0),e&&(e=Number(e)),e){case 0:t=Da.VISITOR_IS_OPTED_OUT,i=!0,n=!1;break;case 1:case 2:t=Da.VISITOR_IS_OPTED_OUT_COMPLETELY,i=!1,n=!1;break;default:t=Da.VISITOR_IS_NOT_OPTED_OUT,i=!0,n=!0}window.VWO.phoenix&&window.fetcher.setValue("window.VWO._.optOutStates",{state:t,executeLib:i,shouldWeTrackVisitor:n}),window.VWO._.optOutStates={state:t,executeLib:i,shouldWeTrackVisitor:n}}callStopAnalyzeAndSurvey(){if(!R(()=>window.VWO._.optOutStates.shouldWeTrackVisitor))if(window.VWO._.isWorkerThread)window.fetcher.getValue("window.VWO.modules.otherLibDeps.stopAnalyzeAndSurvey");else{const e=R(()=>window.VWO.modules.otherLibDeps.stopAnalyzeAndSurvey);"function"==typeof e&&e()}}getOptOutStateConfig(){return window.VWO._.optOutStates}shouldExecuteLibOnBasisOfCurrentOptOutState(){return!(!Do()&&!window._vis_debug)||(this.getOptOutStateConfig().executeLib||window._removeVwoGlobalStyle(),this.getOptOutStateConfig().executeLib)}shouldWeTrackVisitor(){return!(!Do()&&!window._vis_debug)||this.getOptOutStateConfig().shouldWeTrackVisitor}isVisitorOptedOut(){return!Do()&&!window._vis_debug&&this.getOptOutStateConfig().state!==Da.VISITOR_IS_NOT_OPTED_OUT}}const Ua=new La;function Wa(e){const t=e.storages.storages.cookies.get("_vis_opt_out",!0);return!!(t||window.location.href.indexOf("vwo_opt_out=1")>-1)&&("0"!==t&&("2"!==t&&window.fetcher.getValue("window.VWO.optOut.process",[{accountId:e.accountId,domain:e.cookieDomain}]),!0))}window.VWO.modules.vwoUtils.optOut=Ua;const Ma={};const ka=()=>window.fetcher.getValue("window.VWO.modules.phoenixPlugins.events.predefinedEvents.PageViewEvent.computeEligibleFunctionalTriggers").catch(e=>(r({msg:"Error in getEligibleFunctionalTriggersFromMT",source:JSON.stringify(e),url:window.location.href}),[])),Ga=/:nth-parent\((\d+)\)$/,Fa=/[A-Za-z1-9]*?:tm\(["']([\s\S]*?)["']\)(?:\:nth-parent\(\d\))?/,Ha=e=>e.indexOf(":tm(")>-1,ja=e=>!!Ha(e),$a=e=>{const t=e.match(Ga)||[];if(t.length<2)return;const i=+t[1];return isNaN(i)?void 0:i};function Ba(){const e={};return function(t){if(e[t])return e[t];if(Ha(t)){const{targetElement:i,targetText:n,ancestorLevelCount:s,childSel:r}=(e=>{const t=e.match(Fa)||[e],i=t[0],[n]=e.split(":tm("),s=t[1],r=$a(i),o=void 0!==t.index?e.slice(t.index+i.length,e.length).trim():"",a=n.trim().split(" ");return{targetElement:1==a.length?a[0].toUpperCase():a.map(e=>(-1===e.search(/(\.|#)/)&&(e=e.toUpperCase()),e)).join(" "),targetText:s,ancestorLevelCount:r,childSel:o}})(t);return e[t]={targetElement:i,targetText:n,ancestorLevelCount:s,childSel:r}}return{targetElement:"",targetText:""}}}const Ka=Ba(),za={};function Ya(e){if(Array.isArray(za[e]))return za[e];const t=e.split("<vwo_sep>");return 1===t.length?za[e]=[{sel:e,isTxtSel:!0}]:za[e]=t.map(e=>({sel:e.trim(),isTxtSel:ja(e)}))}const Ja=e=>"number"==typeof e,Xa=(e,t)=>!(!e||e.sel!==t),qa=(e,t)=>Ja(e)&&e===t,Qa=({targetElement:e,targetText:t,ancestorLevelCount:i,childSel:n},s)=>{const r=[e,t].join(".");if(!s||!Array.isArray(s[r]))return null;for(let e=0;e<s[r].length;e++){const t=s[r][e];if(!t)return null;const o=!i&&!t.d||qa(i,t.d),a=!n&&!t.cd||Xa(t.cd,n);if(o&&a)return t}return null},Za=()=>Object.assign({},R(()=>window.VWO._.txtCfg)||{}),ed=Za(),td=()=>{ed.o&&R(()=>{ed.o.d()})};window.VWO.modules.utils.textBasedSelectorUtils={disconnectMutationObserver:td};const id=e=>{const t=Ya(e),i=window.VWO._.txtCfg||{},n=i.mp=i.mp||{};let s="";const r=e=>{s+=e+","};for(const e of t)if(e.isTxtSel)if(n[e.sel])r(n[e.sel]);else{const t=Ka(e.sel),s=Qa(t,i.txtSelMap);if(s&&s.s){const t="."+s.s;r(t),n[e.sel]=t}}else r(e.sel);return s},nd=()=>{window.VWO._.txtCfg&&window.VWO._.txtCfg.mp&&window.fetcher.setValue("window.VWO._.txtCfg.mp",window.VWO._.txtCfg.mp)},sd=function(e){return window.VWO.phoenix.validateTrigger(e,null,{skipEventProps:!0,skipValidationIfTimer:!0})};class rd extends da{constructor(){super(...arguments),this.additionalStyle=window._vwo_acc_id>742099||718480===window._vwo_acc_id?"-webkit-transform:none;-ms-transform:none;transform:none;":"",this.hideElExpression=`{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;${this.additionalStyle}}`,this.domIndependentCampaigns=["ANALYSIS","SURVEY","ANALYZE_RECORDING","ANALYZE_HEATMAP","ANALYZE_FORM","TRACK","FUNNEL","INSIGHTS_FUNNEL","INSIGHTS_METRIC"],this.sessionBasedCampaigns={ANALYZE_RECORDING:!0,ANALYZE_HEATMAP:!0,ANALYZE_FORM:!0,TRACK:!0,FUNNEL:!0,INSIGHTS_FUNNEL:!0,INSIGHTS_METRIC:!0}}isGloballyOptedOut(e){return!!parseInt(e.storages.storages.cookies.get(zs.GLOBAL_OPT_OUT,!0),10)}isByoidCreationFailed(){return R(()=>!!window.VWO._.noVisId)}isDomIndependentCampaign(e){return-1!==this.domIndependentCampaigns.indexOf(e)}isSessionBasedCampaign2(e={}){const t=e.type;return!!this.sessionBasedCampaigns[t]}hasInsightsMetric(e){return"INSIGHTS_FUNNEL"===e||"INSIGHTS_METRIC"===e}isAnalyzeCampaign(e){return"ANALYZE_RECORDING"===e||"ANALYZE_HEATMAP"===e||"ANALYZE_FORM"===e}firePageViewEvent(e={}){return i(this,void 0,void 0,function*(){const t=window.VWO.phoenix,i=window.VWO.phoenix.store.getters;yield window.VWO._.session_init_complete,t.trigger(m.START_APPLY_CHANGES);const n=yield ka(),s=m.PAGE_VIEW,r={name:s,time:+new Date,props:{url:i.currentUrl,forceCall:Io},page:{url:i.currentUrl}};ya(t,s,r,()=>{window.VWO.modules.eventHistHandler.updateEventHist(s,r),t.trigger(m.END_APPLY_CHANGES),t.trigger(m.AFTER_SAMPLING_TRIGGER),window.VWO._.phoenixMT.trigger(m.END_APPLY_CHANGES),e.shouldFireDomLoad&&t.trigger(m.DOM_CONTENTLOADED)},n)})}fireAuxiliaryPageView(){return i(this,void 0,void 0,function*(){if(window.VWO._.auxPageViewFired)return;yield window.VWO._.visibilityTriggered,window.VWO._.auxPageViewFired=!0;const e=window.VWO.phoenix,t=window.VWO.phoenix.store.getters;ya(e,m.PAGE_VIEW,{name:m.PAGE_VIEW,time:+new Date,aux:!0,ins:!0,props:{url:t.currentUrl}})})}doNotTrack(e){if(e.settings.vwoData.dntEnabled)return"yes"===e.navigator.doNotTrack||"1"==e.navigator.doNotTrack||"1"==e.navigator.msDoNotTrack||"1"==e.doNotTrack}_optOut(e,t){return Wa(e)?(t.trigger(m.OPT_OUT,{oldArgs:[!0]}),!0):(t.trigger(m.OPT_OUT,{oldArgs:[!1]}),!1)}setCampaignIds(e){return i(this,void 0,void 0,function*(){this.otherSide('setCampaignIds("${{1}}", "${{2}}")',null,[e]);const{actions:t,getters:i}=ba.phoenix.store,n=i.vwoInternalProperties.experimentIds||[];e.forEach(e=>n.push(+e)),t.addValues({experimentIds:n},"vwoInternalProperties")})}isCustomTrigger(e){var t;return null===(t=e.cnds)||void 0===t?void 0:t.some(function(e){var t;return"object"==typeof e&&null!==e&&(null===(t=e.filters)||void 0===t?void 0:t.some(function(e){return e instanceof Array&&e.indexOf("exec")>=0}))})}addListener(e,t,i,n){if(!i||!Object.keys(i).length)return;let s;const r=i.eventName,o=i.triggerID,a=i.trigger;if(o){const t=e.currentSettings.triggers[o];s=t&&this.isCustomTrigger(t)?`trigger.${o}`:t}if(s=s||r||a,s){return[s,t.on(s,n)]}}extraData2(e){return i(this,void 0,void 0,function*(){return this.otherSide('extraData2("${{1}}")',null,[e])})}isBotScreen(){return i(this,void 0,void 0,function*(){return this.otherSide("isBotScreen")})}shouldTrackUserForCampaign(e){return"number"==typeof e&&(e=window._vwo_exp[e]),!(!e||"SPLIT_URL"!==e.type||!e.cSel)||(!e||!window._vwo_code||!window._vwo_code[Zs]&&!window._vwo_code[er]||(this.isDomIndependentCampaign(e.type)||this.isSplitVariation(e)))}isEligibleToSendCall(e,t){return!Do()&&(t&&!t.visDebug||!window._vis_debug)&&this.shouldTrackUserForCampaign(e)&&(t&&t.vwoInternalProperties.shouldExecuteLib||window.VWO._.shouldExecuteLib)}createCookie(e,t,n,s,r){return i(this,void 0,void 0,function*(){const i=(e=e||ba.phoenix.store.getters).storages.storages.cookies;this.shouldTrackUserForCampaign(r)&&(r&&r.multiple_domains||this.shouldUseCrossDomainForInsights(r||{})?yield i.createThirdParty(t,n,s,void 0,r.id,!0,r,!1,!0):i.create(t,n,s))})}createUUIDCookie2(e,t){return i(this,void 0,void 0,function*(){if(Ua.isVisitorOptedOut())return;e=e||window.VWO.phoenix.store.getters;const i=yield this.getUUID(e,t);let n=t&&t.id&&t.multiple_domains?"_"+t.id:"";return this.shouldUseCrossDomainForInsights(t||{})&&(n=ur),(yield e.storages.storages.cookies.get("_vwo_uuid"+n))||(yield this.createCookie(e,"_vwo_uuid"+n,i,zs.UUID_COOKIE_EXPIRY,t)),ba.data=ba.data||{},ba.data.vin=ba.data.vin||{},ba.data.vin.uuid=i,yield window.fetcher.setValue("VWO.data.vin",ba.data.vin),i})}getUUID(e,t){e=e||ba.phoenix.store.getters,t=t||{},this.uuid=e.vwoUUID;let i=t&&t.id&&t.multiple_domains?"_"+t.id:"";this.shouldUseCrossDomainForInsights(t)&&(i=ur);const n=i&&(e.storages.storages.cookies.get("_vwo_uuid"+i)||e.storages.storages.cookies.get("_vwo_uuid"+ur))||e.storages.storages.cookies.get("_vwo_uuid");return this.uuid=n||this.uuid||this.generateUUID(),this.uuid}getSplitDecision(e,t){const i=t.id;if(window._vis_debug||Do())return this.otherSide("getSplitDecision",[i]);const n=e.storages.storages.cookies.get("_vis_opt_exp_"+i+"_split");return n&&n.split("|").length>1?(this.createCookie(e,"_vis_opt_exp_"+i+"_split",n.split("|")[0],100),t.trackVisitor=!0,n.split("|")[0].split(wr).length>1?n.split("|")[0].split(wr)[1]:n.split("|")[0]):R(()=>n.split("|")[0].split(wr)[0])}shouldExecuteLib({getters:e,actions:t,vwoEvents:n}){return i(this,void 0,void 0,function*(){const{doCookiesMatter:i,areCookiesDisabled:s,shouldStopExecWhenSsmNotFound:r,isSSApp:o}=window.VWO._.envUtils;if(window.VWO._.shouldExecuteLib){const e=[{shouldExecuteLib:!0,destinationMT:"VWO._.shouldExecuteLib"}];return void this.setPropertiesToBothThreads(t,e,"vwoInternalProperties")}if(i){const i=this.checkForWrongConsent(e,o);if(i||r){e.vwoCode&&e.vwoCode.finish(),ya(n,m.SHOULD_EXECUTE_LIB_ERROR,i?{message:"SameSite;Secure enabled but visitor landed on HTTP page and thus cookies can't be created",oldArgs:[void 0,void 0,void 0,void 0,void 0,void 0,1]}:{message:"Visitor has been to HTTPS page when SameSite and Secure cookies were dropped",oldArgs:[void 0,!0,void 0,void 0,void 0,void 0,2]});const s=[{shouldExecuteLib:!1,destinationMT:"VWO._.shouldExecuteLib"}];return this.setPropertiesToBothThreads(t,s,"vwoInternalProperties")}}if(this.isTrackingNotPossible){const e=[{shouldExecuteLib:!this.isTrackingNotPossible,destinationMT:"VWO._.shouldExecuteLib"}];return this.setPropertiesToBothThreads(t,e,"vwoInternalProperties")}if(!s){if(this.preview()||e.visDebug){if(this.isByoidCreationFailed()){ya(n,m.SHOULD_EXECUTE_LIB_ERROR,{message:"Visitor identifier could not be set.",oldArgs:[void 0,void 0,void 0,void 0,void 0,void 0,!0]});const e=[{shouldExecuteLib:!1,destinationMT:"VWO._.shouldExecuteLib"}];return this.setPropertiesToBothThreads(t,e,"vwoInternalProperties")}const e=[{shouldExecuteLib:!0,destinationMT:"VWO._.shouldExecuteLib"}];return this.setPropertiesToBothThreads(t,e,"vwoInternalProperties")}if(this.doNotTrack(e)||this.isGloballyOptedOut(e)||this._optOut(e,n)){e.vwoCode&&e.vwoCode.finish(),ya(n,m.SHOULD_EXECUTE_LIB_ERROR,{message:"User has opted out"}),this.isTrackingNotPossible=!0,t.addValues({optOut:!0},"vwoInternalProperties");const i=[{shouldExecuteLib:!1,destinationMT:"VWO._.shouldExecuteLib"}];return this.setPropertiesToBothThreads(t,i,"vwoInternalProperties")}const i=[{shouldExecuteLib:!0,destinationMT:"VWO._.shouldExecuteLib"}];return this.setPropertiesToBothThreads(t,i,"vwoInternalProperties")}t.addValues({cookiesDisabled:!0},"vwoInternalProperties"),x()||ya(n,m.SHOULD_EXECUTE_LIB_ERROR,{message:"Cookies disabled",oldArgs:[void 0,s]}),this.isTrackingNotPossible=!0;return this.setPropertiesToBothThreads(t,[{shouldExecuteLib:!1,destinationMT:"VWO._.shouldExecuteLib"}],"vwoInternalProperties")})}insertCSS(e,t){this.otherSide("insertCSS",[e,t])}unhideCampaignLevelStyle(e){window.fetcher.getValue("VWO.modules.utils.libUtils.removeCampaignLevelStyleTag",[e])}setXpathAndHideEl(e,t,n,s=!0){return i(this,void 0,void 0,function*(){const r=this;let o,a,d="";const l=[e.id],c=this.isPersonalizeCampaign(e),u=e.sen;let{visibilityServiceCache:g}=window.VWO._;const h=window.VWO._.clientHideElementStyle||this.hideElExpression;if(e.id)for(o=l.length;o--;){a=l[o],g=g||{};const v=g[a]&&g[a].xpath||{},p=g[a]&&g[a].cpath||{},w=Object.assign(v,p);let{selector:E,selectorPerVariation:f,cPathSelector:_,cPathSelectorPerVariation:m}=Object.keys(w).length>0?w:yield this.getCampaignXPath(e);if(E=E||n||"",_=_||"",m=m||{},e.xPath=E,_&&(e.cPath=_),window.VWO._.ac&&window.VWO._.ac.PRTHD||window.VWO._.preventHidingInSPA||!s)return;if(c){let n=null;if(no){const t=Do(),i=e.debug||{};n=t||(i.tg?null:i.v),n||(n=R(()=>e.ss.csa)?null:jr.get("_vis_opt_exp_"+a+"_combi"))}Object.keys(f).forEach(function(s){return i(this,void 0,void 0,function*(){const i=e.sections[1].triggers[s],o=t.currentSettings.triggers[i],d=e.sections[1].sen;if((!No||d)&&(!d||!r.doNotHideElements(d[s]))&&(r.isPersonalizeHoldback(e)||n==s||(yield sd(o)))){let e="";f[s]&&(e=f[s]),m[s]&&(e+=(e.length>0?",":"")+m[s]),e.length>0&&(","===e[e.length-1]&&(e=e.substring(0,e.length-1)),e+=h,r.insertCSS("_vis_opt_path_hides_"+a+"_"+s,e))}})})}if(this.doNotHideElements(u))return;E&&(d=E),_&&(d+=(d.length>0?",":"")+_),d&&(d+=h,this.insertCSS("_vis_opt_path_hides_"+a,d))}else d=t.vwoText||"",this.insertCSS("_vis_opt_path_hides",d)})}setPropertiesToBothThreads(e,t,i){let n={};t.forEach(e=>{const t=Object.keys(e)[0],i=e[t];n=Object.assign(Object.assign({},n),{[t]:i}),window.fetcher.setValue(e.destinationMT,i)}),e.addValues(n,i)}checkAndInitializeDomEvents(){const e=window.VWO.modules.phoenixPlugins.events.predefinedEvents;window.VWO.isVwoClickClassInitialized||this.checkAndInitializeEventClass(e.ClickDomEvent,["ANALYZE_HEATMAP","ANALYZE_RECORDING"],!0),window.VWO.isVwoHoverClassInitialized||this.checkAndInitializeEventClass(e.HoverDomEvent,["ANALYZE_HEATMAP"])}checkAndInitializeEventClass(e,t,i=!1){const n=window.VWO._.allSettings.dataStore.campaigns;for(const s in n)if(i&&n[s].clickmap||t.includes(n[s].type)){window.VWO.phoenix.events.add(new e);break}}addListenerForSessionInitComplete(){ba._.session_init_complete=new Promise(e=>{const t=window.VWO.phoenix.on(m.SESSION_INIT_COMPLETE,()=>{window.VWO.phoenix.off(m.SESSION_INIT_COMPLETE,t),e()})})}variationShownCallback(e){var t;const{id:i,variation:n}=e,s=window.VWO.phoenix;switch(null===(t=window._vwo_exp[i])||void 0===t?void 0:t.type){case"VISUAL_AB":case"VISUAL":s.trigger(m.VARIATION_SHOWN_SENT,{oldArgs:[""+i,n]});break;case"SPLIT_URL":1==n&&s.trigger(m.VARIATION_SHOWN_SENT,{oldArgs:[""+i,n]})}}isTsExpired(e,t){const i=new Date,n=new Date(e);return(i.getTime()-n.getTime())/864e5>t}getCampaignXPath(e){return i(this,void 0,void 0,function*(){const t={selector:"",selectorPerVariation:{},cPathSelector:"",cPathSelectorPerVariation:{}};if(e.xPath)return t.selector=e.xPath,t.cPathSelector=e.cPath,t;if(!this.isDomDependent(e.type))return t;let i=e.combination_chosen||e.cc;const n=e.sections;if("VISUAL_AB"===e.type)if(i){if(1!=i){const{variationXPathSelector:n,variationCPathSelector:s}=yield this.getSelectorPath(i,e);t.selector=n,t.cPathSelector=s}}else{const n=this.isPersonalizeHoldback(e)?e.sections[1].variation_names:e.combs;for(i in n)if(n.hasOwnProperty(i)){const{variationXPathSelector:n,variationCPathSelector:s}=yield this.getSelectorPath(i,e);t.selector+=n,t.cPathSelector+=s,t.cPathSelectorPerVariation[i]=s,t.selectorPerVariation[i]=n.substring(0,n.length-1)}}else{const e=Vs(n);let i=e.length;for(;i--;)n[e[i]].path&&(t.selector+=n[e[i]].path+",")}return!e.dHE||t.selector&&!this.isXpathAllHead(e,t.selector,!0)||(t.selector=(t.selector||"")+".vwo_dummy_selector,"),t.cPathSelector&&(t.cPathSelector=t.cPathSelector.substring(0,t.cPathSelector.length-1)),t.selector&&(t.selector=t.selector.substring(0,t.selector.length-1)),nd(),t})}getSelectorPath(e,t){return i(this,void 0,void 0,function*(){let i="",n="",s=t.sections[1].variations[e];if("string"==typeof s&&(s=vwo_$.parseJSON(s)),s)for(let r=0;r<s.length;r++){let o=s[r].xpath;const a=s[r].getPath;if(a)try{t.aTO=!0;const i=window.VWO._.allSettings.tags[a];o=yield i.fn(()=>{},{campaignId:t.id,pgGrpIds:s[r].pgGrpIds||[],xpath:s[r].xpath,unhideTrigger:s[r].unhideTrigger,cpath:s[r].cpath,variationId:e,campaignData:t})}catch(e){}o&&(s[r].dHE?t.dHE=!0:(t.mSP&&(o=o.replace(/html\.vwo_p_s_\w+\s*/g,"")),ja(o)?i+=id(o):i+=o+",")),s[r].cpath&&!s[r].dHE&&(n+=s[r].cpath+",")}return{variationXPathSelector:i,variationCPathSelector:n}})}}const od=new rd;window.VWO.modules.utils.libUtils=od;const ad=()=>window.VWO.phoenix,dd=()=>ad().store.getters;class ld extends Is{constructor(e,t,i){super(),this.contentSyncLocation="VWO._.contentSyncService",this.collectedData={},this.requestsChecker={},this.url=t,this.globalLookupContext=i,this.storageObj=new $r(e)}parseStorageInfo(e,t,i){if(!e)return;const[n,s]=t.split(".");return e[n]=e[n]||{},e[n][s]=e[n][s]||{},e[n][s][i]}getInfoFromGlobalObject(e,t){if(!e)return;const[i,n]=t.split(".");return e[i]=e[i]||{},e[i][n]=e[i][n]||{},{argVn:e[i][n].args||{},vn:e[i][n].vn}}fixResponse(e){const t={fns:{}};e.fns=e.fns||{};for(const i in e.fns)for(const n in e.fns[i]){const s=e.fns[i][n],r=JSON.stringify(JSON.parse(n));t.fns[i]=t.fns[i]||{},t.fns[i][r]=s}return t}syncGet(e,t,i=!0){const n={dataPresent:!1};if(!this.storageObj)return n;const s=this.storageObj.getVal(this.storageLookUpKey),r=JSON.stringify(t),o=this.getInfoFromGlobalObject(this.globalLookupContext,e),a=o&&o.vn,d=o&&o.argVn,l=this.parseStorageInfo(s,e,r);if(l&&i){const i=l;let s=!1,o=!1;for(const n in d)for(const a in d[n])if(i.argVn[n]&&i.argVn[n][a]&&parseInt(i.argVn[n][a])<parseInt(d[n][a])){s=!0,this.syncFromBackend(e,t,r,this.url),o=!0;break}return a&&parseInt(a)>parseInt(i.vn)&&!s&&(this.syncFromBackend(e,t,r,this.url),o=!0),io&&o?n:{dataPresent:!0,val:i.val}}return this.syncFromBackend(e,t,r,this.url),n}syncFromBackend(e,t,i,n){if(io){const[s,r]=e.split(".");if(this.collectedData[s]=this.collectedData[s]||{},this.collectedData[s][r]=this.collectedData[s][r]||[],this.requestsChecker[i])return;this.requestsChecker[i]=1,this.collectedData[s][r].push(t),this.debouncedCall=this.debouncedCall||Ws(()=>{bo({url:n+"sync?a="+window._vwo_acc_id,data:JSON.stringify(this.collectedData),success:e=>{const i=JSON.parse(e);this.updateStorage(i);this.sendDebugLogForSyncList(i,({listMatched:e,listUnmatched:i})=>{window.fetcher.getValue('window.VWO._.sendGenericDebugEvent("${{1}}")',null,{captureGroups:[Object.assign(Object.assign({},oo?{visId:od.getUUID(dd())}:{}),{listVal:t[0],listMatched:e,listUnmatched:i})]})})}}),this.collectedData={}},10),this.debouncedCall()}else this.otherSide("syncFromBackend",[e,t,i,n])}updateStorage(e){const t=this.storageObj.getVal(this.storageLookUpKey);let i={};(t||!1)&&(i=t);const n=(e=this.fixResponse(e)).fns;for(const e in n){const t=n[e];for(const n in t){i.fns=i.fns||{},i.fns[e]=i.fns[e]||{};const s=i.fns[e][n];if(s)if(parseInt(s.vn)==parseInt(t[n].vn)){const s=i.fns[e][n].argVn;let r=!0;for(const e in s){if(!t[n].argVn[e]||!r){r=!1;break}for(const i in s[e]){const o=t[n].argVn[e][i],a=s[e][i];if(!o||parseInt(a)<=parseInt(o)){r=!1;break}}}!r&&(i.fns[e][n]=t[n])}else parseInt(s.vn)<parseInt(t[n].vn)&&(i.fns[e][n]=t[n]);else i.fns[e][n]=t[n]}}this.storageObj.setVal(this.storageLookUpKey,JSON.stringify(i))}}window.VWO.modules.tags={};class cd{otherSide(...e){e[0]="VWO.modules.tags.checkEnvironment."+e[0],window.fetcher.getValue(...e)}}window.VWO.modules.tags.checkEnvironment={};class ud{otherSide(...e){return e[0]="window.VWO.modules.utils.campaignUtils."+e[0],window.fetcher.getValue(...e)}updateGoalCookieValueForExperience(e,t,i){if(!e)return`mE_${t}`;const n=e.split("mE_")[1];let s=[];return s=n?n.split("|"):[],s.includes(t)||s.push(t),`mE_${s.join("|")}`}isGoalTriggeredForExperience(e,t,i){let n=e?e.split("mE_")[1].split("|"):[];return i?t.every(e=>n.includes(e)):n.includes(t)}checkForVariationTargeting(e){const t=R(()=>e.sections[1].triggers);return!(!t||0===Object.keys(t).length||0===t.length)}}var gd,hd;!function(e){e.ANALYSIS="r",e.ANALYZE_FORM="a",e.ANALYZE_HEATMAP="a",e.ANALYZE_RECORDING="a",e.FUNNEL="t",e.SURVEY="s",e.TRACK="t",e.INSIGHTS_FUNNEL="t",e.INSIGHTS_METRIC="t"}(gd||(gd={})),function(e){e.RANDOM="1",e.HASH="2"}(hd||(hd={}));let vd={variationSelection:"hash"};const pd=e=>{Ar().cif=e,R(()=>window.fetcher.setValue("window.VWO._.allSettings.dataStore.cif",e))},wd=()=>!(!R(()=>Ar().cif)&&!R(()=>Ar().CIF)),Ed=()=>R(()=>Ar().cif.config)||R(()=>_d().config)||vd,fd=()=>{const e=jr.get("_vwo_uuid_v2");return e?e.split("|"):null},_d=()=>{const e=fd();if(!e||e.length<4||!e[2])return null;const t={uuid:e[2],config:{variationSelection:e[3]===hd.RANDOM?"random":"hash"}};return pd(t),t},md=function(e,t){let i=0;for(let t=e.length-1;t>=0;t--)i+=e.charCodeAt(t);let n=i+t;for(let e=0;e<19;e++)n=(9301*n+49297)%233280;return n/233280},Od=function(e,t){return e/(t/100)},Sd={getRandom:function(e,t){return wd()?md(e,t):Math.random()},getRandomForVariation:function(e,t){if(wd()){const{variationSelection:i}=Ed();if(e&&t&&"hash"===i)return Od(e,t)}return Math.random()}};class yd extends ud{constructor(){super(...arguments),this.campaignsInternalMap=window.VWO._.campaignsInternalMap={}}markGoalTriggered(e,t,n){var s,r;return i(this,void 0,void 0,function*(){if("TRACK"===e.type)yield null===(r=(s=window.tracklib).markGoalTriggered)||void 0===r?void 0:r.call(s,e.id,t);else if("INSIGHTS_METRIC"===e.type)e.goals[t].mca||window.VWO._.insightsUtils.includeInsightsMetric(e.id);else{let i=n.storages.storages.cookies.get("_vis_opt_exp_"+e.id+"_goal_"+t);if(e.mE){let t=n.storages.storages.cookies.get("_vis_opt_exp_"+e.id+"_combi");const s=od.isPersonalizeHoldback(e);if(s){const e=t.split(";")[1],i=t.split(";")[0].split("|");t=i.find(t=>t.split(",")[0]===e)}i=this.updateGoalCookieValueForExperience(i,t,s)}else e.goals[t].mca&&i&&(i=+i+1);yield od.createCookie(n,"_vis_opt_exp_"+e.id+"_goal_"+t,String(null!=i?i:1),100,e)}})}isGoalTriggered(e,t,n){var s,r;return i(this,void 0,void 0,function*(){if("TRACK"===e.type){return!(yield null===(r=(s=window.tracklib).shouldTriggerGoal)||void 0===r?void 0:r.call(s,e.id,t))}if(e.goals[t].mca)return null;if("INSIGHTS_METRIC"===e.type)return window.VWO._.insightsUtils.isMetircTriggered(e.id);const i=n.storages.storages.cookies.get("_vis_opt_exp_"+e.id+"_goal_"+t);if(e.mE){let t=n.storages.storages.cookies.get("_vis_opt_exp_"+e.id+"_combi");const s=od.isPersonalizeHoldback(e);return s&&(t=t.split(";")[0].split("|")),this.isGoalTriggeredForExperience(i,t,s)}return i})}clearTimeouts(e){return i(this,void 0,void 0,function*(){yield this.otherSide("clearTimeoutsHandler",[e]),delete e.timeout})}clearTimerAfterTimeout(e,t){return i(this,void 0,void 0,function*(){clearTimeout(e[ar]),e[ar]=setTimeout(()=>{this.clearTimeouts(e)},(yield t.vwoInternalProperties.SPA_ELEMENT_WAIT_TIMEOUT)||2e3)})}getTrackGoalIdFromExp(e,t){return Vs(t.settings.campaigns[e].goals)[0]}isExcluded(e,t){const i=window.tracklib;return"TRACK"===t.type?i.isGoalExcluded(this.getTrackGoalIdFromExp(t.id,e)):"FUNNEL"===t.type?i.isFunnelExcluded(t.id):"INSIGHTS_FUNNEL"===t.type?window.VWO._.insightsUtils.isFunnelExcluded(t.id):od.isAnalyzeCampaign(t.type)?i.isAnalyzeCampaignExcluded(t.id):!!e.storages.storages.cookies.get("_vis_opt_exp_"+t.id+"_exclude")}getCombi(e,t,n){return i(this,void 0,void 0,function*(){e=e||ba.phoenix.store.getters;const i=window.tracklib;if("TRACK"===t.type)return(null==i?void 0:i.isGoalIncluded)?yield i.isGoalIncluded(this.getTrackGoalIdFromExp(t.id,e)):void(n||(yield window.fetcher.getValue('VWO.push("${{1}}")',null,{captureGroups:[["track.delayedGoalConversion",{campaignId:t.id,type:"TRACK",goalId:this.getTrackGoalIdFromExp(t.id,e)}]]})));if("FUNNEL"===t.type)return(null==i?void 0:i.isFunnelIncluded)?yield i.isFunnelIncluded(t.id):void(n||(yield window.fetcher.getValue('VWO.push("${{1}}")',null,{captureGroups:[["track.delayedGoalConversion",{campaignId:t.id,type:"FUNNEL"}]]})));if("INSIGHTS_FUNNEL"===t.type)return yield window.VWO._.insightsUtils.isFunnelIncluded(t.id);if(od.hasInsightsMetric(t.type)){if(t.ready)return window.VWO._.insightsUtils.isVisBucketedForTrack()}else if(null==od?void 0:od.isAnalyzeCampaign(t.type))return i.isAnalyzeCampaignIncluded?yield i.isAnalyzeCampaignIncluded(t.id):void(n||(yield window.fetcher.getValue('VWO.push("${{1}}")',null,{captureGroups:[["track.delayedGoalConversion",{campaignId:t.id,type:t.type}]]})));return this.getCombiCookie(e,t.id)})}getCombiCookie(e,t){return i(this,void 0,void 0,function*(){return(e.visDebug||Do())&&(yield window.VWO._.previewDebuggerBooted),e.storages.storages.cookies.get("_vis_opt_exp_"+t+"_combi")})}getCombiCookieFromMT(e){return this.otherSide("getCombiCookie",[e])}exclude(e,t){return i(this,void 0,void 0,function*(){if("INSIGHTS_METRIC"===t.type)return;const i=window.tracklib;"TRACK"===t.type?yield i.excludeGoal(this.getTrackGoalIdFromExp(t.id,e)):"FUNNEL"===t.type?yield i.excludeFunnel(t.id):"INSIGHTS_FUNNEL"===t.type?yield window.VWO._.insightsUtils.excludeFunnel(t.id):od.isAnalyzeCampaign(t.type)?yield i.excludeAnalyzeCampaign(t.id):yield od.createCookie(e,"_vis_opt_exp_"+t.id+"_exclude","1",100,t)})}include(e,t,n,s){return i(this,void 0,void 0,function*(){if("INSIGHTS_METRIC"===s.type)return;let i=!1;const r=window.tracklib;if("TRACK"===s.type)yield r.includeGoal(this.getTrackGoalIdFromExp(s.id,e));else if("FUNNEL"===s.type)yield r.includeFunnel(t);else if("INSIGHTS_FUNNEL"===s.type)yield window.VWO._.insightsUtils.includeFunnel(t);else if(od.isAnalyzeCampaign(s.type))yield r.includeAnalyzeCampaign(t);else{if(od.isPersonalizeHoldback(s)&&s.mE){const t=e.storages.storages.cookies.get("_vis_opt_exp_"+s.id+"_combi"),i=n.split(",")[0];if(t&&n){const[e]=n.split(",");if(e){let i=[];const s=t.split(";");s.length>0&&(i=s[0].split("|"));const r=i.findIndex(t=>t.split(",")[0]===e);r>=0?i[r]=n:i.push(n),n=i.join("|")}}n+=`;${i}`}yield od.createCookie(e,"_vis_opt_exp_"+t+"_combi",n,100,s),i=!0}return{isCookieCreated:i}})}isLogged(e,t,i){if(i||!window.VWO._.allSettings.dataStore.campaigns[t].mE)return e.storages.storages.cookies.get("_vis_opt_exp_"+t+"_combi_choose")}isBucketed(e,t,n){return i(this,void 0,void 0,function*(){return!!(yield this.getCombi(e,t,n))})}shouldBucket(e,t){return i(this,void 0,void 0,function*(){const i=t.type,n=window.tracklib,s=void 0!==ba.data.pc[gd[i]];let r,o=t.pc_traffic;if(o=void 0===o?100:o,!o)return!1;this.campaignsInternalMap[t.id]&&this.campaignsInternalMap[t.id].r?r=this.campaignsInternalMap[t.id].r:(this.campaignsInternalMap[t.id]={},r=this.campaignsInternalMap[t.id].r=Sd.getRandom(e.vwoUUID,t.id));const a=od.isSessionBasedCampaign2(t)?yield ba._.sessionInfoService.getPcTraffic():100*r;let d=n.isFeatureBucketed&&Number(yield n.isFeatureBucketed(gd[i]));return od.hasInsightsMetric(i)&&(d=Number(yield window.VWO._.insightsUtils.isVisBucketedForTrack())),(!s||d)&&a<=o})}getTargetCombs(e){if(e.targetCombs)return e.targetCombs;const t=e.combs,i={1:0},n=Object.keys(t).filter(e=>"object"==typeof t[e]&&Object.keys(t[e]).length>0),s=n.length?1/n.length:0;return n.forEach(e=>i[e]=s),e.targetCombs=i,i}preProcessHoldbackCamp(e){e.targetChoosen?(e.combs=e.originalCombs[e.targetChoosen],e.originalTriggers=e.sections[1].triggers,e.sections[1].triggers=[],e.originalPriority=e.sections[1].priority,e.sections[1].priority=[]):(e.originalCombs=e.combs,e.combs=this.getTargetCombs(e))}chooseCombination(e,t,n){var s,r,o;return i(this,void 0,void 0,function*(){let i;if(Ua.isVisitorOptedOut())return;const a=t&&t.id&&(t.combination_chosen||t.cc);if(t&&od.isPersonalizeCampaign(t)){if(a&&"0"!==a&&!t.debug)return a;if(od.isPersonalizeHoldback(t)&&a&&"0"!==a&&t.debug)return a}else if(a&&"0"!==a)return a;if(window.chooseCombinationPersonalisation&&window.vwoPersonalisationCampaigns&&window.vwoPersonalisationCampaigns.indexOf&&-1!==window.vwoPersonalisationCampaigns.indexOf(+t.id)&&(i=window.chooseCombinationPersonalisation(t.id),0!=i)){return""+(parseInt(i.split(":")[1],10)+1)}if(t&&!t.debug&&od.isPersonalizeHoldback(t)&&this.preProcessHoldbackCamp(t),t&&"SPLIT_URL"===t.type&&t.cSel)return t.cSel;const d=wd(),l=n&&n.scaleInfo||t.combs,c={},u={};let g,h,v,p=Sd.getRandomForVariation(null===(s=this.campaignsInternalMap[null==t?void 0:t.id])||void 0===s?void 0:s.r,null==t?void 0:t.pc_traffic),w=d?Vs(l).sort():Vs(l),E=w.length,f=0,_=!1,m=!1;for(Jr()&&od.isPersonalizeCampaign(t)&&(yield window.VWO._.syncEventsCallCompleted),v=0;v<E;v++){i=w[v];const s=n?i:t.id;if(h=e.settings.campaigns[s].type,!isNaN(parseFloat(l[i]))&&0!=l[i])if("VISUAL_AB"===h||"SPLIT_URL"===h){g=n?n.segmentInfo:t.sections[1].triggers;const s=g[i];0===g.length||!1===(null===(r=e.currentSettings.triggers[s])||void 0===r?void 0:r.cnds[0])?(m=!0,u[i]=l[i]):(n?yield window.VWO.phoenix.validateTrigger(e.currentSettings.triggers[g[i]],null,{skipEventProps:!0,skipValidationIfTimer:!0}):!Jr()&&e.triggers[s]&&"boolean"==typeof e.triggers[s].state?e.triggers[s].state:yield window.VWO.phoenix.validateTrigger(e.currentSettings.triggers[s],Jr()?{useUnsavedEvents:!0}:null))&&(1!=g[i]&&(_=!0),c[i]=f+l[i],f+=l[i])}else c[i]=f+l[i],f+=l[i]}if(!_&&m)for(w=Vs(u),E=w.length,v=0;v<E;v++)i=w[v],c[i]=f+u[i],f+=u[i];let O=-1;const S=null===(o=null==t?void 0:t.sections[1])||void 0===o?void 0:o.priority;if(S)for(E=S.length,v=0;v<E;v++)if(c[S[v]]){O=v;break}if(O>=0){const i=S[O]+"";return t&&!t.debug&&od.isPersonalizeHoldback(t)?yield this.chooseExperienceCombination(e,t,i):i}for(0<f&&1!==f&&(p*=f),w=d?Vs(c).sort():Vs(c),E=w.length,v=0;v<E;v++)if(i=w[v],!isNaN(parseFloat(l[i]))&&p<=c[i])return t&&!t.debug&&od.isPersonalizeHoldback(t)&&!t.targetChoosen?yield this.chooseExperienceCombination(e,t,i):i})}chooseExperienceCombination(e,t,n){return i(this,void 0,void 0,function*(){let i;if(!t.targetChoosen){if(t.targetChoosen=n,t.mE){const i=e.storages.storages.cookies.get("_vis_opt_exp_"+t.id+"_combi");let n=null;if(i){const e=i.split(";")[0].split("|");for(const i of e){const[e,s]=i.split(",");if(e===t.targetChoosen){n=s;break}}if(n){const e=R(()=>t.originalCombs[t.targetChoosen][n]);if("number"==typeof e&&e>0)return`${t.targetChoosen},${n}`}}}i=yield this.chooseCombination(e,t),t.sections[1].triggers&&(t.sections[1].triggers=t.originalTriggers,delete t.originalTriggers),t.sections[1].priority&&(t.sections[1].priority=t.originalPriority,delete t.originalPriority),i=`${t.targetChoosen},${i}`}return i})}getGroupBasedCampaigns({getters:e}){var t,i;let n=[],s=null===(i=null===(t=e.settings.vwoData)||void 0===t?void 0:t.gC)||void 0===i?void 0:i.map(e=>e.c);s=s||[];for(const e of s)n=n.concat(e);return n.map(e=>""+e)}firePatternMatchingEvent(e,t,i,n,s,r){if(1===i)e.trigger(m.EXCLUDE_URL,{oldArgs:[t]});else{const i=e.trigger(m.MATCH_WILDCARD,{oldArgs:[t,n,s,r]});window._vis_debug&&i.then(()=>{window.VWO._.phoenixMT.trigger("vwo_previewReady")})}}doExperimentHere(e,t,i,n={}){let s;if(t.pg_config){let n=!1,r=null;for(const s of t.pg_config){const o=i.pageGroup.validatePage(s,null,e.currentUrl,{data:{campId:t.id,pgGrpId:s}});o.didMatch&&(n=!0,r=o.reason,o.hadNonTagMatch&&window.fetcher.getValue('VWO._.phoenixMT.triggerForBothSides("${{1}}", "${{2}}")',null,{captureGroups:[m.PAGE_MATCHED,{id:s}]})),r||(r=o.reason)}s={didMatch:n,reason:r}}else s=ia.compareUrlWithIncludeExcludeRegex(e.currentUrl,n.urlRegex||t.urlRegex,n.excludeUrl||t.exclude_url,n.urlPattern||t.url_pattern);return[s.didMatch,s.reason]}executeCampaignJS(e,t){const i=e.id,n=e.combination_chosen||e.cc,s=`${t}Executed`;if(e.globalCode[t]&&!e.globalCode[s])try{let{nonce:r=""}=window.VWO;r&&(r=`nonce=${r}`),window.VWO.phoenix.settings.currentSettings.tags[e.globalCode[t]].fn(i,n,r),e.globalCode[s]=!0}catch(e){}}}const Td=new yd;window.VWO.modules.utils.campaignUtils=Td;class Cd{otherSide(...e){e[0]="VWO.modules.tags.checkEnvironment.utils."+e[0],window.fetcher.getValue(...e)}}class Id extends Cd{checkCookieJarMismatch({getters:e,vwoEvents:t}){const i=e.storages.storages,n=i.localStorageService,s=i.cookies;let r;!(r=s.get(zs.COOKIE_JAR,!0))&&!(r=n.get(zs.COOKIE_JAR))||e.vwoInternalProperties.jar||(s.create(zs.COOKIE_JAR,r,!1),n.remove(zs.COOKIE_JAR),t.trigger(m.ERROR,{error:`_vwo(value = ${r}) cookie found but Cookie jar is not created. Deleting it.`}))}checkForTimeout({getters:e,actions:t,vwoEvents:i}){if(e.vwoCode&&window.vwoCodeEndBeforeVA&&!e.vwoCode[er]){i.trigger(m.SHOULD_EXECUTE_LIB_ERROR,{message:"SSM cookie found",oldArgs:[null,void 0,void 0,void 0,!0]});const e=[{[Zs]:1,destinationMT:"window._vwo_code.lT"}];od.setPropertiesToBothThreads(t,e,"vwoCode")}}addDomListenerForTimeout(e){this.otherSide('addDomReadyListener("${{1}}")',null,{captureGroups:[function(){window.VWO.phoenix.store.getters.vwoInternalProperties.willRedirectionOccur||window.fetcher.getValue("window._removeVwoGlobalStyle");for(const t in window.VWO.phoenix.store.getters.settings.campaigns){const i=window.VWO.phoenix.store.getters.settings.campaigns[t];i&&"object"==typeof i&&(i.dontKillTimer?Td.clearTimerAfterTimeout(i,e):setTimeout(()=>{Td.clearTimeouts(i)},500))}window.VWO._.coreLib.finished=1,window.vwo_libExecuted=!0,window.fetcher.setValue("vwo_libExecuted",!0)}]})}}var Nd=new Id;class Ad{migrateCookiesToSSM({getters:e}){const t=Js(),i=e.storages.storages.cookies,n=i.getAll(),s=V(zs.SAME_SITE);if(e.vwoInternalProperties.ss&&!n[s]){const e=V(Ks+zs.UUID_V2);for(const s in n){if(s===e){if(qr)continue;i.create(s,"",-1,void 0,void 0,!0,!0)}const r=s.indexOf(Bs)>=0||s.indexOf(Ks)>=0;r&&(Object.prototype.hasOwnProperty.call(t,s)?i.create(s,decodeURIComponent(n[s]),t[s],void 0,void 0,!0):i.create(s,decodeURIComponent(n[s]),zs.DEFAULT_EXPIRY,void 0,void 0,!0))}i.create(zs.SAME_SITE,1,t[zs.SAME_SITE],void 0,void 0,!0)}}mergeThirdPartyCookiesInFirstPartyJar({getters:e,vwoEvents:t}){e.settings.vwoData.tpc&&e.settings.vwoData.tpc._vwo&&(e.vwoInternalProperties.jar?e.storages.storages.cookies.mergeInFPJar():t.trigger(m.ERROR,{data:`TPC._vwo (value = ${e.settings.vwoData.tpc._vwo}) value found but cookie jar not available. Value of CJ is ${e.settings.vwoData.cj}.`}))}setListenerForCustomAndDomEvents({vwoEvents:e,getters:t,data:i,actions:n}){od.addListener(t,e,{eventName:"*"},(s,r)=>{s.name=s.name||r,Sa({vwoEvents:e,getters:t,data:i,actions:n,event:s},r)})}}var Vd=new Ad;function bd({event:e,data:t,getters:i,actions:n,vwoEvents:s}){var r;if(qs(!1,function(){s.trigger("hashchange")}),Ua.shouldWeTrackVisitor()){const e=i.storages.get("cookies");if(!e.get("_vis_opt_test_cookie")){const t=e.get("_vis_opt_s");t?e.create("_vis_opt_s",parseInt(t.split("|")[0],10)+1+"|",100):e.create("_vis_opt_s","1|",100)}"ls"!==(null===(r=window.VWO.data.cj)||void 0===r?void 0:r.s)&&e.create("_vis_opt_test_cookie",1)}Vd.migrateCookiesToSSM({event:e,data:t,getters:i,actions:n,vwoEvents:s}),Vd.mergeThirdPartyCookiesInFirstPartyJar({event:e,data:t,getters:i,actions:n,vwoEvents:s}),Vd.setListenerForCustomAndDomEvents({event:e,data:t,getters:i,actions:n,vwoEvents:s});const o=Object.keys(i.settings.campaigns);od.setCampaignIds(o);od.setPropertiesToBothThreads(n,[{willRedirectionOccur:!1,destinationMT:"VWO._.willRedirectionOccur"}],"vwoInternalProperties"),n.addValues({waitingForThirdPartySync:!1},"vwoInternalProperties")}class Rd{otherSide(...e){return e[0]="VWO.modules.tags.setSession."+e[0],window.fetcher.getValue(...e)}}class Pd{otherSide(...e){return e[0]="VWO.modules.tags.sessionInfoService."+e[0],e[2]&&(e[2]={captureGroups:e[2]}),window.fetcher.getValue(...e)}}let Dd;Pd.LOCAL_STORAGE_SESSION_EXPIRY=30,Pd.LOCAL_STORAGE_NAME=window._vis_debug?"debug_vwoSn":"vwoSn",Pd.ACCOUNT_ID=window._vwo_acc_id;class xd extends Pd{constructor(e,t){super(),Dd=this,this.visitorInformation=window.VWO.data.vi=window.VWO.data.vi||{},od.addListener(e,t,{eventName:m.NEW_SESSION},function(){return i(this,void 0,void 0,function*(){yield Dd.otherSide("eraseSessionCookie()",null,[])})}),od.addListener(e,t,{eventName:m.REDIRECT_DECISION},function(t){return i(this,void 0,void 0,function*(){const i=e.allSettings.dataStore.campaigns[t.oldArgs[1]];od.isSessionBasedCampaign2(i)&&(yield Dd.otherSide("markPageIdSessionExpiry()"))})})}getSessionId(){return this.otherSide("getSessionId()")}shouldSendSessionInfoInCall(){return!0}setSNCookieValueByIndex2(e,t){return this.otherSide("setSNCookieValueByIndex2",[e,t])}getPcTraffic(){return this.otherSide("getPcTraffic()")}setPageIdValue(e){window.phoenix.store.actions.addValues({pageId:e},"vwoInternalProperties"),window.phoenix.store.actions.addValues({pageViewCount:e},"root")}}class Ld extends Rd{execute({getters:e,actions:t,vwoEvents:i}){let n;window.VWO.modules.tags.sessionInfoService?n=window.VWO.modules.tags.sessionInfoService:(n=new xd(e,i),window.VWO.modules.tags.sessionInfoService=n,t.addValues({sessionInfoService:n},"vwoInternalProperties"))}}const Ud=new Ld,Wd=Ud.execute.bind(Ud);window.VWO.modules.tags.setSession=Wd;class Md extends cd{constructor(){super(...arguments),this.checkEnvironmentInitialized=!1}execute({event:e,data:t,getters:n,actions:s,vwoEvents:r}){return i(this,void 0,void 0,function*(){if(!this.checkEnvironmentInitialized)if(this.checkEnvironmentInitialized=!0,Wd({event:e,data:t,getters:n,actions:s,vwoEvents:r}),bd({event:e,data:t,getters:n,actions:s,vwoEvents:r}),od.shouldExecuteLib({event:e,data:t,getters:n,actions:s,vwoEvents:r}),Nd.checkCookieJarMismatch({event:e,data:t,getters:n,actions:s,vwoEvents:r}),Nd.checkForTimeout({event:e,data:t,getters:n,actions:s,vwoEvents:r}),Nd.addDomListenerForTimeout(n),n.vwoInternalProperties.shouldExecuteLib){if(window._vis_debug||window._vis_heatmap){const e=n.vwoInternalProperties.experimentIds,t=xo(e);yield r.trigger(m.CAMPAIGN_FLOW_START,{oldArgs:[t]})}r.on(m.RUN_REVERT_TAGS,()=>{window.VWO._.phoenixMT.trigger(m.RUN_REVERT_TAGS)}),yield od.firePageViewEvent(),window.VWO._.phoenixMT.trigger(m.LOAD_SETTINGS),r.trigger(m.UPDATE_SETTINGS_CALL)}else window.fetcher.getValue("window._removeVwoGlobalStyle")})}}const kd=new Md,Gd=kd.execute.bind(kd);window.VWO.modules.tags.checkEnvironment.fn=kd;const Fd=function(...e){return e[0]="VWO.modules.tags.visibilityService."+e[0],window.fetcher.getValue(...e)};let Hd=!1;function jd({getters:e,vwoEvents:t}){Hd||(od.addListener(e,t,{eventName:m.UNHIDE_ELEMENT},function(e){const{ruleName:t,campaignData:i,variation:n,rulesArr:s}=e;let r;i&&(r={id:i.id,variation:n}),window.fetcher.getValue("VWO.modules.utils.libUtils.delCSSWrapper",[{ruleName:t,campaignData:r,rulesArr:s}])}),Hd=!0)}function $d({vwoEvents:e},t){var i,n,s,r,o,a,d,l,c=Vs(t.sections),u=c.length,g=t.type;if("VISUAL_AB"===g)for(;u--;)if(i=c[u],(n=t.sections[i]).variations)for(r=(s=Vs(n.variations)).length,e.trigger(m.UNHIDE_SECTION,{id:t.id,key:i},i);r--;)if(o=s[r],d=n.variations[o],n.variations[o]=d="string"==typeof d?d&&vwo_$.parseJSON(d):d,d)for(a=d.length,e.trigger(m.UNHIDE_VARIATION,{id:t.id,key:i});a--;){const i={ruleName:"",campaignData:t,rulesArr:[]};l=d[a].xpath,d[a].cpath?i.rulesArr=[l,d[a].cpath]:i.ruleName=l,Ca.unhideElement(e,i)}else e.trigger(m.UNHIDE_VARIATION,{id:t.id,key:i},i);else e.trigger(m.UNHIDE_SECTION,{id:t.id,key:i});else if("VISUAL"===g)for(;u--;)i=c[u],l=t.sections[i].path,Ca.unhideElement(e,{ruleName:l,campaignData:t});else"SPLIT_URL"===g&&Ca.unhideElement(e,{ruleName:"*",campaignData:t})}function Bd({event:e,data:t,getters:i,actions:n,vwoEvents:s},r){const o=[],a=i.settings.campaigns;for(const d in a){const l=a[d],c=l.sen,u=R(()=>l.sections[1])||{},g=u.sen;if(Object.prototype.hasOwnProperty.call(a,d)){if(c&&!od.doNotHideElements(c)){const l=od.addListener(i,s,{triggerID:c},()=>{$d({event:e,data:t,getters:i,actions:n,vwoEvents:s},a[d]),s.trigger(m.CHECK_SEGMENTATION,r)});l&&o.push(l)}if(g){const e=u.variations;for(const t in e){const n=e[t],r=g[t];n&&!od.doNotHideElements(r)&&od.addListener(i,s,{triggerID:r},()=>{for(const e of n){const i=e.xpath,n={ruleName:"",campaignData:l,variation:t};e.cpath?n.rulesArr=[i,e.cpath]:n.ruleName=i,s.trigger(m.UNHIDE_ELEMENT,n)}})}}}}return o}function Kd({vwoEvents:e},t,i){return t.forEach(t=>{e.off.apply(t)}),Fd("unhideElementsAfterTimer",[i])}class zd{modifyTriggerConditions(e,t){const i=[];return Array.isArray(e)?(e.forEach(e=>{if(Array.isArray(e))i.push(this.modifyTriggerConditions(e,t));else{const n=t(e);i.push(n)}}),i):e}getExitTrigger(e){for(let t=0;t<e.length;t++){if(Array.isArray(e[t])){const i=this.getExitTrigger(e[t]);if(i)return i}if("object"==typeof e[t]&&null!==e[t]&&e[t].exitTrigger)return e[t].exitTrigger}}}var Yd=new zd;let Jd=[];const Xd={state:{}};function qd({getters:e,vwoEvents:t,campaignData:i}){if(od.isDomDependent(i.type)&&"VISUAL"!==i.type&&Td.getCombi(e,i))return t.trigger(m.CAMPAIGN_UNLOADED,{expId:i.id})}function Qd({getters:e,expId:t,combination:i}){try{const n=window._vwo_exp[t];if(!od.isDomDependent(n.type)||"VISUAL"===n.type)return;const s=R(()=>n.sections[1].variations[i])||[],r=t=>!(!e.triggers[t]||!e.triggers[t].state);for(let e=0;e<s.length;e++){const t=s[e].t;t&&(Xd.state[t]=r(t))}window.fetcher.getValue('window.VWO.modules.utils.tagExecutor.updateTriggerStates("${{1}}")',null,{captureGroups:[Xd.state]})}catch(e){}}function Zd(){Jd.forEach(e=>e()),Jd=[]}function el(e){window.VWO.phoenix.trigger(m.TAG_EVALUATED,{tG:{[e]:!0}})}function tl(e,t,{isWaitForElementEvent:i,campId:n,preventCallBackRemovalOnSpa:s,isCampUnloadEvent:o,preventCallBackRemoval:a}){const d=window.VWO.phoenix,l=window.VWO.phoenix.store.getters,c=`trigger.${e}`;if(u=e,l.triggers[u]&&l.triggers[u].state&&!o)return t(c);var u;d.on(c,function(){try{t(c)}catch(e){r({msg:`Error occurred while executing "${c}" trigger`,url:"triggerBasedTagExecutorWT.ts",source:e})}a||d.removeEvent(c)}),s||Jd.push(function(){d.removeEvent(c)}),i&&(d.trigger(m.HTML_ELEMENT_LOADED,{expId:n}),d.trigger(m.HTML_ELEMENT_HYDRATED,{expId:n}))}var il;window.VWO.modules.utils.tagExecutor={attachTriggerListenersForTagExecution:tl,fireTagEvaluatedEvent:el},function(e){e[e.PAGE_LOAD=0]="PAGE_LOAD",e[e.URL_CHANGE=1]="URL_CHANGE"}(il||(il={}));const nl=function(e){return window.VWO.phoenix.validateTrigger(e,null,{skipEventProps:!0})},sl=function({event:e,data:t,getters:n,actions:s,vwoEvents:r}){return i(this,void 0,void 0,function*(){if(n.vwoCode&&(n.vwoCode[Zs]||n.vwoCode[er]))return r.trigger(m.VISIBILITY_TRIGGERED),void r.trigger(m.NOT_REDIRECTING);const o=[],{visibilityServiceCache:a}=window.VWO._,d=window.VWO.appliedCampaigns||{};if(window.VWO._.auxPageViewFired)return;const l=n.settings.campaigns;let c=!1;const u={hideElementsTriggered:!1,segmentCndsSatisfied:void 0},g=[],h=Td.getGroupBasedCampaigns({event:e,data:t,getters:n,actions:s,vwoEvents:r});yield Promise.all(Object.keys(l).map(t=>i(this,void 0,void 0,function*(){var i,v,p,w,E;const f=l[t],_=l[t].type;if("FUNNEL"===_||f.ready||f.isExcluded||W.isCampBlocked(f))return;const O=null===(i=f.triggers)||void 0===i?void 0:i[0],S=O&&r.settings.currentSettings.triggers[O];let y;const T="SPLIT_URL"===_,C="SURVEY"===_,I=null!==(p=null===(v=null==a?void 0:a[t])||void 0===v?void 0:v.dEH)&&void 0!==p?p:null!==(E=null===(w=null==e?void 0:e._vwo)||void 0===w?void 0:w.doExperimentHere)&&void 0!==E?E:Td.doExperimentHere(n,f,r)[0],N=yield R(()=>Td.getCombiCookie(n,+t));if(f.exec=!!N,C&&I&&!window.VWO._.allSettings.dataStore.previewExtraSettings&&(window.VWO.phoenix.trigger(m.LOAD_SURVEY_LIB),window.fetcher.setValue("window.VWO._.shouldLoadSurveyLib",!0)),T&&I&&(c=!0,S&&(mo&&!f.meg||(y=yield nl(S)))&&g.push(t)),!I)return(Do()||window._vis_debug)&&S&&((null!=y?y:yield sd(S))||(u.segmentCndsSatisfied=!1,r.trigger(m.CHECK_SEGMENTATION,u))),qd({getters:n,vwoEvents:r,campaignData:f}),void(f.isApplicable=0);o.push(t);const A=-1===h.indexOf(t)||h.indexOf(t)>=0&&f.shouldHideElement,V=Kr(t),b=T&&!V?window.VWO._.bodyPath:void 0,P=S&&(null!=y?y:yield sd(S)),D=A&&!f.manual;if(P&&D?f.isApplicable=1:lo()&&(f.isApplicable=0),!f.eHIR&&f.cA&&f.isApplicable)return;if(P){if(u.segmentCndsSatisfied=!0,D?("DEPLOY"===f.type&&(f.orgType=f.type,f.type="VISUAL_AB"),d[t]||(d[t]=!0,yield od.setXpathAndHideEl(f,n,b)),T||(r.trigger(m.HIDE_ELEMENTS,{oldArgs:[f.id,f.cc]}),u.hideElementsTriggered=!0)):yield od.setXpathAndHideEl(f,n,b,!1),f.ss&&f.ss.csa){const e="trigger."+hr,t=r.on(e,()=>{const i=window.VWO.phoenix.store.getters.triggers;i[O]&&!i[O].state&&qd({getters:n,vwoEvents:r,campaignData:f}),r.off(e,t)})}}else qd({getters:n,vwoEvents:r,campaignData:f}),u.segmentCndsSatisfied=!1,r.trigger(m.CHECK_SEGMENTATION,u);const x=Yd.getExitTrigger(S.cnds);S&&x&&!T&&od.addListener(n,r,{triggerID:x},()=>{f.ready||("SPLIT_URL"===_&&r.trigger(m.NOT_REDIRECTING),$d({event:e,data:f,getters:n,actions:s,vwoEvents:r},f),r.trigger(m.CHECK_SEGMENTATION,u))})}))),c&&0!==g.length||r.trigger(m.NOT_REDIRECTING);const v=[{executableCampaignsOnCurrentPage:o,destinationMT:"window.VWO._.executableCampaignsOnCurrentPage"}];od.setPropertiesToBothThreads(s,v,"vwoInternalProperties"),window.fetcher.getValue("VWO.modules.utils.libUtils.delCSS",[{ruleName:"*",campaignData:t}]),jd({event:e,data:t,getters:n,actions:s,vwoEvents:r});const p=Bd({event:e,data:t,getters:n,actions:s,vwoEvents:r},u);Kd({event:e,data:t,getters:n,actions:s,vwoEvents:r},p,u),window.VWO._.libState===il.URL_CHANGE&&r.trigger(m.RUN_REVERT_TAGS),r.trigger(m.VISIBILITY_TRIGGERED),window.fetcher.getValue("VWO.modules.utils.textBasedSelectorUtils.disconnectMutationObserver")})};class rl{}class ol{}const al=e=>window.fetcher.getValue("window.VWO.modules.utils.sessionHandler.fireCompleteStalledEvent",e),dl=()=>window.fetcher.getValue("window.VWO.modules.utils.sessionHandler.shouldStallSessionCall");class ll extends ol{constructor(){super(...arguments),this.preview=Do,this.noopFn=function(){}}isTimedOut(e){return e.vwoCode&&(e.vwoCode[Zs]||e.vwoCode[er])}unhideElForCombinationsToNotUse(e,t,i,n){if("VISUAL_AB"!==i.type)return;od.isPersonalizeCampaign(i)&&od.unhideCampaignLevelStyle(i.id);const s=i.sections[1].variations,r=xs(s);for(let e=0;e<r.length;e++)if(r[e]!==t){let t=s[r[e]];if("object"!=typeof t&&(t=JSON.parse(t)),!t)continue;for(let s=0;s<t.length;s++){const o=t[s].xpath,a={ruleName:"",campaignData:i,variation:od.isPersonalizeCampaign(i)?r[e]:null};t[s].cpath?a.rulesArr=[o,t[s].cpath]:a.ruleName=o,Ca.unhideElement(n,a,t[s].dHE)}}}unhideVariationIfNotSplit(e,t,i){"SPLIT_URL"!==t.type&&this.unhideVariation(e,t,i)}unhideVariation(e,t,i){const n=xs(t.sections);let s,r,o,a,d,l,c,u,g=n.length;const h=t.type;if("VISUAL_AB"===h)for(;g--;)if(s=n[g],r=t.sections[s],r.variations)for(o=xs(r.variations),a=o.length,i.trigger(m.UNHIDE_SECTION,{oldArgs:[t.id,s,!a]});a--;)if(d=o[a],c=r.variations[d],r.variations[d]=c="string"==typeof c?c&&JSON.parse(c):c,c)for(l=c.length,i.trigger(m.UNHIDE_VARIATION,{oldArgs:[t.id,s,d,!l]});l--;){u=c[l].xpath;const e={ruleName:"",campaignData:t,key:s,oldArgs:[t.id,s,d,u]};c[l].cpath?e.rulesArr=[u,c[l].cpath]:e.ruleName=u,Ca.unhideElement(i,e,c[l].dHE)}else i.trigger(m.UNHIDE_VARIATION,{oldArgs:[t.id,s,d,!c]});else i.trigger(m.UNHIDE_SECTION,{oldArgs:[t.id,s,!0]});else if("VISUAL"===h)for(;g--;)s=n[g],u=t.sections[s].path,i.trigger(m.UNHIDE_ELEMENT,{ruleName:u,campaignData:t,key:s,oldArgs:[t.id,s,void 0,u]});else"SPLIT_URL"===h&&(i.trigger(m.UNHIDE_ELEMENT,{ruleName:"*",campaignData:t,oldArgs:[t.id,void 0,void 0,"*"]}),i.trigger(m.UNHIDE_ELEMENT,{ruleName:"body",campaignData:t,oldArgs:[t.id,void 0,void 0,"body"]}))}isSplit(e,t,n){return i(this,void 0,void 0,function*(){if("SPLIT_URL"===t.type&&("RUNNING"===t.status||this.preview()||window._vis_debug)){let i;const s=yield od.getSplitDecision(e,t);if(!s)return!1;if(od.isCurrentURLSplitVariation({chosenVariation:s,getters:e,campaignData:t}))return i=yield Td.getCombi(e,t),t.combination_chosen=s,t[tr]=1,n.trigger(m.CHOOSE_COMBINATION,{oldArgs:[t.id,s,!0]}),i||this.preview()?this.preview()||(n.trigger(m.SPLIT_VARIATION_SHOWN,{oldArgs:[""+t.id,i]}),ya(n,m.CAMPAIGN_READY,{id:t.id,combination:i})):(i=s,t&&void 0===t.isFirst&&(t.isFirst=1),t.trackVisitor&&(yield this.sendSplitVariationShown(n,t,t.isFirst),yield this.recordVisitor(e,i,t,!0,n)),yield Td.include(e,t.id,i,t),t.trackVisitor||(n.trigger(m.REGISTER_HIT,{oldArgs:[""+t.id,i]}),ya(n,m.CAMPAIGN_READY,{id:t.id,combination:i})),delete t.trackVisitor),this.currentUrlValidationForSplitFromLs(t.id)&&(n.trigger(m.VARIATION_SHOWN_SENT,{oldArgs:[""+t.id,i]}),window.VWO._.phoenixMT.trigger(m.VARIATION_SHOWN_SENT,t.id)),window.fetcher.getValue("VWO.modules.utils.collectAndSendDataForGA",[t.id,i]),!0}return!1})}sendSplitVariationShown(e,t,n){return i(this,void 0,void 0,function*(){const i=yield od.isBotScreen();yield Ca.variationShown(e,Object.assign(Object.assign({id:t.id,variation:t.combination_chosen,isFirst:n,isSplitVariation:"1"!==t.combination_chosen},i&&{vwoMeta:{isBot:i}}),{fireLinkedTagSync:"FUNNEL"===t.type}),t)})}currentUrlValidationForSplitFromLs(e){var t;const i=JSON.parse(window.localStorage.getItem(lr.VS_DATA));return(null===(t=null==i?void 0:i[e])||void 0===t?void 0:t.u)===window.location.href}checkSplitVariationAndMarkReady(e,t,n){return i(this,void 0,void 0,function*(){if(yield this.isSplit(e,t,n))return n.trigger(m.NOT_REDIRECTING),Ca.unhideElement(n,{ruleName:"*",campaignData:t,oldArgs:[t.id,void 0,void 0,"*"]}),this.unhideVariationIfNotSplit(e,t,n),t.ready=!0,!0})}getCombination(e,t,n){return i(this,void 0,void 0,function*(){let i=!1,s=this.preview()||(t.mE?void 0:yield Td.getCombi(e,t));return(s||t.combination_chosen)&&(i=!0),s=s||Td.isLogged(e,t.id)||!n&&(yield Td.chooseCombination(e,t)),{alreadyChosen:i,combi:s}})}registerHit(e,t,n,s,r,o,a){return i(this,void 0,void 0,function*(){if(o=o||this.noopFn,!n.mE&&(yield Td.isBucketed(e,n))||od.isBot2()||!od.shouldTrackUserForCampaign(n))return o(a);if("TRACK"===n.type){var i=Td.getTrackGoalIdFromExp(n.id,e);yield window.fetcher.getValue('VWO.push("${{1}}", "${{2}}")',null,{captureGroups:[["tag",n.id,t,"session",!0],["tag",i,null,"eg"]]})}else"INSIGHTS_FUNNEL"===n.type&&(yield window.fetcher.getValue('VWO.push("${{1}}")',null,{captureGroups:[["tag",`${n.id}`,null,"fIds"]]}));s.trigger(m.SEND_NEW_VISITOR_CALL,{combination:t,campaignData:n,function(){}}),yield fa({getters:e,event:{time:+new Date,name:m.REGISTER_HIT,props:{id:""+n.id,combination:t}},actions:{},vwoEvents:{},data:{}},n,o,a),r||s.trigger(m.REGISTER_HIT,{oldArgs:[""+n.id,t,!!od.isPersonalizeHoldback(n)]}),ya(s,m.CAMPAIGN_READY,{id:n.id,combination:t})})}createTempCombiCookie(e,t,n){return i(this,void 0,void 0,function*(){yield od.createCookie(e,"_vis_opt_exp_"+t.id+"_combi_choose",n,100,t)})}recordVisitor(e,t,n,s,r){return i(this,void 0,void 0,function*(){if(!t)return;const i=n.type;s&&!(yield Td.isLogged(e,n.id))?(yield this.registerHit(e,t,n,r),od.isDomDependent(i)&&(yield this.createTempCombiCookie(e,n,t))):ya(r,m.CAMPAIGN_READY,{id:n.id,combination:t}),window.fetcher.getValue("VWO.modules.utils.collectAndSendDataForGA",[n.id,t])})}deleteCampaignParams(e){delete e.ready,delete e.timedout,delete e[tr]}setMutsData(e){e.muts=e.muts||{},e.muts.pre=e.muts.pre||{},e.muts.post=e.muts.post||{},e.muts.pre.enabled&&(e.manual=!0)}handleDeployCampaign(e){"DEPLOY"===e.type&&(e.orgType=e.type,e.type="VISUAL_AB")}handlePCTraffic(e){e.pc_traffic=void 0===e.pc_traffic?100:e.pc_traffic}checkAlreadyChosenForMultiExperience(e,t,n){return i(this,void 0,void 0,function*(){if(t.mE){const i=(yield Td.getCombi(e,t))||Td.isLogged(e,t.id,!0);return n==i}})}preProcessCampaignData({data:e}){this.setMutsData(e),this.handleDeployCampaign(e),this.handlePCTraffic(e),e.globalCode=e.globalCode||{},e.goals||(e.goals={}),od.isDomIndependentCampaign(e.type)&&(e.clickmap=0),"FUNNEL"===e.type?(e.g=e.g||e.goals,e.goals={},e.segment_code=void 0===e.segment_code?"true":e.segment_code,e.manual=!0,e.v=e.v||1):e.manual=!!e.manual}resetHoldbacksParams(e){e.originalTriggers&&(e.sections[1].triggers=e.originalTriggers,delete e.originalTriggers),e.originalPriority&&(e.sections[1].priority=e.originalPriority,delete e.originalPriority),e.originalCombs&&(e.combs=e.originalCombs,delete e.originalCombs),delete e.targetChoosen}computeAndValidateCustomRedirectUrl(e,t,{getters:n}){return i(this,void 0,void 0,function*(){return yield window.fetcher.getValue('window.VWO._.computeAndValidateCustomRedirectUrl("${{1}}", "${{2}}", "${{3}}")',[],{captureGroups:[e,t,{getters:{currentUrl:n.currentUrl}}]})})}processCampaign({data:e,event:t,actions:n,getters:s,vwoEvents:r,executingTagTrigger:o}){var a,d;return i(this,void 0,void 0,function*(){let i,l;const c="SPLIT_URL"===e.type;if(!this.preview()&&(yield Td.isExcluded(s,e))&&!od.isSessionBasedCampaign2(e))return r.trigger(m.UNHIDE_ALL_VARIATIONS,{oldArgs:[e.id,!0,!0]}),c&&(r.trigger(m.NOT_REDIRECTING),Ca.unhideElement(r,{ruleName:"*",campaignData:e})),void this.unhideVariationIfNotSplit(s,e,r);if(this.deleteCampaignParams(e),c&&(yield this.checkSplitVariationAndMarkReady(s,e,r)))return void r.trigger(m.UNHIDE_ALL_VARIATIONS,{oldArgs:[e.id,void 0,void 0,!0]});if(!od.shouldTrackUserForCampaign(e))return e.timedout=!0,c&&(r.trigger(m.NOT_REDIRECTING),Ca.unhideElement(r,{ruleName:"*",campaignData:e})),void this.unhideVariation(s,e,r);const u=Td.doExperimentHere(s,e,r)[0];if(u){const t=(od.isPersonalizeCampaign(e)&&e.sections[1].triggers[null===(a=e.debug)||void 0===a?void 0:a.v])===o,d=!!od.isPersonalizeHoldback(e);if(d||r.trigger(m.SEGMENTATION_EVALUATED,{oldArgs:[e.id,u,t,!0]}),od.isDomDependent(e.type)&&(i=yield this.getCombination(s,e,!0),l=i.alreadyChosen,i.combi&&(e.cc=i.combi)),!this.preview()&&!(yield Td.isBucketed(s,e))&&!(yield Td.shouldBucket(s,e)))return r.trigger(m.UNHIDE_ALL_VARIATIONS,{oldArgs:[e.id,!0,void 0,void 0,!0]}),yield Td.exclude(s,e),"SPLIT_URL"===e.type&&(r.trigger(m.NOT_REDIRECTING),Ca.unhideElement(r,{ruleName:"*",campaignData:e})),void this.unhideVariationIfNotSplit(s,e,r);if(od.shouldTrackUserForCampaign(e)?(e.ready=!0,od.setCampaignAppliedFlag(e,!0)):e.timedout=!0,c)if(this.isTimedOut(s))r.trigger(m.NOT_REDIRECTING),Ca.unhideElement(r,{ruleName:"*",campaignData:e});else{al(),i=yield this.getCombination(s,e),l=i.alreadyChosen;const t=e.combination_chosen=i.combi,o=[{willRedirectionOccur:!0,destinationMT:"VWO._.willRedirectionOccur"}];if("1"!==e.combination_chosen&&od.setPropertiesToBothThreads(n,o,"vwoInternalProperties"),Td.executeCampaignJS(e,"pre"),ra(e,t)){const i=yield this.computeAndValidateCustomRedirectUrl(e.id,t,{getters:s});if(!i)return;e.sections[1].variations[t]=i}yield this.sendSplitVariationShown(r,e,l?0:1)}else{i=yield this.getCombination(s,e),co&&e.mE&&(yield Td.getCombi(s,e))!==i.combi&&qd({getters:s,vwoEvents:r,campaignData:e});const t=e.combination_chosen=i.combi;if(l=i.alreadyChosen||(yield this.checkAlreadyChosenForMultiExperience(s,e,t)),delete e.cc,d&&this.resetHoldbacksParams(e),!t)return d&&this.resetHoldbacksParams(e),r.trigger(m.UNHIDE_ALL_VARIATIONS,{oldArgs:[e.id,void 0,void 0,void 0,void 0,void 0,!0,od.isPersonalizeCampaign(e)]}),this.unhideVariationIfNotSplit(s,e,r),s.vwoInternalProperties.isSpaEnabled&&r.trigger(m.TEST_NOT_RUNNING,{oldArgs:[e.id]}),void(e.ready=!1);r.trigger(m.CHOOSE_COMBINATION,{oldArgs:[e.id,t,l,od.isPersonalizeCampaign(e)?l:void 0,d]}),al(),this.recordVisitor(s,t,e,!l,r),To||this.unhideElForCombinationsToNotUse(s,d?t.split(",")[1]:t,e,r),"VISUAL_AB"===e.type&&1==t&&(r.trigger(m.UNHIDE_ALL_VARIATIONS,{oldArgs:[e.id,void 0,void 0,void 0,void 0,void 0,void 0,!0]}),this.unhideVariationIfNotSplit(s,e,r)),Td.executeCampaignJS(e,"pre");const n=yield od.isBotScreen();yield Ca.variationShown(r,Object.assign(Object.assign({id:e.id,variation:i.combi,isFirst:l?0:1},n&&{vwoMeta:{isBot:n}}),{fireLinkedTagSync:"FUNNEL"===e.type}),e),To&&this.unhideElForCombinationsToNotUse(s,d?t.split(",")[1]:t,e,r)}}else s.vwoInternalProperties.isSpaEnabled&&r.trigger(m.TEST_NOT_RUNNING,{oldArgs:[e.id]}),od.shouldTrackUserForCampaign(e)&&(r.trigger(m.GOAL_VISIT,{expId:e.id}),(null===(d=null==e?void 0:e.globalCode)||void 0===d?void 0:d.pre)&&r.trigger(`${m.EVALUATE_GOAL_PAGE_FOR_PREJS}_${e.id}`)),$d({data:e,event:t,getters:s,actions:n,vwoEvents:r},e),this.unhideVariationIfNotSplit(s,e,r)})}}var cl=new ll;function ul(e){var t;return(Do()||window._vis_debug)&&(null===(t=e.debug)||void 0===t?void 0:t.v)}function gl(e,t){var i,n,s,r;if((null===(i=e.triggers)||void 0===i?void 0:i[0])==t)return!1;return(null===(r=null===(s=null===(n=e.sections)||void 0===n?void 0:n[1])||void 0===s?void 0:s.triggers)||void 0===r?void 0:r[e.debug.v])!==t}function hl(e,t){return!e.ready&&!(ul(e)&&od.isPersonalizeCampaign(e)&&gl(e,t))}const vl="mtCA",pl="mtPC",wl="aMTP";class El extends rl{constructor(){super(...arguments),this.listenerAdded=!1,this.runCampaignSync={}}executeWrapper(e,t){return i(this,void 0,void 0,function*(){if(e.data[vl]||e.data[pl])return;const n=e.data.id;this.runCampaignSync[n]?this.runCampaignSync[n]=this.runCampaignSync[n].then(()=>i(this,void 0,void 0,function*(){try{yield this.execute(e,t)}catch(e){$o.error(e)}})):this.runCampaignSync[n]=this.execute(e,t),yield this.runCampaignSync[n],delete this.runCampaignSync[n]})}execute({event:e,data:t,actions:n,getters:s,vwoEvents:r},o){return i(this,void 0,void 0,function*(){if(x()||W.isCampBlocked(t))return;if("SURVEY"===t.type){if(!(yield U(r)))return;yield ba._.insightsOnConsentPromise}const{executingTagTrigger:a}=e;if(delete e.executingTagTrigger,!hl(t,a))return;if(s=s||ba.phoenix.store.getters,n=n||ba.phoenix.store.actions,t.isTriggerValidated=!0,!o&&"FUNNEL"===t.type)return;if(!s.vwoInternalProperties.shouldExecuteLib)return"SPLIT_URL"===t.type&&r.trigger(m.NOT_REDIRECTING),void Ca.unhideElement(r,{ruleName:"*",campaignData:t});if(s.vwoInternalProperties.willRedirectionOccur)return;"TRACK"===t.type&&(yield this.processFunnelCampaign({getters:s,actions:n,vwoEvents:r,data:t,event:e})),this.listenerAdded||(r.on(m.EXECUTE_FUNNEL_FOR_GOAL_CAMPAIGN,t=>i(this,void 0,void 0,function*(){yield this.processFunnelCampaign({getters:s,actions:n,vwoEvents:r,data:t.campaign,event:e})})),this.listenerAdded=!0),cl.preProcessCampaignData({event:e,data:t,actions:n,getters:s,vwoEvents:r});const d=yield Td.getCombiCookie(s,t.id);yield window.VWO._.visibilityTriggered,t.isProcessing=1,yield cl.processCampaign({event:e,data:t,actions:n,getters:s,vwoEvents:r,executingTagTrigger:a}),delete t.isProcessing,t.ready&&!d&&(e._vwo=e._vwo||{campaignsConverted:[]},e._vwo.campaignsConverted.push(t.id)),r.trigger(m.CAMPAIGN_FLOW_END)})}processFunnelCampaign({getters:e,actions:t,vwoEvents:n,data:s,event:r}){return i(this,void 0,void 0,function*(){if(!s.funnel)return;const o=yield window.fetcher.getValue("VWO._.commonCookieHandler.getDataStore()"),a=s.funnel.map(a=>i(this,void 0,void 0,function*(){const i=o.split(":")[rr].split(",");let d,l,c,u=i.length;const g=e.settings.campaigns[a.id].g[0].id===parseInt(Object.keys(s.goals)[0],sr),h=a.triggers[0],v=yield window.VWO.phoenix.validateTrigger(window.VWO.phoenix.settings.currentSettings.triggers[h],null,{triggerName:h});for(;u--;)d=i[u].split("_"),l=d[0],parseInt(l,sr)===parseInt(a.id,sr)&&(c=!0);v&&g&&!c&&(yield this.execute({event:r,data:e.settings.campaigns[a.id],actions:t,getters:e,vwoEvents:n},!0))}));yield Promise.all(a)})}}const fl=new El,_l=fl.executeWrapper.bind(fl);class ml extends ll{constructor(){super(...arguments),this.preview=Do,this.currentCombinationXPaths={}}checkAndApplyChanges(e,t,n,s,r){return i(this,void 0,void 0,function*(){if(!t||!t.ready)return;let i,o=!1;if(i="","SPLIT_URL"===t.type)this.runSplitCampaign(t,e,s,n);else{if(i=this.preview()||(yield Td.getCombi(e,t)),i){if(t.mE){const n=yield Td.chooseCombination(e,t);if(i!=n&&(o=!0,i=n),!i)return}}else if(o=!0,i=yield Td.chooseCombination(e,t),!i)return;n.trigger(m.ELEMENT_LOAD_TIMER_STOP,{oldArgs:[t.id,i]}),e.vwoInternalProperties.isSpaEnabled&&void 0===t.dontKillTimer&&(t.dontKillTimer=!0),Qd({getters:e,expId:t.id,combination:i}),this.otherSide("tryApplyingChanges",[i,t,null,r]),yield this.record(e,i,t,o,n),od.isDomIndependentCampaign(t.type)&&od.shouldTrackUserForCampaign(t)&&n.trigger(m.GOAL_VISIT,{expId:t.id});for(const e in this.currentCombinationXPaths)Object.prototype.hasOwnProperty.call(this.currentCombinationXPaths,e)&&n.trigger(m.ELEMENT_NOT_LOADED,{oldArgs:[t.id,this.currentCombinationXPaths[e][0],this.currentCombinationXPaths[e][1],e]})}})}record(e,t,n,s,r){return i(this,void 0,void 0,function*(){if(!s||!t)return;(yield Td.include(e,n.id,t,n)).isCookieCreated&&window.fetcher.getValue("VWO._.phoenixMT.trigger",[m.CAMPAIGN_COMBI_CREATED]),e.storages.storages.cookies.erase("_vis_opt_exp_"+n.id+"_combi_choose"),n.id&&n.multiple_domains})}runSplitCampaign(e,t,n,s){return i(this,void 0,void 0,function*(){let r;Lo()||(r=Do()||(yield Td.getCombi(t,e))||(yield od.getSplitDecision(t,e)));const o=e.sections[1].variations,a=t.storages.storages.cookies;if(r=parseInt(r,sr),r)1===r?(Ca.unhideElement(s,{ruleName:"*",campaignData:e,oldArgs:[e.id,void 0,void 0,"*"]}),s.trigger(m.NOT_REDIRECTING),s.trigger(m.UNHIDE_ALL_VARIATIONS,{oldArgs:[e.id,void 0,void 0,void 0,!0]}),e.combination_chosen=r,s.trigger(m.CHOOSE_COMBINATION,{oldArgs:[e.id,r,!0]}),this.recordVisitor(t,r,e,!1,s)):(od.createCookie(t,"_vis_opt_exp_"+e.id+"_split",r,100,e),s.trigger(m.SPLIT_URL,{oldArgs:[e.id]}),this.redirectToURL(t,n,e,o[r],r,s));else{if(isNaN(r=parseInt(yield Td.chooseCombination(t,e),sr)))return s.trigger(m.CHOOSE_COMBINATION,{oldArgs:[e.id,void 0,!1]}),void s.trigger(m.UNHIDE_ALL_VARIATIONS,{oldArgs:[e.id,void 0,void 0,void 0,!0]});if(e.multiple_domains&&1!==r&&!oa(e,r)){od.createCookie(t,"_vis_opt_exp_"+e.id+"_split",r,100,e),s.trigger(m.SPLIT_URL,{oldArgs:[e.id]});const d=[{willRedirectionOccur:!0,destinationMT:"VWO._.willRedirectionOccur"}];od.setPropertiesToBothThreads(n,d,"vwoInternalProperties"),n.addValues({waitingForThirdPartySync:!0},"vwoInternalProperties");const l=()=>{this.redirectToURL(t,n,e,o[r],r,s,!0)};a.waitForThirdPartySync(()=>i(this,void 0,void 0,function*(){n.addValues({waitingForThirdPartySync:!1},"vwoInternalProperties"),l()})),Lo()&&l()}else 1!==r?(od.createCookie(t,"_vis_opt_exp_"+e.id+"_split",r,100,e),s.trigger(m.SPLIT_URL,{oldArgs:[e.id]}),this.redirectToURL(t,n,e,o[r],r,s,!0)):(s.trigger(m.NOT_REDIRECTING),Ca.unhideElement(s,{ruleName:"*",campaignData:e,oldArgs:[e.id,void 0,void 0,"*"]}),e.combination_chosen=r,s.trigger(m.CHOOSE_COMBINATION,{oldArgs:[e.id,r,!1]}),s.trigger(m.UNHIDE_ALL_VARIATIONS,{oldArgs:[e.id,void 0,void 0,void 0,!0]}),yield this.recordVisitor(t,"1",e,!0,s),this.record(t,"1",e,!0,s))}})}redirectToURL(e,t,n,s,r,o,a){return i(this,void 0,void 0,function*(){if(this.isTimedOut(e))return;od.setPropertiesToBothThreads(t,[{willRedirectionOccur:!0,destinationMT:"VWO._.willRedirectionOccur"}],"vwoInternalProperties"),o.trigger(m.REDIRECT_DECISION,{oldArgs:[!0,n.id]}),a?this.registerHit(e,r,n,o,!0,this.processRedirect.bind(this),{getters:e,campaignData:n,redirectURL:s,isNewVisitor:a,context:this,combination:r}):this.processRedirect({getters:e,campaignData:n,redirectURL:s,isNewVisitor:a,context:this,combination:r})})}processRedirect({getters:e,campaignData:t,redirectURL:i,isNewVisitor:n,combination:s}){this.otherSide("processRedirect",[{getters:e,campaignData:t,redirectURL:i,isNewVisitor:n,combination:s}])}otherSide(...e){e[0]="VWO.modules.tags.runTestCampaign.utils."+e[0],window.fetcher.getValue(...e)}}var Ol=new ml;const Sl=function({event:e,getters:t,actions:n,vwoEvents:s}){return i(this,void 0,void 0,function*(){if(e.props.vwo_doNotProcess_vS)return;const i=t.settings.campaigns[e.props.id];yield Ol.checkAndApplyChanges(t,i,s,n),Td.executeCampaignJS(i,"post")})};class yl extends ta{compareUrlWithIncludeExcludeRegex(e,t,n,s){return i(this,void 0,void 0,function*(){return window.fetcher.getValue('VWO.modules.utils.urlUtils.compareUrlWithIncludeExcludeRegex("${{1}}", "${{2}}", "${{3}}", "${{4}}")',null,{captureGroups:[e,t,n,s]})})}}const Tl=new yl;window.VWO.modules.utils.urlUtils=Tl;class Cl{serializeNonGoalData(e){od.isDomIndependentCampaign(e.type)&&(e.clickmap=0),("ANALYSIS"===e.type||od.isAnalyzeCampaign(e.type))&&(e.goals={})}serializeData(e){this.serializeNonGoalData(e);const t=e.goals;for(const e in t)od.isPageBasedGoal(t[e].type)?(t[e].pUrl=t[e].pUrl||t[e].urlRegex,t[e].pExcludeUrl=t[e].pExcludeUrl||t[e].excludeUrl):t[e].pUrl=t[e].pUrl||".*"}isGoalEligible(e,t,i){i=i||window.VWO.phoenix;const n=(t=t||i.store.getters).currentUrl;return e.pExcludeUrl&&ea.matchRegex(n,e.pExcludeUrl)?(i.trigger(m.EXCLUDE_GOAL_URL),!1):e.pUrl?Tl.verifyUrl(n,e.pUrl,null):Tl.verifyUrl(n,null,e.urlRegex)}registerConversion(e,t,n,s,r,o,a){return i(this,void 0,void 0,function*(){if("INSIGHTS_FUNNEL"===n.type)return void window.VWO._.insightsUtils.markFunnelValue(n.id,1,t,n.version);if(!Ua.shouldWeTrackVisitor())return;t=t||1;const i=window.VWO.phoenix;let d;if(e=e||i.store.getters,od.isPersonalizeHoldback(n)){d=yield Td.getCombi(e,n,o);const t=d.split(";"),i=t[1];if(i){const e=t[0].split("|");for(let t=0;t<e.length;t++){const n=e[t];if(n.split(",")[0]===i){d=n;break}}}}else d=(null==a?void 0:a.combination)||(yield Td.getCombi(e,n,o));yield this._triggerGoalConversion(i,e,t,n,s,r,Object.assign(Object.assign({},a||{}),{combination:(null==a?void 0:a.combination)||(yield Td.getCombi(e,n,o))}))})}getImgUrlForConversion(e,t,n,s,r,o){return i(this,void 0,void 0,function*(){var i,a;const d=e.id;if(a="c.gif?account_id="+s.accountId+"&experiment_id="+d+"&goal_id="+t+"&ru="+encodeURIComponent(yield yr.get())+(void 0===r?"":"&r="+r)+od.getUUIDString((null==o?void 0:o.uuid)||(yield od.getUUID(s,e))),"TRACK"===e.type){i=(null==o?void 0:o.sId)||(yield s.vwoInternalProperties.sessionInfoService.getSessionId()),yield window.VWO.phoenix.trigger(m.EXECUTE_FUNNEL_FOR_GOAL_CAMPAIGN,{campaign:e});let n=null==o?void 0:o.gtAndF;if(n||(n=yield window.tracklib.getGtAndF(t)),n){return a+"&s="+i+"&ifs="+ +(i===((null==o?void 0:o.sId)||(yield s.vwoInternalProperties.sessionInfoService.getSessionId())))+"&t=1&cu="+encodeURIComponent((null==o?void 0:o.pageUrl)||s.currentUrl)+n}return""}return(yield s.vwoInternalProperties.sessionInfoService.shouldSendSessionInfoInCall())&&(i=yield s.vwoInternalProperties.sessionInfoService.getSessionId()),a+"&combination="+n+(i=i?"&sId="+i:"")})}_triggerGoalConversion(e,t,n,s,r,o,a){return i(this,void 0,void 0,function*(){if("INSIGHTS_METRIC"===s.type)return void Td.markGoalTriggered(s,n,t);const i=a.combination;if(!o&&(!i||(yield Td.isGoalTriggered(s,n,t))||od.isBot2()))return void(yield e.trigger(m.REGISTER_CONVERSION,{oldArgs:[s.id,n,r,!1],campaignId:s.id,goalId:n}));"REVENUE_TRACKING"!==s.goals[n].type&&(r=void 0);const d=yield this.getImgUrlForConversion(s,n,i,t,r,{uuid:a.uuid,gtAndF:a.gtAndF,sId:a.sId,pageUrl:a.pageUrl});d&&((yield od.isEligibleToSendCall(s.id,t))&&(yield pa.sendCall(t,{url:d},null,null)),yield Td.markGoalTriggered(s,n,t)),W.queueGoalLogs(s.id,n,r,!!d)&&(yield e.trigger(m.REGISTER_CONVERSION,{oldArgs:[s.id,n,r,!!d],campaignId:s.id,goalId:n}))})}}const Il=new Cl;class Nl{}class Al extends Nl{shouldWeTriggerMetric(e,t,i,n,s){const r=n.isFirst,{excludeUrl:o,pExcludeUrl:a,urlRegex:d,pUrl:l}=s;let c;c=!(o||a||d||l)||Il.isGoalEligible(s,e,t);return!(!od.isSessionBasedCampaign2(n)&&r&&i.name===m.PAGE_VIEW&&"CUSTOM_GOAL"===s.type)&&c}isItCustomConversionEvent(e){return e.name===m.CUSTOM_CONVERSION}}var Vl=new Al;class bl{constructor(){this.whiteListedEventsForVsKey=[m.PAGE_VIEW,m.CUSTOM_CONVERSION,m.DOM_CLICK,m.DOM_SUBMIT,m.REVENUE_CONVERSION]}getCurrentEventData(e,t,i,n){const s=n||{};if(!(Object.keys(t).length<=0))return Object.keys(t).forEach(n=>{var r;s[n]=s[n]||{},s[n]=Object.assign(Object.assign({},s[n]),{vwoMeta:{metric:t[n].metrics}}),this.whiteListedEventsForVsKey.includes(e)&&t[n].comb&&(s[n].vwoMeta.vS=t[n].comb),(null===(r=i[n])||void 0===r?void 0:r.length)>0&&(s[n].matchedSelectors=i[n])}),s}}class Rl extends bl{constructor(){super(...arguments),this.mutex={},this.dpListeners={},this.dpFlags={}}execute({data:e,vwoEvents:t,getters:n,event:s,actions:r}){var o,a;return i(this,void 0,void 0,function*(){if([m.DOM_CLICK,m.DOM_SUBMIT,m.PAGE_UNLOAD].includes(s.name))return;if(n.vwoInternalProperties.willRedirectionOccur)return;if(od.isBot2())return;const r={},d={};for(const l of e)for(const e of l.campaigns){const c=e.c,u=e.g;let g=c&&n.currentSettings.dataStore.campaigns[c];(null===(o=window._vwoCc)||void 0===o?void 0:o.isDCE)&&s.name===m.PAGE_VIEW&&(null===(a=g.ss)||void 0===a?void 0:a.csa)&&this.handleDeferredConversion({data:[l],vwoEvents:t,getters:n,event:s,actions:{}},g);let h,v,p=!1;const w=c+"-"+u;this.mutex[w]||(this.mutex[w]=Promise.resolve()),this.mutex[w]&&(v=this.mutex[w].then(()=>i(this,void 0,void 0,function*(){var i,o,a,l;if(!c||!u||(null===(o=null===(i=s._vwo)||void 0===i?void 0:i.campaignsConverted)||void 0===o?void 0:o.includes(c))||!g)return;if(h=g.goals[u],!h)return;p=od.isSessionBasedCampaign2(g);const v="SEPARATE_PAGE"===h.type,w="TRACK"===g.type;if(p&&w&&!v)return;const E=od.hasInsightsMetric(g.type);if([m.PAGE_VIEW,m.CUSTOM_CONVERSION,m.REVENUE_CONVERSION].includes(s.name)||s.isCustomEvent){if(s.ins&&!E)return;if(E&&!s.isCustomEvent&&!s.ins)return}const f=g.triggers[0];if(!p&&!(null===(a=window._vwoCc)||void 0===a?void 0:a.ignoreCSAForGoals)&&(null===(l=null==g?void 0:g.ss)||void 0===l?void 0:l.csa)&&!(yield t.validateTrigger(n.currentSettings.triggers[f],null,{triggerName:f})))return void window.VWO.phoenix.trigger(m.GOAL_CONVERSION_FAILED,{oldArgs:[g.id,u]});if((null==g?void 0:g.mE)&&Td.doExperimentHere(n,g,t)[0]&&!g.combination_chosen)return;if(!od.shouldTrackUserForCampaign(g)||!(yield Td.isBucketed(n,g,!v))||!Vl.shouldWeTriggerMetric(n,t,s,g,h))return;if(v&&delete h.pageVisited,yield Td.isGoalTriggered(g,u,n))return;g||(g={id:c,goals:{[u]:{}},type:e.sess});const _=e.uuid||(yield od.createUUIDCookie2(n,g));if(!p||E){if("CUSTOM_GOAL"===(null==h?void 0:h.type)&&(null==h?void 0:h.url)){const e=h.url;r[_]=r[_]||[],r[_].indexOf(e)<0&&r[_].push(e)}d[_]=d[_]||{};const e="id_"+c;d[_].metrics=d[_].metrics||{},d[_].metrics[e]=d[_].metrics[e]||[],d[_].metrics[e].push("g_"+u),g.isEventMigrated&&!s.isCustomEvent&&(d[_].comb=d[_].comb||{},d[_].comb[e]=yield Td.getCombi(n,g,!0))}var O=!0;window.VWO._.isBeaconAvailable=s.isBeaconAvailable,window.VWO._.isLinkRedirecting=s.isLinkRedirecting;yield Il.registerConversion(n,u,g,s.revenue,!0,!0,{combination:e.combination,uuid:_,gtAndF:e.gtAndF,sId:e.sId,pageUrl:e.pageUrl}),t.trigger(m.GOAL_CONVERTED,{campaignId:g.id,goalId:u}),window.VWO._.isLinkRedirecting=!1,O=O&&window.VWO._.isBeaconAvailable}))),this.mutex[w]=v,yield v}if(R(()=>s._vwo.eventDataConfig))this.getCurrentEventData(s.name,d,r,s._vwo.eventDataConfig);else{const e=this.getCurrentEventData(s.name,d,r);s._vwo=s._vwo||{},s._vwo.eventDataConfig=s._vwo.eventDataConfig||{},s._vwo.eventDataConfig=e}})}handleDeferredConversion({data:e,vwoEvents:t,getters:n,event:s,actions:r},o){const a=`trigger.${o.triggers[0]}`,d=`dCP_${o.id}`;if(this.dpFlags[d])return;const l=`lTK_${o.id}`;if(this.dpListeners[l])return;this.dpListeners[l]=!0;const c=()=>i(this,void 0,void 0,function*(){t.off(a,c),delete this.dpListeners[l],this.dpFlags[d]=!0,yield this.execute({data:e,vwoEvents:t,getters:n,event:s,actions:r}),delete this.dpFlags[d]});t.on(a,c)}}const Pl=new Rl,Dl=Pl.execute.bind(Pl);window.VWO.modules.tags.metricWT=Dl;class xl{otherSide(...e){return e[0]="VWO.modules.tags.prePostMutation.fn."+e[0],window.fetcher.getValue(...e)}}window.VWO.modules.tags.prePostMutation={};class Ll{otherSide(...e){return e[0]="VWO.modules.tags.prePostMutation.utils."+e[0],window.fetcher.getValue(...e)}}class Ul extends Ll{isMonitorPageChangesRequired(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const i=e[t];if(i.muts&&i.muts.post&&i.muts.post.enabled)return!0}return!1}getWaitForDOMRenderingConfigAndHideElements(e){let t=!1,i=10,n=1e3;for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)){const r=e[s],o=r.muts&&r.muts.pre;o&&o.enabled&&(t=!0,o.timer&&o.timer>i&&(i=o.timer),o.timeout&&o.timeout>n&&(n=o.timeout))}return{enabled:t,timer:i,timeout:n}}waitForDOMRenderingAndExecuteCampaign(e){return this.otherSide("waitForDOMRenderingAndExecuteCampaign",[e])}monitorPageForChanges(){return this.otherSide("monitorPageForChanges")}}const Wl=new Ul;function Ml(){kl("attachEditorChangeObserverEvents")}function kl(...e){return e[0]="VWO.modules.tags.prePostMutation.editorChangesObserver."+e[0],window.fetcher.getValue(...e)}window.VWO.modules.tags.prePostMutation.utils=Wl;class Gl extends xl{constructor(){super(...arguments),this.editorChangeObserverEventsAttached=!1}execute({data:e,getters:t,vwoEvents:n}){return i(this,void 0,void 0,function*(){e=t.settings.campaigns;const i=t.MutationObserver;let s,r=Promise.resolve();if(i){const t=Wl.getWaitForDOMRenderingConfigAndHideElements(e);t.enabled?r=Wl.waitForDOMRenderingAndExecuteCampaign(t):n.trigger(m.SSR_COMPLETE)}Wl.isMonitorPageChangesRequired(e)&&(s=Wl.monitorPageForChanges(),this.editorChangeObserverEventsAttached||(Ml(),this.editorChangeObserverEventsAttached=!0)),yield Promise.all([r,s])})}}const Fl=new Gl,Hl=Fl.execute.bind(Fl);window.VWO.modules.tags.prePostMutation.fn=Fl;class jl extends s{errorTracking({getters:e}){return i(this,void 0,void 0,function*(){const t=yield window.fetcher.getValue('VWO.modules.tags.errorTrackingCallback("${{1}}")',null,{captureGroups:[e]});this.setCustomError(t)})}}const $l=new jl,Bl=$l.errorTracking;function Kl(e){return i(this,void 0,void 0,function*(){const t=e.data,i=e.event.name;yield window.fetcher.getValue('VWO.modules.tags.sampleVisitor("${{1}}","${{2}}")',null,{captureGroups:[t,i]})})}class zl{}function Yl(e,t,n){var s;return i(this,void 0,void 0,function*(){const i=[...e];for(let e=i.length-1;e>=0;e--){const r=null===(s=i[e])||void 0===s?void 0:s.c;if(Array.isArray(r))for(const s of r)if(yield Td.getCombiCookie(t,+s)){n.trigger(m.GROUP_WINNER_CHOOSEN,{groupWinner:parseInt(s,sr)}),i.splice(e,1);break}}return i})}class Jl extends zl{constructor(e,t){super(),this.flattenedGroup=[],this.groupsConfig=e,this.campaigns=t,this.expPossibleToRunMap={}}flattenGroupsData(){if(this.groupsConfig)for(let e=0;e<this.groupsConfig.length;e++){if(this.groupsConfig[e].c instanceof Array)for(let t=0;t<this.groupsConfig[e].c.length;t++)this.groupsConfig[e].c[t]=this.groupsConfig[e].c[t].toString();this.flattenedGroup=this.flattenedGroup.concat(this.groupsConfig[e].c)}}isExperimentReadyToRun(e,t,n){return i(this,void 0,void 0,function*(){const i=t.triggers[0];return Td.doExperimentHere(e,t,n)[0]&&(yield window.VWO.phoenix.validateTrigger(e.currentSettings.triggers[i],null,{skipEventProps:!0,skipValidationIfTimer:!0}))})}checkForExistingWinner(e,t){return i(this,void 0,void 0,function*(){e=e||window.phoenix.store.getters;const i=this.campaigns[t];return!!((yield Td.getCombiCookie(e,t))||Td.isLogged(e,t,!0)||"SPLIT_URL"===this.campaigns[t].type&&(yield od.getSplitDecision(e,i))||1===this.expPossibleToRunMap[t])})}checkWinnerAlreadyExists(e){for(let t=0;t<e.length;t++){const i=parseInt(e[t],10);if(1===this.expPossibleToRunMap[i])return i}}checkIfStringArray(e){return!!Array.isArray(e)}processExperimentsOnBasisOfRandomness(e,t){return i(this,void 0,void 0,function*(){const n={},s={},r=t.c;let o=0;if(!this.checkIfStringArray(r))return;let a=this.checkWinnerAlreadyExists(r);if(!a){for(let e=0;e<r.length;e++)2===this.expPossibleToRunMap[r[e]]&&(o+=1,s[r[e]]=this.campaigns[r[e]].triggers);if(!o){const t=r.map(t=>i(this,void 0,void 0,function*(){4===this.expPossibleToRunMap[t]&&(yield Td.exclude(e,this.campaigns[t]))}));return void(yield Promise.all(t))}for(const e in s)Object.prototype.hasOwnProperty.call(s,e)&&(n[e]=+(100/o).toFixed(2));a=yield Td.chooseCombination(e,null,{scaleInfo:n,segmentInfo:s}),this.expPossibleToRunMap[a]=1}})}processExperimentsOnBasisOfPriorityAndWeight(e,t){return i(this,void 0,void 0,function*(){const n=t.c,s=t.p,r=t.wt;if(!this.checkIfStringArray(n))return;let o=this.checkWinnerAlreadyExists(n);if(!o){if(s&&s.length)for(let e=0;e<s.length;e++)if(2===this.expPossibleToRunMap[s[e]]){o=s[e],this.expPossibleToRunMap[o]=1;break}if(!o&&r){const t={},i={};let n=0,s=0;const a=Object.keys(r);for(let e=0;e<a.length;e++)2===this.expPossibleToRunMap[a[e]]&&(n+=1,i[a[e]]=this.campaigns[a[e]].triggers,s+=r[a[e]]);if(n){for(let e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=+(100*r[e]/s).toFixed(2));o=yield Td.chooseCombination(e,null,{scaleInfo:t,segmentInfo:i}),this.expPossibleToRunMap[o]=1}}if(!o){const t=n.map(t=>i(this,void 0,void 0,function*(){4===this.expPossibleToRunMap[t]&&(yield Td.exclude(e,this.campaigns[t]))}));yield Promise.all(t)}}})}updateExperiments(e){return i(this,void 0,void 0,function*(){let t,n=!1,s=!1,r=!1;const o=Object.keys(this.campaigns).map(o=>i(this,void 0,void 0,function*(){if(Object.prototype.hasOwnProperty.call(this.campaigns,o)){const i=e.settings.currentSettings.triggers[window._vwo_exp[o].triggers[0]],a="SPLIT_URL"===this.campaigns[o].type;let d;0!==this.expPossibleToRunMap[o]&&1!==this.expPossibleToRunMap[o]||(this.campaigns[o].shouldHideElement=1),1===this.expPossibleToRunMap[o]&&(e.trigger(m.GROUP_WINNER_CHOOSEN,{groupWinner:parseInt(o,sr)}),a&&(n=!0,(d=yield window.VWO.phoenix.validateTrigger(i,null,{skipEventProps:!0}))&&(r=!0))),!a||s&&t||(this.flattenedGroup.indexOf(o)<0?d&&Td.doExperimentHere(e.store.getters,window._vwo_exp[o],e)[0]&&(t=!0):s=!0)}}));yield Promise.all(o),n&&r||!s||t||e.trigger(m.NOT_REDIRECTING)})}filterByGroupType(e){const t=this.groupsConfig.map(t=>1==t.et?this.processExperimentsOnBasisOfRandomness(e,t):2==t.et?this.processExperimentsOnBasisOfPriorityAndWeight(e,t):void 0);return Promise.all(t)}filterExperimentsFromGroups({getters:e,vwoEvents:t}){var n;return i(this,void 0,void 0,function*(){if(!(null===(n=this.groupsConfig)||void 0===n?void 0:n.length)){for(const e in this.campaigns)Object.prototype.hasOwnProperty.call(this.campaigns,e)&&t.trigger(m.GROUP_WINNER_CHOOSEN,{groupWinner:parseInt(e,sr)});return}wo&&(this.groupsConfig=yield Yl(this.groupsConfig,e,t),this.flattenGroupsData());let s=!1;const r=Object.keys(this.campaigns).map(n=>i(this,void 0,void 0,function*(){n=n.toString();const i=this.campaigns[n];if(i.groupSelectionWinner)return this.expPossibleToRunMap[n]=1;if(Ls(this.flattenedGroup,n)<0)this.expPossibleToRunMap[n]=0;else if(yield Td.isExcluded(e,i))this.expPossibleToRunMap[n]=3;else{s=!0;const r=this.checkForExistingWinner(e,i.id),o=this.isExperimentReadyToRun(e,i,t);(yield r)?this.expPossibleToRunMap[n]=1:1!==this.expPossibleToRunMap[n]&&(yield o)&&((yield Td.shouldBucket(e,i))?this.expPossibleToRunMap[n]=2:this.expPossibleToRunMap[n]=4)}}));return yield Promise.all(r),s&&(yield this.filterByGroupType(e)),this.updateExperiments(t)})}}class Xl{}class ql extends Xl{constructor(){super(),this.campaignsData={}}processCampaigns({event:e,getters:t,actions:i,vwoEvents:n,data:s}){const r=t.settings.vwoData.gC,o=t.settings.campaigns,a=new Jl(r,o);return a.flattenGroupsData(),a.filterExperimentsFromGroups({actions:i,getters:t,event:e,vwoEvents:n,data:s})}processGroupCampaigns({event:e,data:t,getters:i,actions:n,vwoEvents:s}){if(window.VWO._.pageData=window.VWO._.pageData||{},window.fetcher.setValue("VWO._.pageData",window.VWO._.pageData),window.VWO._.pageData._grp_campaign_called)return void s.trigger("vwo_groupCampTriggered");window.VWO._.pageData._grp_campaign_called=!0,window.fetcher.setValue("VWO._.pageData._grp_campaign_called",!0);const r=Td.getGroupBasedCampaigns({event:e,data:t,getters:i,actions:n,vwoEvents:s});if(r.length){for(const e of r)this.campaignsData[e]=i.settings.campaigns[e];return this.processCampaigns({event:e,getters:i,actions:n,vwoEvents:s,data:this.campaignsData}).then(()=>{s.trigger("vwo_groupCampTriggered")})}s.trigger("vwo_groupCampTriggered")}}const Ql=new ql,Zl=Ql.processGroupCampaigns.bind(Ql);window.VWO.modules.tags.groupCampaigns=Zl;class ec{}class tc{resetExpParamsCommon(e){if(e[nr]=0,delete e[tr],delete e[ir],delete e.clicks,delete e.combination_chosen,delete e[pr],delete e.segment_eligble,delete e.isFirst,delete e.isExcluded,e.muts&&delete e.muts.pvtMut,779155==window._vwo_acc_id?!e.isProcessing&&delete e.ready:delete e.ready,delete e.timedout,delete e[vl],delete e[pl],delete e.processed,delete e[tr],delete e.iB,this.checkForVariationTargeting(e)&&delete e.xPath,clearTimeout(e[ar]),delete e[ar],delete e.globalCode.preExecuted,delete e.globalCode.postExecuted,e.sections)for(var t=xs(e.sections),i=0;i<t.length;i++)delete e.sections[t[i]].loaded}shouldProcessCampaign(e,t){return!1}checkForVariationTargeting(e){return!1}}class ic extends tc{resetTriggerStates(){var e,t,i,n;const s=ba.phoenix;ba._.pageNo="number"==typeof ba._.pageNo?ba._.pageNo+1:0;const r="vwo_timer",o=null===(i=null===(t=null===(e=s.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.values)||void 0===i?void 0:i.triggers,a=s.settings.currentSettings.triggers,d=s.triggers.triggerEventListeners;ya(s,m.POST_INIT,{}),s.eventBus.remove(r);for(const e in a)if(Object.prototype.hasOwnProperty.call(a,e)){const t=null===(n=a[e])||void 0===n?void 0:n.cnds;let i,l;o[e]&&(i=o[e].event,l=o[e].trigger);let c,u=!1;if(t){const e=t=>{if(t&&"string"!=typeof t){if(Array.isArray(t))return t.forEach(e);if("[object Object]"===t.toString()&&void 0!==t.id){l&&l[t.id]&&(l[t.id].state=!1);t.event===r&&(u=!0,c=t.exitTrigger)}}};t.forEach(e)}if(i){o[e].state=!1;for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&delete i[e]}u&&(c&&(s.eventBus.remove(s.triggers.getTriggerEventName(c)),c=null),delete d[e][r],s.triggers.add(e,a[e]),u=!1)}s.events.events[r].eventConditionsUpdate()}resetExpParams(e,t,i){const n=e.currentSettings.dataStore.campaigns;for(const t in n)if(this.shouldProcessCampaign(t,n,i)){const s=n[t];if(this.resetExpParamsCommon(s),i&&"TRACK"===s.type){const t=s.triggers[0];e.triggers[t]&&(e.triggers[t].executionCount=0)}}if(window._vis_debug&&!i){e.getValue("tags.segmentEligibilityTest")&&t.addValues({executionCount:0},"tags.segmentEligibilityTest")}}shouldProcessCampaign(e,t,i){return Object.prototype.hasOwnProperty.call(t,e)&&(!i||"TRACK"===t[e].type)&&(!po||!t[e][wl])}checkForVariationTargeting(e){return Td.checkForVariationTargeting(e)}resetTriggerExecutionCount(e){const t=e.triggers;Object.keys(t).forEach(e=>{t[e].executionCount=0})}}var nc=new ic;class sc extends ec{constructor(){super(...arguments),this.lastExecutedForUrl=window.location.href}execute({event:e,data:t,getters:n,actions:s,vwoEvents:r}){var o,a;return i(this,void 0,void 0,function*(){Object.assign(window.location,(null==e?void 0:e.location)||{});const i=window.location.href=R(()=>e.props.virtualPageUrl)||R(()=>e.location.href)||(yield window.fetcher.getValue("location.href"));if(n.previousUrl=this.lastExecutedForUrl,window._vis_opt_url=R(()=>e.location.visOptUrl),this.lastExecutedForUrl===i||n.vwoInternalProperties.waitingForThirdPartySync)return;if(n.vwoInternalProperties.willRedirectionOccur)return;(null===(o=null==e?void 0:e.props)||void 0===o?void 0:o.virtualPageUrl)||(this.lastExecutedForUrl=i),r.clearData(),nc.resetTriggerStates(),Zd(),nc.resetExpParams(r.store.getters,s),nc.resetTriggerExecutionCount(r.store.getters),r.trigger(m.URL_CHANGED,{preventWildCardEvent:!!eo});if(od.setPropertiesToBothThreads(s,[{willRedirectionOccur:!1,destinationMT:"VWO._.willRedirectionOccur"}],"vwoInternalProperties"),od.addListenerForSessionInitComplete(),Wd({event:e,data:t,getters:n,actions:s,vwoEvents:r}),n.accountId,Aa(),window.VWO._.campaignsInternalMap={},window.VWO._.preventHidingInSPA=null===(a=window.VWO.featureInfo)||void 0===a?void 0:a.dNHEL,window.VWO._.pageData=window.VWO._.pageData||{},delete window.VWO._.pageData._grp_campaign_called,yield od.shouldExecuteLib({event:e,data:t,getters:n,actions:s,vwoEvents:r}),window.fetcher.setValue("window.VWO._.urlChangeProcessingPending",!1),n.vwoInternalProperties.shouldExecuteLib){if(window._vis_debug||window._vis_heatmap){const e=n.vwoInternalProperties.experimentIds,t=xo(e);r.trigger(m.CAMPAIGN_FLOW_START,{oldArgs:[t]})}n.vwoCode&&(n.vwoCode[Zs]=!1,n.vwoCode[er]=!1),window.VWO._.visibilityTriggered=new Promise(e=>{const t=r.on(m.VISIBILITY_TRIGGERED,()=>{r.off(t),e()})}),delete window.VWO._.auxPageViewFired,R(()=>window.VWO._.insightsUtils.activateFunnels()),(n.visDebug||Do()||window.VWO._.selfHosted)&&(yield od.firePageViewEvent({shouldFireDomLoad:!0})),window.VWO._.phoenixMT.trigger(m.LOAD_SETTINGS,2),r.trigger(m.POST_URL_CHANGE,{oldArgs:[Tl.getCleanedUrl(i),n.vwoInternalProperties.willRedirectionOccur]})}})}}const rc=new sc,oc=rc.execute.bind(rc);function ac({data:e,event:t,getters:i,vwoEvents:n}){var s,r,o;const a=t.props,d=null===(s=null==i?void 0:i.triggers[e.triggers])||void 0===s?void 0:s.trigger;const l=function(e){const t=[];return function e(i){Array.isArray(i)?i.forEach(e):i&&"object"==typeof i&&("id"in i&&"filters"in i&&t.push({id:i.id,filters:i.filters}),Object.values(i).forEach(e))}(e),t}(null===(o=null===(r=null==i?void 0:i.allSettings)||void 0===r?void 0:r.triggers[window._vwo_exp[Object.keys(window._vwo_exp)[0]].triggers[0]])||void 0===o?void 0:o.cnds);let c=[];Object.entries(d).forEach(([e,t])=>{!1===(null==t?void 0:t.state)&&Object.entries(l).forEach(([t,n])=>{const s=null==n?void 0:n.id;e==s&&s>=1e3&&R(()=>{const e=n.filters[0]||"Unknown",t=(s=e[0])?s.charAt(0).toUpperCase()+s.slice(1).replace(/([A-Z])/g," $1"):"";var s;const r=Array.isArray(e[2])?e[2].join(", "):e[2];c.push(t+" - Expected: "+r+function(e){const t=i.visitorDetails.UA,n="operatingSystem"===e?t.os:"browser"===e?t.br:"deviceType"===e?t.dt:null;return n?"<br>Detected: "+n:""}(e[0]))},{sendErrorLog:!0,msg:"Error processing segment filter in segmentEligibilityTest",url:"segmentEligibilityTestWT.ts"})})}),!1===a.segmentCndsSatisfied?od.isPersonalizeHoldback(e)||(n.trigger(m.SEGMENTATION_EVALUATED,{oldArgs:[e.id,a.segmentCndsSatisfied,!0]}),n.trigger(m.SEGMENTATION_FAILED,{oldArgs:[e.id,c]})):a.hideElementsTriggered&&n.trigger(m.ELEMENTS_SHOWN_WITHOUT_CHANGES,{oldArgs:[e.id]})}const dc=function({getters:e,vwoEvents:t}){return i(this,void 0,void 0,function*(){const i=Object.keys(e.settings.campaigns||{});if(!Do()&&!window._vis_debug||!window.VWO._.blockedState&&!x())for(const n of i){const i=e.settings.campaigns[n],s=ia.getCleanedUrl(e.currentUrl),r=i.urlRegex,o=i.url_pattern;let a=!1;if("SPLIT_URL"===i.type){const t=yield od.getSplitDecision(e,i);t&&od.isCurrentURLSplitVariation({chosenVariation:t,getters:e,campaignData:i})&&(a=!0)}const[d,l]=a?[!0,2]:Td.doExperimentHere(e,i,t,{urlRegex:r,urlPattern:o});Td.firePatternMatchingEvent(t,i.id,l,s,r||o,d),t.trigger("executePatternMatching",{_vwo:{doExperimentHere:"SPLIT_URL"===i.type?null:d}})}})};class lc{constructor(){this.noOp=function(){}}getPhoenixConfig(){const e={tags:{checkEnvironment:{fn:Gd,sync:!0},prePostMutation:{fn:Hl,sync:!0},visibilityService:{fn:sl,sync:!0},groupCampaigns:{fn:Zl,sync:!0},runCampaign:{fn:_l,sync:!0},metric:{fn:Dl,sync:!0,fireUniquelyForEveryEvent:!0},runTestCampaign:{fn:Sl,sync:!0},errorTracking:{fn:Bl,sync:!0},sampleVisitor:{fn:Kl},urlChange:{fn:oc,sync:!0},executePreCampJsForGoalsPage:{fn:({data:e})=>{Td.executeCampaignJS(e,"pre")},sync:!0}},storages:{localStorageService:z,cookies:jr},jsLibUtils:{verifyUrl:function(){return Tl.verifyUrl.apply(Tl,arguments)},getCleanedUrl:function(){return Tl.getCleanedUrl.apply(Tl,arguments)}}};return window._vis_debug&&(e.tags.segmentEligibilityTest={fn:ac,sync:!1,occurrence:1},e.tags.compareUrlAndFireResultantEvent={fn:dc,sync:!0}),e}setFunnelExps(e){var t,i;const n=null===(t=null==e?void 0:e.settings)||void 0===t?void 0:t.campaigns,s=[];for(const e in window._vwo_exp)if(window._vwo_exp[e].funnel)for(const t of window._vwo_exp[e].funnel){const e=t;(null===(i=window._vwo_exp[e.id])||void 0===i?void 0:i.g)||(window._vwo_exp[e.id]=e,window._vwo_exp[e.id].g=e.goals,window._vwo_exp[e.id].goals={},s.push(e.id+""),n&&(n[e.id]=window._vwo_exp[e.id]))}return s}sendMessageToParentFrame(e){return window.fetcher.getValue("VWO.modules.utils.initUtils.sendMessageToParentFrame",[e])}getCookieJarValidValue(e){return["null",null,void 0,"undefined"].indexOf(e)>-1?"":e}}var cc=new lc;class uc{mergeNestedObjects(...e){return e.reduce((e,t)=>this.recursivelyMerge(e,t))}mergeNestedObjectsV2(e={mergeArrays:!1},...t){return t.reduce((t,i)=>this.recursivelyMerge(t,i,{},e))}createNestedObjects(e,t){let i=e;return t&&t.split(".").forEach(e=>{Object.prototype.hasOwnProperty.call(i,e)||(i[e]={}),i=i[e]}),i}clearNestedObject(e,t){let i=e;const n=t.split("."),s=n[n.length-1];for(let e=0;e<n.length-1;e++)i=i[n[e]];f(i[s])?i[s]={}:delete i[s]}recursivelyMerge(e,t,i={},n={mergeArrays:!1}){if(f(e)&&f(t)){const s={};Object.keys(e).concat(Object.keys(t)).forEach(e=>{s[e]=1});const r=Object.getOwnPropertyDescriptors(e),o=Object.getOwnPropertyDescriptors(t);return Object.keys(s).forEach(s=>{o[s]?Object.defineProperty(i,s,o[s]):Object.defineProperty(i,s,r[s]),this.recursivelyMerge(e[s],t[s],i[s],n)}),i}return n.mergeArrays&&_(e)&&_(t)?(_(i)||(i=[]),i.splice(0,i.length,...e.concat(t)),i):t||e}}var gc=new uc,hc,vc,pc;class wc extends Cs{}function Ec(...e){return e[0]="VWO.modules.otherLibDeps."+e[0],window.fetcher.getValue(...e)}function fc(e){return Ec('storeSurveyDataInVWOSurveySettings("${{1}}")',null,{captureGroups:[e]})}!function(e){e.SUM="sum",e.COUNT="count",e.AVG="avg",e.MIN="min",e.MAX="max",e.FIRST_VALUE="first",e.LAST_VALUE="last",e.MEAN="mean",e.MEDIAN="median"}(hc||(hc={})),function(e){e.SINCE="s",e.WITHIN="w",e.FROM="f"}(vc||(vc={})),function(e){e.DAYS="d",e.WEEKS="w",e.MONTHS="m",e.YEARS="y"}(pc||(pc={}));class _c{setItem(e,t){e=this.getKeyBasedOnMode(e),z.set(e,JSON.stringify(t))}getItem(e){return e=this.getKeyBasedOnMode(e),z.get(e)}removeItem(e){e=this.getKeyBasedOnMode(e),z.remove(e)}getKeyBasedOnMode(e){if(!window._vis_debug&&!Do())return e;return"debug"+e+"_"+Object.keys(window._vwo_exp||{}).join("_")}}class mc extends _c{constructor(){super(...arguments),this.VWO_EVENT_HISTORICAL_KEY="_vwo_eventHist",this.VWO_EVENT_HISTORICAL_SESSION_KEY="_vwo_eventHistSession",this.isStorageSyncerForCurrentSessionEnabled=!1,this.areEventHistSessionListenersAttached=!1,this.areUrlChangeListenersAttached=!1,this.areEventHistListenersAttached=!1,this.SWEEP_INTERVAL_IN_DAYS=90}isEventRegistered(e){return!(!Do()&&!window._vis_debug)||R(()=>void 0!==window.VWO._.allSettings.dataStore.events[e],{sendErrorLog:!1},!1)}filterOutUnRegisteredEvents(e){return Object.keys(e).reduce((t,i)=>(this.isEventRegistered(i)&&(t[i]=e[i]),t),{})}initialize(){this.eventHist=JSON.parse(this.getItem(this.VWO_EVENT_HISTORICAL_KEY)||"{}"),this.eventHistForCurrentSession=JSON.parse(this.getItem(this.VWO_EVENT_HISTORICAL_SESSION_KEY)||"{}"),this.currentSessionEvents=window.VWO._.allSettings.dataStore.cSE||{},this.syncEvents=window.VWO._.allSettings.dataStore.syE||{},this.customSyncURL=Jr(),this.syncEventsConfig=this.customSyncURL?m.SEND_SYNC_CALL:window.VWO._.allSettings.dataStore.syncEvent||"sessionCreated",this.triggerEvents=[],this.performSweep()}clearHistEventData(){window.VWO._.ac.cSHS?Sc.clearsyE():(Do()||window._vis_heatmap||!Object.keys(this.syncEvents).length)&&Sc.clearHistoricalDataOfType(yc.Events)}addEventHistSessionListeners(){(window.VWO._.ac.cSHS||Object.keys(this.currentSessionEvents).length||Object.keys(this.eventHistForCurrentSession).length)&&(this.isStorageSyncerForCurrentSessionEnabled||!Object.keys(this.currentSessionEvents).length&&!window.VWO._.ac.cSHS||(this.isStorageSyncerForCurrentSessionEnabled=!0,window.VWO.modules.utils.storageSyncer.add(this.getKeyBasedOnMode(this.VWO_EVENT_HISTORICAL_SESSION_KEY),e=>{try{this.eventHistForCurrentSession=JSON.parse(e)||{}}catch(e){}})),this.areEventHistSessionListenersAttached||(window.VWO.phoenix.on(m.NEW_SESSION_CREATED,()=>{this.clearEventHistSessionData()}),window.VWO.phoenix.on(m.TRACK_NEW_SESSION_CREATED,()=>{this.clearEventHistSessionData()}),this.areEventHistSessionListenersAttached=!0))}clearEventHistSessionData(){this.eventHistForCurrentSession={},Sc.clearHistoricalDataOfType(yc.SessionEvents)}addUrlChangeListener(){Do()||window._vis_heatmap||!Object.keys(this.syncEvents).length&&!Object.keys(this.currentSessionEvents).length||this.areUrlChangeListenersAttached||(window.VWO.phoenix.on(m.URL_CHANGED,()=>{this.triggerEvents.forEach(e=>i(this,void 0,void 0,function*(){(this.eventHist[e.eventName]||this.eventHistForCurrentSession[e.eventName])&&(yield window.VWO.phoenix.isValid(e.triggerName,e.trigger,e.eventName))})),this.shouldSyncEvents=!window.VWO._.ac.cSHS&&!!Object.keys(this.syncEvents).length}),this.areUrlChangeListenersAttached=!0)}addEventHistListeners(){if(!Do()&&!window._vis_heatmap&&(window.VWO._.ac.cSHS||Object.keys(this.syncEvents).length||this.customSyncURL)&&!this.areEventHistListenersAttached){if(this.areEventHistListenersAttached=!0,window.VWO.modules.utils.storageSyncer.add(this.getKeyBasedOnMode(this.VWO_EVENT_HISTORICAL_KEY),e=>{try{this.eventHist=JSON.parse(e)||{}}catch(e){}}),window.VWO._.ac.cSHS)return void this.addListenerForSyEUpdation();if(this.shouldSyncEvents=!0,window._vis_debug)return void this.addListenerForSyEUpdation();"pageView"===this.syncEventsConfig?window.VWO.phoenix.on(m.PAGE_VIEW,()=>{this.syncEvents=window.VWO._.allSettings.dataStore.syE||{},this.shouldSyncEvents&&(this.syncEventsData(),this.shouldSyncEvents=!1)}):this.syncEventsConfig===m.SEND_SYNC_CALL?window.VWO.phoenix.on(m.SEND_SYNC_CALL,()=>{this.syncEvents=window.VWO._.allSettings.dataStore.syE||{},this.shouldSyncEvents&&(this.syncEventsData(),this.shouldSyncEvents=!1)}):"sessionCreated"===this.syncEventsConfig&&(window.VWO.phoenix.on(m.NEW_SESSION_CREATED,()=>{this.syncEvents=window.VWO._.allSettings.dataStore.syE||{},this.shouldSyncEvents&&(this.syncEventsData(),this.shouldSyncEvents=!1)}),window.VWO.phoenix.on(m.TRACK_NEW_SESSION_CREATED,()=>{this.syncEvents=window.VWO._.allSettings.dataStore.syE||{},this.shouldSyncEvents&&(this.syncEventsData(),this.shouldSyncEvents=!1)}),this.addListenerForSyEUpdation())}}addListenersForHistoricalEvents(){this.addEventHistListeners(),this.addEventHistSessionListeners(),this.addUrlChangeListener()}addListenerForSyEUpdation(){const e=window.VWO.phoenix.on(m.PAGE_VIEW,()=>{this.syncEvents=window.VWO._.allSettings.dataStore.syE||{},window.VWO._.ac.cSHS||(JSON.stringify(this.syncEvents)!==this.getItem("_vwo_syE")&&(Object.keys(this.syncEvents).length&&this.setItem("_vwo_syE",this.syncEvents),this.shouldSyncEvents&&(this.syncEventsData(),this.shouldSyncEvents=!1)),window._vis_debug&&window.VWO.phoenix.off(m.PAGE_VIEW,e))})}setEventHistInLS(e){if(this.eventHist[e].length){if(!this.isEventRegistered(e))return;this.setItem(this.VWO_EVENT_HISTORICAL_KEY,this.filterOutUnRegisteredEvents(this.eventHist))}else delete this.eventHist[e]}setSessionEventHistInLS(e){if(this.eventHistForCurrentSession[e].length){if(!this.isEventRegistered(e))return;this.setItem(this.VWO_EVENT_HISTORICAL_SESSION_KEY,this.filterOutUnRegisteredEvents(this.eventHistForCurrentSession))}else delete this.eventHistForCurrentSession[e]}deleteUncessaryProps(e){const t=Object.assign({},e);return delete t.name,delete t.props,delete t._meta,delete t.time,delete t.page.title,delete t.page.referrer,delete t.isCustomEvent,delete t.executingTagTrigger,delete t._vwo,t}updateEventHist(e,t){var i,n;if(!Do()&&!window._vis_heatmap&&(window.VWO._.ac.cSHS||(null===(i=window._vwoCc)||void 0===i?void 0:i.syncServerUrl)||Object.keys(this.syncEvents).length||Object.keys(this.currentSessionEvents).length)&&!t.aux)if(window.VWO._.ac.cSHS||(null===(n=window._vwoCc)||void 0===n?void 0:n.syncServerUrl)){this.eventHist[e]=this.eventHist[e]||[],this.eventHistForCurrentSession[e]=this.eventHistForCurrentSession[e]||[];const i=this.deleteUncessaryProps(t);this.eventHistForCurrentSession[e].push(Object.assign({},i)),this.setSessionEventHistInLS(e),i.ts=t.time,this.eventHist[e].push(i),this.setEventHistInLS(e)}else{if(Object.keys(this.syncEvents).length){if(this.eventHist[e]=this.eventHist[e]||[],Object.prototype.hasOwnProperty.call(this.syncEvents,"*")){const i=this.deleteUncessaryProps(t);i.ts=t.time,this.eventHist[e].push(i)}else if(Object.prototype.hasOwnProperty.call(this.syncEvents,e)){const i={};if(Array.isArray(this.syncEvents[e]))for(let n of this.syncEvents[e])void 0!==t[n]&&(i[n]=t[n]);i.ts=t.time,this.eventHist[e].push(i)}this.setEventHistInLS(e)}if(Object.keys(this.currentSessionEvents).length){if(this.eventHistForCurrentSession[e]=this.eventHistForCurrentSession[e]||[],Object.prototype.hasOwnProperty.call(this.currentSessionEvents,"*")){const i=this.deleteUncessaryProps(t);this.eventHistForCurrentSession[e].push(i)}else if(Object.prototype.hasOwnProperty.call(this.currentSessionEvents,e)){const i={};if(Array.isArray(this.currentSessionEvents[e]))for(let n of this.currentSessionEvents[e])void 0!==t[n]&&(i[n]=t[n]);this.eventHistForCurrentSession[e].push(i)}this.setSessionEventHistInLS(e)}}}syncEventsData(){return i(this,void 0,void 0,function*(){if(Do()||window._vis_heatmap||!Object.keys(this.syncEvents).length&&!this.customSyncURL)return;let e=yield od.getUUID(window.VWO.phoenix.store.getters),t="";if(window._vis_debug){const i=jr.get("_vwo_uuid",!1,!0);if(!i)return;window._vwo_exp&&Object.keys(window._vwo_exp).length&&(e=i,t="&cId="+Object.keys(window._vwo_exp).join("|"))}const i=this.customSyncURL||window._vwo_server_url||"https://dev.visualwebsiteoptimizer.com/",n="sync/events?a="+window._vwo_acc_id+"&uuid="+e+t;try{const e=yield fetch(i+n),t=yield e.json();this.eventHist=t,this.eventHist&&Object.keys(this.eventHist).length?this.setItem(this.VWO_EVENT_HISTORICAL_KEY,this.eventHist):this.removeItem(this.VWO_EVENT_HISTORICAL_KEY),window.VWO.phoenix.trigger(m.SYNC_EVENTS_COMPLETED),this.validateHistEventsPostSync()}catch(e){window.VWO.phoenix.trigger(m.SYNC_EVENTS_COMPLETED),this.validateHistEventsPostSync(),$o.warn("Error in syncing historical Events Data.")}})}validateHistEventsPostSync(){this.customSyncURL&&this.triggerEvents.forEach(e=>i(this,void 0,void 0,function*(){yield window.VWO.phoenix.validateAndDispatchTriggerEvent(e.triggerName,e.trigger,{useUnsavedEvents:!0},e.eventName)}))}getEventsByDate(e,t,i){var n,s;const r=Object.assign({},i);let o;if(delete r.isCustomEvent,delete r.name,"cs"===t)return o=[...this.eventHistForCurrentSession[e]||[],r],r.fromLocalStorage&&(o=[...this.eventHistForCurrentSession[e]||[]]),o;{o=[...this.eventHist[e]||[],Object.assign(Object.assign({},r),{ts:+new Date})],r.fromLocalStorage&&(o=[...this.eventHist[e]||[]]),r.useUnsavedEvents&&(o=[...this.eventHist[e]||[],...(null===(s=null===(n=window._VWO)||void 0===n?void 0:n.unsavedEventsHistory)||void 0===s?void 0:s[e])||[]]);const{firstDate:i,lastDate:a}=this.getDateRange(t,o),d=this.binSearchFirstIndex(i,o),l=this.binSearchLastIndex(a,o);return-1===d||-1===l?[]:o.slice(d,l+1)}}getDateRange(e,t){let i,n;const s=e.split("-"),r=s[0],o=s[1];return r===vc.SINCE?(n=new Date,i=new Date,o[o.length-1]===pc.DAYS?i.setDate(i.getDate()-Number(o.slice(0,o.length-1))):o[o.length-1]===pc.WEEKS?i.setDate(i.getDate()-7*Number(o.slice(0,o.length-1))):o[o.length-1]===pc.MONTHS?i.setMonth(i.getMonth()-Number(o.slice(0,o.length-1))):o[o.length-1]===pc.YEARS?i.setFullYear(i.getFullYear()-Number(o.slice(0,o.length-1))):i=new Date(o)):r===vc.FROM?(i=new Date(s[1]),n=new Date(s[2])):r===vc.WITHIN&&(i=new Date(t[0].ts),n=new Date(i),o[o.length-1]===pc.DAYS?n.setDate(i.getDate()+Number(o.slice(0,o.length-1))):o[o.length-1]===pc.WEEKS?n.setDate(i.getDate()+7*Number(o.slice(0,o.length-1))):o[o.length-1]===pc.MONTHS?n.setMonth(i.getMonth()+Number(o.slice(0,o.length-1))):o[o.length-1]===pc.YEARS?n.setFullYear(i.getFullYear()+Number(o.slice(0,o.length-1))):n=new Date(o)),i.setHours(0,0,0,0),n.setHours(23,59,59,59),i=+i,n=+n,{firstDate:i,lastDate:n}}binSearchFirstIndex(e,t){let i,n,s=0,r=t.length-1;for(;s<=r;)i=Math.floor((s-r)/2+r),n=t[i].ts,n>=e?r=i-1:s=i+1;return s>=t.length?-1:s}binSearchLastIndex(e,t){let i,n,s=0,r=t.length-1;for(;s<=r;)i=Math.floor((s-r)/2+r),n=t[i].ts,n>e?r=i-1:s=i+1;return r<0?-1:r}getCumulativeData(e,t){if(0===e.length)return{"*":{count:0}};const i={};for(let n in t){for(let s of e)i[n]=i[n]||{},"*"===n?(i[n].count=i[n].count||0,i["*"].count++):Object.prototype.hasOwnProperty.call(s,n)&&this.handleOps(s[n],t[n],i[n]);if(t[n].includes(hc.AVG)&&void 0!==i[n][hc.AVG]&&(i[n][hc.AVG]=i[n][hc.AVG].sum/i[n][hc.AVG].count),t[n].includes(hc.MEDIAN)&&void 0!==i[n][hc.MEDIAN]){const e=i[n][hc.MEDIAN],t=Math.floor(e.length/2),s=[...e].sort((e,t)=>e-t);i[n][hc.MEDIAN]=e.length%2!=0?s[t]:(s[t-1]+s[t])/2}}return i}handleOps(e,t,i){e=+e;for(let n of t)switch(n){case hc.COUNT:i.count=i.count||0,i.count++;break;case hc.SUM:i.sum=i.sum||0,i.sum+=e;break;case hc.MIN:i.min=Math.min(e,i.min||e);break;case hc.MAX:i.max=Math.max(e,i.max||e);break;case hc.FIRST_VALUE:void 0===i.first&&(i.first=e);break;case hc.LAST_VALUE:i.last=e;break;case hc.AVG:i.avg=i.avg||{},i.avg.sum=i.avg.sum||0,i.avg.sum+=e,i.avg.count=i.avg.count||0,i.avg.count++;break;case hc.MEDIAN:i.median=i.median||[],i.median.push(e)}}performSweep(){for(const e in this.eventHist)if(Object.prototype.hasOwnProperty.call(this.eventHist,e)){const t=(this.eventHist[e]||[]).filter(e=>!od.isTsExpired(+e.ts,this.SWEEP_INTERVAL_IN_DAYS));this.eventHist[e]=t,this.setEventHistInLS(e)}0===Object.keys(this.eventHist).length&&this.removeItem(this.VWO_EVENT_HISTORICAL_KEY)}}const Oc=new mc,Sc={get syncEvents(){return Oc.syncEvents},get syncAttributes(){return Cc.syncVisAttrs},get eventHistory(){return Oc.eventHist},get visitorProperties(){return Cc.visitorAttrs},clearHistoricalDataOfType(e){e===yc.Attributes?(z.remove(Cc.getKeyBasedOnMode("_vwo_syV")),z.remove(Cc.getKeyBasedOnMode("_vwo_visProps"))):e===yc.Events?(z.remove(Oc.getKeyBasedOnMode("_vwo_syE")),z.remove(Oc.getKeyBasedOnMode("_vwo_eventHist"))):e===yc.SessionEvents&&z.remove(Oc.getKeyBasedOnMode("_vwo_eventHistSession"))},clearHistoricalData(e,t){window.VWO._.ac.cSHS||(Object.keys(t).length||(z.remove(Oc.getKeyBasedOnMode("_vwo_syE")),z.remove(Oc.getKeyBasedOnMode("_vwo_eventHist"))),Array.isArray(e)&&(null==e?void 0:e.length)||z.remove(Cc.getKeyBasedOnMode("_vwo_syV")))},clearsyE(){z.remove(Oc.getKeyBasedOnMode("_vwo_syE"))},clearsyV(){z.remove(Cc.getKeyBasedOnMode("_vwo_syV"))}};var yc;!function(e){e[e.Attributes=0]="Attributes",e[e.Events=1]="Events",e[e.SessionEvents=2]="SessionEvents"}(yc||(yc={}));class Tc extends _c{constructor(){super(...arguments),this.visitorAttrKey="_vwo_visProps",this.areListenersAttachedAndStorageSyncerEnabled=!1}isAttributeRegistered(e){return R(()=>window.VWO._.allSettings.dataStore.visitorProps[e],{sendErrorLog:!1},!1)}filterOutUnRegisteredAttributes(e){return Object.keys(e).reduce((t,i)=>(this.isAttributeRegistered(i)&&(t[i]=e[i]),t),{})}initialize(){this.visitorAttrs=JSON.parse(this.getItem(this.visitorAttrKey)||"{}"),this.syncVisAttrs=window.VWO._.allSettings.dataStore.syV||{},this.customSyncURL=Jr(),this.syncAttrConfig=this.customSyncURL?m.SEND_SYNC_CALL:window.VWO._.allSettings.dataStore.syncAttr||"sessionCreated",window._vis_heatmap||(this.addListenerAndEnableStorageSyncer(),this.visitorAttrs&&Object.keys(this.visitorAttrs).length&&this.addAttrToGetters())}addListenerAndEnableStorageSyncer(){this.areListenersAttachedAndStorageSyncerEnabled||(R(()=>this.syncVisAttrs.length)&&!window.VWO._.ac.cSHS?(this.shouldSyncAttr=!0,this.addVisAttrListeners()):Sc.clearsyV(),this.storageSyncAcrossTabs(),this.areListenersAttachedAndStorageSyncerEnabled=!0)}storageSyncAcrossTabs(){window.VWO.modules.utils.storageSyncer.add(this.getKeyBasedOnMode(this.visitorAttrKey),e=>{try{this.visitorAttrs=JSON.parse(e)||{}}catch(e){}})}addVisAttrListeners(){Do()||(window._vis_debug?this.addListenerForSyVUpdation():("pageView"===this.syncAttrConfig?window.VWO.phoenix.on(m.PAGE_VIEW,()=>{this.syncVisAttrs=window.VWO._.allSettings.dataStore.syV,this.shouldSyncAttr&&(this.syncVisData(),this.shouldSyncAttr=!1)}):this.syncAttrConfig===m.SEND_SYNC_CALL?window.VWO.phoenix.on(m.SEND_SYNC_CALL,()=>{this.syncVisAttrs=window.VWO._.allSettings.dataStore.syV,this.shouldSyncAttr&&(this.syncVisData(),this.shouldSyncAttr=!1)}):"sessionCreated"===this.syncAttrConfig&&(window.VWO.phoenix.on(m.NEW_SESSION_CREATED,()=>{this.syncVisAttrs=window.VWO._.allSettings.dataStore.syV,this.shouldSyncAttr&&(this.syncVisData(),this.shouldSyncAttr=!1)}),window.VWO.phoenix.on(m.TRACK_NEW_SESSION_CREATED,()=>{this.syncVisAttrs=window.VWO._.allSettings.dataStore.syV,this.shouldSyncAttr&&(this.syncVisData(),this.shouldSyncAttr=!1)}),this.addListenerForSyVUpdation()),window.VWO.phoenix.on(m.URL_CHANGED,()=>{this.shouldSyncAttr=!0})))}addListenerForSyVUpdation(){const e=window.VWO.phoenix.on(m.PAGE_VIEW,()=>{this.syncVisAttrs=window.VWO._.allSettings.dataStore.syV,JSON.stringify(this.syncVisAttrs)!==this.getItem("_vwo_syV")&&(Array.isArray(this.syncVisAttrs)&&this.syncVisAttrs.length&&this.setItem("_vwo_syV",this.syncVisAttrs),this.shouldSyncAttr&&(this.syncVisData(),this.shouldSyncAttr=!1)),window._vis_debug&&window.VWO.phoenix.off(m.PAGE_VIEW,e)})}updateVisAttr(e){if(!window._vis_heatmap){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this.visitorAttrs[t]=e[t]);try{Object.keys(this.visitorAttrs).length&&this.setItem(this.visitorAttrKey,this.filterOutUnRegisteredAttributes(this.visitorAttrs))}catch(e){}}}syncVisData(){var e;return i(this,void 0,void 0,function*(){if(Do()||window._vis_heatmap||window.VWO._.ac.cSHS||(!Array.isArray(this.syncVisAttrs)||!(null===(e=this.syncVisAttrs)||void 0===e?void 0:e.length))&&!this.customSyncURL)return;if(yield dl()){const e=window.VWO.phoenix.on(m.NEW_SESSION_TRACKED,()=>{window.VWO.phoenix.off(m.NEW_SESSION_TRACKED,e),this.syncVisData()});return}let t=yield od.getUUID(window.VWO.phoenix.store.getters),i="";if(window._vis_debug){const e=jr.get("_vwo_uuid",!1,!0);if(!e)return;Object.keys(window._vwo_exp||{}).length&&(t=e,i="&cId="+Object.keys(window._vwo_exp).join("|"))}const n=this.customSyncURL||window._vwo_server_url||"https://dev.visualwebsiteoptimizer.com/",s="sync/attributes?a="+window._vwo_acc_id+"&uuid="+t+i;try{const e=yield fetch(n+s),t=yield e.json();this.visitorAttrs=t,this.visitorAttrs&&Object.keys(this.visitorAttrs).length?(this.setItem(this.visitorAttrKey,this.visitorAttrs),this.addAttrToGetters()):this.removeItem(this.visitorAttrKey)}catch(e){$o.warn("Error in syncing Historical Attributes Data.")}})}addAttrToGetters(){for(const e in this.visitorAttrs)Object.prototype.hasOwnProperty.call(this.visitorAttrs,e)&&window.VWO.phoenix.store.actions.set(e,this.visitorAttrs[e],"")}}const Cc=new Tc,Ic=/.*_vis_opt_exp_(\d+)_split.*/,Nc=(e,t,n)=>i(void 0,void 0,void 0,function*(){const s=Rr(),r=document.cookie.split("; ").map(e=>e.split("=")).map(([r,...o])=>i(void 0,void 0,void 0,function*(){const a=Ic.exec(r);if(!a)return Promise.resolve();const d=parseInt(a[1],10),l=e[d];return!l||(yield Td.getCombiCookie(t,d))?Promise.resolve():R(()=>i(void 0,void 0,void 0,function*(){const e=l.triggers[0];if((l.ss||{}).csa&&!(yield window.VWO.phoenix.validateTrigger(s[e])))return;const i=decodeURIComponent(o.join("=")),r=aa({campaignObj:l,cookieValue:i,getters:t});return null!==r?Ol.record(t,r,l,!0,n):void 0}))}));yield Promise.all(r)});function Ac(e,t,i){const n=window.VWO;switch(P(e)){case"tags":n.phoenix.tags.add(t,i.fn);break;case"operators":n.phoenix.operators.add(i.fn);break;case"storages":n.phoenix.storages.add(i);break;case"store":n.phoenix.store.actions.addValues(i)}}class Vc{config(e){return e&&(this.configSettings=e),this.configSettings}definePlugin(e,t={}){const i=e.split(".")[0],n=e.split(".")[1],s=window.VWO;s.phoenix?Ac(i,n,t):(s.pluginStorage=s.pluginStorage||{},s.pluginStorage[i]=s.pluginStorage[i]||{},n?(s.pluginStorage[i][n]=s.pluginStorage[i][n]||{},s.pluginStorage[i][n]=gc.mergeNestedObjects(s.pluginStorage[i][n],t)):s.pluginStorage[i]=gc.mergeNestedObjects(s.pluginStorage[i],t))}updateSettings(e,t,n){var s,r,o,a,d,l;return i(this,void 0,void 0,function*(){const i=window.VWO._.allSettings.dataStore.campaigns,c=this.phoenix.store.getters,u=null===(s=t.dataStore)||void 0===s?void 0:s.campaigns,g=Array.isArray(window._VWO.fSeg)?window._VWO.fSeg:[];if(Object.assign(window.VWO._.allSettings.triggers,t.triggers||{}),u)for(const e in u)(i[e]||g.includes(e))&&delete u[e];const h=window.VWO._.allSettings.dataStore.changeSets||{},v=(null===(r=t.dataStore)||void 0===r?void 0:r.changeSets)||{};Object.assign(h,v);const p=JSON.parse(JSON.stringify(u)),w=JSON.parse(JSON.stringify((null===(o=t.dataStore)||void 0===o?void 0:o.syE)||{})),E=JSON.parse(JSON.stringify((null===(a=t.dataStore)||void 0===a?void 0:a.syV)||{})),f=JSON.parse(JSON.stringify((null===(d=t.dataStore)||void 0===d?void 0:d.cSE)||{})),_=Object.keys(p);for(var O in u)window.VWO._.allSettings.dataStore.campaigns[O]=u[O],u[O]=window.VWO._.allSettings.dataStore.campaigns[O];this.phoenix.add(t),1!==n&&4!==n||window.VWO._.phoenixMT.trigger("vwo_campaignsLoaded"),od.checkAndInitializeDomEvents(),this.phoenix.store.actions.addValues({currentSettings:this.phoenix.settings.currentSettings},"root"),window.VWO._.allSettings.dataStore.syE=w,window.VWO._.allSettings.dataStore.syV=E,window.VWO._.allSettings.dataStore.cSE=f,window.VWO.modules.eventHistHandler.syncEvents=w,window.VWO.modules.eventHistHandler.currentSessionEvents=f,window.VWO.modules.eventHistHandler.addListenersForHistoricalEvents(),(window.VWO._.ac.cSHS||Array.isArray(E)&&(null==E?void 0:E.length))&&Cc.addListenerAndEnableStorageSyncer(),Sc.clearHistoricalData(E,w),fc(p);const S=cc.setFunnelExps(this.phoenix.store.getters);_.push(...S),od.setCampaignIds(_);for(const e in window.VWO._.allSettings.dataStore.campaigns)Object.prototype.hasOwnProperty.call(window.VWO._.allSettings.dataStore.campaigns,e)&&Il.serializeData(window.VWO._.allSettings.dataStore.campaigns[e]);if(window.fetcher.getValue("VWO._.loadNonTestingLibraries",[_,n]),2==n||5==n||4===n&&c.previousUrl&&c.previousUrl!==c.currentUrl?(this.phoenix.trigger(Mo.PAGE_LOAD_EVENT),yield od.firePageViewEvent({shouldFireDomLoad:!0})):Nc(br(),c,wc),(4===n||2==n)&&e)for(var O in p)od.isSessionBasedCampaign2(p[O])&&(null===(l=window.VWO._.track)||void 0===l?void 0:l.isUserBucketed())&&(yield ya(this.phoenix,m._ACTIVATED,{id:O}));window.VWO.push(["setVariation"])})}constructor(e){this.toJSON=function(){const e=Object.assign({},this);return delete e.modules,e},Object.keys(e).forEach(t=>{this[t]=e[t]})}addPhoenix(e){this.event=function(t,i,n,s){Jr()&&(window._VWO.unsavedEventsHistory=window._VWO.unsavedEventsHistory||{},window._VWO.unsavedEventsHistory[t]=window._VWO.unsavedEventsHistory[t]||[],window._VWO.unsavedEventsHistory[t].push(Object.assign(Object.assign({},i),{ts:Date.now(),VWO:{firedTime:this.ts}}))),(i=i||{}).isCustomEvent=!0,i.page=Tr.page,ya(e,t,i,e=>{var s;e.isSynced&&(i.isSynced=!0),window.VWO.modules.eventHistHandler.updateEventHist(t,i),Jr()&&(null===(s=window._VWO.unsavedEventsHistory)||void 0===s||delete s[t]),null==n||n()},s)},this.phoenix=e}splice(...e){const t=this.queue.splice.apply(this.queue,e);return this.length=this.queue.length,t}push(...e){const t=this.queue.push.apply(this.queue,e);return this.length=this.queue.length,this[this.length-1]=this.queue[this.queue.length-1],t}sort(...e){return this.queue.sort.apply(this.queue,e)}visitor(e){return i(this,void 0,void 0,function*(){if(!e)return;const t=e.$metaData;delete e.$metaData;for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.phoenix.store.actions.set(t,e[t],"");const i={$visitor:{props:e},$metaData:t,isCustomEvent:!0},n=e=>{ya(this.phoenix,m.SYNC_VISITOR_PROP,i,e)};if(yield dl()){const t=window.VWO.phoenix.on(m.NEW_SESSION_TRACKED,()=>{window.VWO.phoenix.off(m.NEW_SESSION_TRACKED,t),n()});return Cc.updateVisAttr(e)}n(()=>Cc.updateVisAttr(e))})}syncAttributes(){Cc.syncVisData()}syncEvents(){window.VWO.modules.eventHistHandler.syncEventsData()}}class bc{otherSide(...e){return e[0]="VWO.modules.tags.backwardCompatibilityUtils."+e[0],e[2]&&(e[2]={captureGroups:e[2]}),window.fetcher.getValue(...e)}}class Rc{}const Pc={primary:(e,t,i=!1,n,s)=>new Proxy(t,{construct(t,r){this.store=this.store||["1"];const o=new t(...r),a=this.store.length;this.store.push(o);let d=r;i&&(d=n(o)),Object.defineProperty(o,"otherSideCreated",{value:!1,enumerable:!1,writable:!0}),o.otherSide=(...e)=>o.otherSideCreated.then(()=>o.otherSide(...e).then(e=>e));const l={type:"vwoClassInstanceBridge",id:a,args:d,path:e};return o.otherSideCreated=new Promise(t=>{window.fetcher.request(l).send().then(i=>{o.otherSide=(...t)=>{const n=e.dest+"."+i+"."+t[0];return t[0]=n,window.fetcher.getValue(...t)},t(null),s&&s(i)})}),o},get(e,t){return"symbol"==typeof t||isNaN(+t)?e:this.store[t]}}),secondary:(e,t,i)=>new Proxy(t,{construct(e,t){this.store=this.store||["1"];const n=new e(...t),s=this.store.length;return this.store.push(n),i&&i(n),[s,n]},get(e,t){return"symbol"==typeof t||isNaN(+t)?e:this.store[t]}})};function Dc(e){const t=[];return e.forEach(e=>{var i;null===(i=e.filters)||void 0===i||i.forEach((i,n)=>{const s=i[0].substring(0,i[0].indexOf("."));if("event"===s||"page"===s){const s=JSON.parse(JSON.stringify(i));t.push({condition:s,triggerName:e.triggerName,condId:e.id,filterId:n,aux:e.aux})}})}),t}let xc,Lc={promise:new Promise(function(e){xc=e}),resolve:xc};class Uc extends Rc{constructor(e){super(),this.eventName=Mo.CLICK_EVENT,this.attachedFilters=e&&Dc(e)||[],window.VWO.isVwoClickClassInitialized=!0}initializeMT(){return[this.attachedFilters]}eventConditionsUpdate(e){var t;e&&(3===(null===(t=e[0])||void 0===t?void 0:t[sa])?this.otherSide("updateFunctionalTriggerFilters",[e[0]]):(this.attachedFilters=[...this.attachedFilters,...Dc(e)],this.otherSide("eventConditionsUpdate",[this.attachedFilters])))}isGoalEligible(e,t,i){return Il.isGoalEligible(e,window.VWO.phoenix.store.getters,window.VWO.phoenix)}registerConversion(e,t,n){return i(this,void 0,void 0,function*(){yield Il.registerConversion(window.VWO.phoenix.store.getters,t,n)})}on(e){Lc.promise.then(t=>{this.otherSide("on",[e,{serverUrl:t.serverUrl,vwoUUID:t.vwoUUID,useCapturePhase:t.settings.plugins.DACDNCONFIG.UCP}])})}off(){}otherSide(...e){throw new Error("entered into outdated otherSide")}}const Wc=Pc.primary({src:"VWO.modules.phoenixPlugins.events.predefinedEvents.ClickDomEvent",dest:"VWO.modules.phoenixPlugins.events.predefinedEvents.ClickDomEvent"},Uc,!0,e=>e.initializeMT());let Mc;window.VWO.modules.phoenixPlugins.events.predefinedEvents.ClickDomEvent=Wc;let kc={promise:new Promise(e=>{Mc=e}),resolve:Mc};class Gc extends Rc{constructor(e){super(),this.eventName=m.DOM_SUBMIT,this.attachedFilters=Dc(e)}initializeMT(){return[this.attachedFilters]}eventConditionsUpdate(e){var t;e&&(3===(null===(t=e[0])||void 0===t?void 0:t[sa])?this.otherSide("updateFunctionalTriggerFilters",[e[0]]):(this.attachedFilters=[...this.attachedFilters,...Dc(e)],this.otherSide("eventConditionsUpdate",[this.attachedFilters])))}isGoalEligible(e,t,i){return Il.isGoalEligible(e,window.VWO.phoenix.store.getters,window.VWO.phoenix)}registerConversion(e,t,n){return i(this,void 0,void 0,function*(){yield Il.registerConversion(window.VWO.phoenix.store.getters,t,n)})}on(e){kc.promise.then(t=>{this.otherSide("on",[e,{vwoUUID:t.vwoUUID,useCapturePhase:t.settings.plugins.DACDNCONFIG.UCP}])})}off(){}otherSide(...e){throw new Error("entered into outdated otherSide")}}const Fc=Pc.primary({src:"VWO.modules.phoenixPlugins.events.predefinedEvents.SubmitDomEvent",dest:"VWO.modules.phoenixPlugins.events.predefinedEvents.SubmitDomEvent"},Gc,!0,e=>e.initializeMT());let Hc;window.VWO.modules.phoenixPlugins.events.predefinedEvents.SubmitDomEvent=Fc;let jc={promise:new Promise(function(e){Hc=e}),resolve:Hc};class $c extends Rc{constructor(e){super(),this.eventName=Mo.HOVER_EVENT,this.attachedFilters=e&&Dc(e)||[],window.VWO.isVwoHoverClassInitialized=!0}initializeMT(){return[this.attachedFilters]}eventConditionsUpdate(e){e&&(this.attachedFilters=[...this.attachedFilters,...Dc(e)],this.otherSide("eventConditionsUpdate",[this.attachedFilters]))}on(e){jc.promise.then(t=>{this.otherSide("on",[e,{serverUrl:t.serverUrl,vwoUUID:t.vwoUUID,useCapturePhase:t.settings.plugins.DACDNCONFIG.UCP}])})}off(){}otherSide(...e){throw new Error("entered into outdated otherSide")}}const Bc=Pc.primary({src:"VWO.modules.phoenixPlugins.events.predefinedEvents.HoverDomEvent",dest:"VWO.modules.phoenixPlugins.events.predefinedEvents.HoverDomEvent"},$c,!0,e=>e.initializeMT());let Kc;window.VWO.modules.phoenixPlugins.events.predefinedEvents.HoverDomEvent=Bc;let zc={promise:new Promise(function(e){Kc=e}),resolve:Kc};class Yc extends Rc{constructor(e){super(),this.eventName=Mo.CHANGE_EVENT,this.attachedFilters=e&&Dc(e)||[],window.VWO.isVwoChangeClassInitialized=!0}initializeMT(){return[this.attachedFilters]}eventConditionsUpdate(e){e&&(this.attachedFilters=[...this.attachedFilters,...Dc(e)],this.otherSide("eventConditionsUpdate",[this.attachedFilters]))}on(e){zc.promise.then(t=>{this.otherSide("on",[e,{serverUrl:t.serverUrl,vwoUUID:t.vwoUUID,useCapturePhase:t.settings.plugins.DACDNCONFIG.UCP}])})}off(){}otherSide(...e){throw new Error("entered into outdated otherSide")}}const Jc=Pc.primary({src:"VWO.modules.phoenixPlugins.events.predefinedEvents.ChangeDomEvent",dest:"VWO.modules.phoenixPlugins.events.predefinedEvents.ChangeDomEvent"},Yc,!0,e=>e.initializeMT());let Xc;window.VWO.modules.phoenixPlugins.events.predefinedEvents.ChangeDomEvent=Jc;let qc={promise:new Promise(function(e){Xc=e}),resolve:Xc};class Qc extends Rc{constructor(e){super(),this.eventName=Mo.ELEMENT_VIEWED_EVENT,this.attachedFilters=e&&Dc(e)||[],window.VWO.isVwoElementViewedClassInitialized=!0}initializeMT(){return[this.attachedFilters]}eventConditionsUpdate(e){this.attachedFilters=[...this.attachedFilters,...Dc(e)],this.otherSide("eventConditionsUpdate",[this.attachedFilters])}on(e){qc.promise.then(t=>{this.otherSide("on",[e,{serverUrl:t.serverUrl,vwoUUID:t.vwoUUID,useCapturePhase:t.settings.plugins.DACDNCONFIG.UCP}])})}off(){}otherSide(...e){throw new Error("entered into outdated otherSide")}}const Zc=Pc.primary({src:"VWO.modules.phoenixPlugins.events.predefinedEvents.ElementViewedDomEvent",dest:"VWO.modules.phoenixPlugins.events.predefinedEvents.ElementViewedDomEvent"},Qc,!0,e=>e.initializeMT());window.VWO.modules.phoenixPlugins.events.predefinedEvents.ElementViewedDomEvent=Zc;const eu=function(){};class tu extends bc{sendRegisterCall(e,t,n,s,o){return i(this,void 0,void 0,function*(){if(s=s||eu,o.visDebug||Do())return s(),!0;var i,a,d=yield od.createUUIDCookie2(o,n),l=yield od.extraData2(),c="",u=null;if((yield o.vwoInternalProperties.sessionInfoService.shouldSendSessionInfoInCall())&&(c="&sId="+(u=yield o.vwoInternalProperties.sessionInfoService.getSessionId()),yield o.vwoInternalProperties.sessionInfoService.setSNCookieValueByIndex2(zs.SESSION_SYNCED_STATE_INDEX,1)),dr.includes(window._vwo_acc_id)&&"l.gif"==e){let e=window.localStorage.getItem("vwo_newSessionCreated");try{e=JSON.parse(e)||{}}catch(t){e={}}const t="new"==e.user;if(null==e||delete e.user,t){const t=0==Object.keys(e).length,i=!t&&(null==e?void 0:e.sessionId)!=u,s=!t&&(null==e?void 0:e.uuid)!=d;if(i||s||t){let a="Session didn't create properly due to";t&&(a+=" session call failure"),i&&(a+=" session id mismatch"),s&&(a+=" uuid mismatch"),r({msg:a,url:"utilsWT.ts",source:JSON.stringify({lastSessionData:e,current:{uuid:d,sessionIdStore:u,sessionCookie:window.VWO._.cookies.get(zs.TRACK_SESSION_COOKIE_NAME)},expId:(null==n?void 0:n.id)||"not-found",cURL:o.currentUrl})})}}}const g=encodeURIComponent(l),h=l;l=n.ps||void 0===n.ps?"&ed="+g:"",i="&s="+(n.version>=4?ba.data.vi&&"new"===ba.data.vi.vt?1:2:parseInt(((yield o.storages.storages.cookies.get("_vis_opt_s"))||"").split("|")[0],10)),a=e+"?experiment_id="+n.id+"&account_id="+o.accountId+"&cu="+encodeURIComponent(o.currentUrl)+"&combination="+t+i+c+od.getUUIDString(d)+l;try{l&&JSON.parse(decodeURIComponent(g)).lt}catch(t){r({msg:`extraData(ed) is not a JSON string [while sending call for '${e}']`,url:"utilsWT.ts",source:JSON.stringify({extraData:h,lt:(new Date).getTime(),referrer:yr.get(),requestURL:a})})}od.isSessionBasedCampaign2(n)||"SURVEY"===n.type||(yield this.otherSide('sendRegisterCall("${{1}}", "${{2}}", "${{3}}")',null,[o,a,s]))})}markRevenueGoal(e,t,n){return i(this,void 0,void 0,function*(){if(void 0!==(yield window.fetcher.getValue("_vis_opt_revenue"))){n.trigger(m.CONVERT_REVENUE_GOALS_FOR_EXPERIMENT,{oldArgs:[e.id,window._vis_opt_revenue]});const i=xs(e.goals);let s,r=i.length;for(;r--;)s=i[r],"REVENUE_TRACKING"===e.goals[s].type&&Il.isGoalEligible(e.goals[s],t,n)&&(yield Il.registerConversion(t,s,e,window._vis_opt_revenue))}})}pollForNewVisitor({vwoEvents:e,getters:t}){const n=this;od.addListener(t,e,{eventName:m.SEND_NEW_VISITOR_CALL},function(e){return i(this,void 0,void 0,function*(){const{combination:i,campaignData:s,callbackFn:r}=e;yield n.sendRegisterCall("l.gif",i,s,r,t)})})}goalRevenuePoll({vwoEvents:e,getters:t}){const n=this;od.addListener(t,e,{eventName:m.VARIATION_SHOWN},function(s){return i(this,void 0,void 0,function*(){const i=t.settings.campaigns[s.props.id];yield n.markRevenueGoal(i,t,e)})})}customGoalConversion(e,t){return i(this,void 0,void 0,function*(){const i=ba.phoenix.store.getters;if(isNaN(parseInt(e,10)))return;ba.phoenix.trigger(m.CONVERT_GOAL_FOR_ALL_EXPERIMENTS,{oldArgs:[e]}),ya(ba.phoenix,m.CUSTOM_CONVERSION,{gId:e,ins:!0});var n,s=xs(i.settings.campaigns);let r=s.length;for(;r--;)n=s[r],"object"==typeof i.settings.campaigns[n].goals[e]&&"TRACK"===i.settings.campaigns[n].type===t&&Il.isGoalEligible(i.settings.campaigns[n].goals[e],ba.phoenix.store.getters,ba.phoenix)&&(yield Il.registerConversion(ba.phoenix.store.getters,e,i.settings.campaigns[n]))})}customRevenueConversion(e,t){return i(this,void 0,void 0,function*(){const i=ba.phoenix.store.getters;if(isNaN(parseFloat(e)))return;var n,s,r;ba.phoenix.trigger(m.CONVERT_ALL_VISIT_GOALS_FOR_EXPERIMENT,{oldArgs:[e]}),ya(null,m.REVENUE_CONVERSION,{revenue:e,ins:!0});var o,a=xs(i.settings.campaigns);let d=a.length;for(;d--;)if(o=a[d],"TRACK"===i.settings.campaigns[o].type===t)for(r=(s=xs(i.settings.campaigns[o].goals)).length;r--;)n=s[r],"REVENUE_TRACKING"===i.settings.campaigns[o].goals[n].type&&Il.isGoalEligible(i.settings.campaigns[o].goals[n],window.VWO.phoenix.store.getters,window.VWO.phoenix)&&(yield Il.registerConversion(window.VWO.phoenix.store.getters,n,i.settings.campaigns[o],e))})}delayedGoalConversion(e){return i(this,void 0,void 0,function*(){let t;const i=ba.phoenix,n=i.store.getters,s=n.settings.campaigns[e.campaignId];e=e||{};const r=window.tracklib;"TRACK"===e.type?t=yield r.isGoalIncluded(e.goalId):"FUNNEL"===e.type?t=yield r.isFunnelIncluded(e.campaignId):od.isAnalyzeCampaign(e.type)&&(t=yield r.isAnalyzeCampaignIncluded(e.campaignId)),Il._triggerGoalConversion(i,n,e.goalId,s,e.revenue,!1,{combination:t})})}makeSessionAndTagCall(e,t){const n=this;od.addListener(e,t,{eventName:m.DIMENSION_TAG_PUSHED},function(e){return i(this,void 0,void 0,function*(){const{props:t}=e;yield n.otherSide('makeCallForTagsAndSession("${{1}}", "${{2}}")',null,[t,"sessionUpdate"])})})}initialise({event:e,actions:t,vwoEvents:n,data:s,getters:r}){return i(this,void 0,void 0,function*(){for(const e in r.settings.campaigns)Object.prototype.hasOwnProperty.call(r.settings.campaigns,e)&&Il.serializeData(r.settings.campaigns[e]);this.attachEventListeners(r),this.pollForNewVisitor({event:e,actions:t,vwoEvents:n,data:s,getters:r}),this.goalRevenuePoll({event:e,actions:t,vwoEvents:n,data:s,getters:r}),yield this.declareVWOAPI(),this.makeSessionAndTagCall(r,n)})}attachEventListeners(e){Lc.resolve(e),kc.resolve(e),jc.resolve(e),zc.resolve(e),qc.resolve(e)}declareVWOAPI(){return i(this,void 0,void 0,function*(){yield this.otherSide("declareVWOAPI()",null,[])})}}window.VWO.modules.tags.activate=function(){return i(this,void 0,void 0,function*(){const{getters:e,actions:t}=window.VWO.phoenix.store;nc.resetTriggerStates(),nc.resetExpParams(e,t),nc.resetTriggerExecutionCount(e),od.firePageViewEvent()})};const iu=new tu;window.VWO.modules.tags.backwardCompatibilityUtils=iu;class nu{}function su(...e){return e[0]="VWO.modules.tags."+e[0],e[2]&&(e[2]={captureGroups:e[2]}),window.fetcher.getValue(...e)}class ru extends nu{execute({event:e,actions:t,vwoEvents:n,data:s,getters:r}){return i(this,void 0,void 0,function*(){od.addListener(r,n,{eventName:"*"},function(e,t){su('wildCardCallback("${{1}}", "${{2}}")',null,[e,t])});const i=iu.initialise({event:e,actions:t,vwoEvents:n,data:s,getters:r}),o=window.fetcher.getValue("VWO.modules.tags.backwardCompatibility");yield Promise.all([i,o])})}}const ou=new ru,au=ou.execute;window.VWO.modules.tags.backwardCompatibility=au;class du extends Rc{constructor(e,t,i){super();const n=`${Uo.DOM}_`;this.eventName=e,this.domEventsDebounceTime=i,this.domEventName=e.includes(n)?e.substr(n.length):e,this.attachedFilters=Dc(t)}initializeMT(){return[this.eventName,this.domEventName,this.domEventsDebounceTime,this.attachedFilters]}eventConditionsUpdate(e){e&&(this.attachedFilters=[...this.attachedFilters,...Dc(e)],this.otherSide("eventConditionsUpdate",[this.attachedFilters]))}on(e){this.otherSide("on",[e])}off(){this.otherSide("off",[null])}otherSide(...e){throw new Error("entered into outdated otherSide")}}const lu=Pc.primary({src:"VWO.modules.phoenixPlugins.events.predefinedEvents.GenericDOMEvent",dest:"VWO.modules.phoenixPlugins.events.predefinedEvents.GenericDOMEvent"},du,!0,e=>e.initializeMT());window.VWO.modules.phoenixPlugins.events.predefinedEvents.GenericDOMEvent=lu;class cu extends Rc{constructor({occurrence:e=1e3}={}){super(),this.eventName=Wo.TIMER,this.occurrence=e,this.start=Date.now()}eventConditionsUpdate(){this.start=Date.now()}on(e){this.interval=window.setInterval(()=>{const t={time:Date.now(),timeSpent:Math.floor((Date.now()-this.start)/1e3)};e(t)},this.occurrence)}off(){window.clearInterval(this.interval)}}class uu extends Rc{constructor(e){super(),this.eventName=Mo.URL_CHANGE,this.events=e||["pushState","replaceState","hashchange","popstate"]}on(e){this.otherSide("on",[e])}off(){this.otherSide("off",[null])}otherSide(...e){throw new Error("entered into outdated otherSide")}}const gu=Pc.primary({src:"VWO.modules.phoenixPlugins.events.predefinedEvents.UrlChangeEvent",dest:"VWO.modules.phoenixPlugins.events.predefinedEvents.UrlChangeEvent"},uu);window.VWO.modules.phoenixPlugins.events.predefinedEvents.UrlChangeEvent=gu;class hu extends Rc{constructor(){super(...arguments),this.eventName=Mo.LEAVE_INTENT}on(e){this.otherSide("on",[e])}off(){this.otherSide("off",[null])}otherSide(...e){throw new Error("entered into outdated otherSide")}}const vu=Pc.primary({src:"VWO.modules.phoenixPlugins.events.predefinedEvents.LeaveIntentEvent",dest:"VWO.modules.phoenixPlugins.events.predefinedEvents.LeaveIntentEvent"},hu);window.VWO.modules.phoenixPlugins.events.predefinedEvents.LeaveIntentEvent=vu;class pu extends Rc{constructor(){super(...arguments),this.eventName=Mo.PAGE_LOAD_EVENT}on(e){this.otherSide("on",[e])}off(){this.otherSide("off",[null])}otherSide(...e){throw new Error("entered into outdated otherSide")}}const wu=Pc.primary({src:"VWO.modules.phoenixPlugins.events.predefinedEvents.PageLoadEvent",dest:"VWO.modules.phoenixPlugins.events.predefinedEvents.PageLoadEvent"},pu);window.VWO.modules.phoenixPlugins.events.predefinedEvents.PageLoadEvent=wu;class Eu{constructor(){this.eventName=m.PAGE_VIEW}on(){}off(){}eventConditionsUpdate(e){var t;3===(null===(t=e[0])||void 0===t?void 0:t[sa])&&this.otherSide("updateFunctionalTriggerFilters",e[0])}otherSide(e,...t){return window.fetcher.getValue(`window.VWO.modules.phoenixPlugins.events.predefinedEvents.PageViewEvent.${e}`,t)}}window.VWO.modules.phoenixPlugins.events.predefinedEvents.PageViewEvent=Eu;var fu=Object.freeze({__proto__:null,GenericDomEvent:lu,TimeEvent:cu,UrlChangeEvent:gu,LeaveIntentEvent:vu,ClickDomEvent:Wc,HoverDomEvent:Bc,ChangeDomEvent:Jc,ElementViewedDomEvent:Zc,SubmitDomEvent:Fc,PageLoadEvent:wu,PageViewEvent:Eu});const _u=e=>!!e,mu=function(e,t,i){if(e&&t){const n=e.countryCode,s=e.city,r=e.region;return Tu.f_in_list(n,t,i)||Tu.f_in_list(`${n}-${r}`,t,i)||Tu.f_in_list(`${n}-${r}-${s}`,t,i)}},Ou=function(e,t,i){if(e&&t){const n=e.countryCode,s=e.city,r=e.region;return Tu.f_nin_list(n,t,i)&&Tu.f_nin_list(`${n}-${r}`,t,i)&&Tu.f_nin_list(`${n}-${r}-${s}`,t,i)}},Su=(e,t,i)=>{if(!_u(e))return!1;const n=i.syncGet("fns.list",[e,t]);return!!n.dataPresent&&n.val},yu=(e,t,i)=>{if(""===e)return!0;if(!_u(e))return!1;const n=i.syncGet("fns.list",[e,t]);return!!n.dataPresent&&!n.val},Tu={f_in_list:Su,f_nin_list:yu,f_in_loc:mu,f_nin_loc:Ou};function Cu(e){window.VWO._.contentSyncService=new ld({strategy:["ls"]},e,window.VWO.data.content)}function Iu(){try{queueMicrotask(()=>{})}catch(e){self.queueMicrotask=function(e){Promise.resolve().then(e)}}}class Nu{constructor(){this.queue={}}add(e,t){this.queue[e]=this.queue[e]||[],this.queue[e].push(t),this.otherSide("addListener",[e])}processQueue(e,t){this.queue[e]&&this.queue[e].length&&this.queue[e].forEach(e=>{e(t)})}otherSide(...e){e[0]="VWO.modules.utils.storageSyncer."+e[0],window.fetcher.getValue(...e)}}const Au=new Nu;function Vu(){window.VWO.phoenix.on(m.CAMPAIGN_FLOW_START,()=>{window.VWO._.previewDebuggerBooted=new Promise(e=>{const t=window.VWO.phoenix.on(m.TIB_DONE,()=>{window.VWO.phoenix.off(m.TIB_DONE,t),e()})})})}window.VWO.modules.utils.storageSyncer=Au;const bu={BASE_PATH:"VWO._.phoenixMT",trigger(e,t){t?window.fetcher.getValue(`${this.BASE_PATH}.trigger("\${{1}}", "\${{2}}")`,null,{captureGroups:[e,t]}):window.fetcher.getValue(`${this.BASE_PATH}.trigger`,[e,t])},getEventHistory(e){return window.fetcher.getValue(`${this.BASE_PATH}.getEventHistory`,[e])}};window.functionWrapper=new oe,window.fetcher.init();const Ru=window.VWO;window.VWO._.cookieInitWT=e=>{R(()=>jr.setJar(e))},window.VWO._.phoenixMT=bu,window.setVWO=e=>{const t=new Vc(e);Ra(t),Pa(t),window.VWO.modules=Ru.modules,Object.assign(window.VWO._,Ru._)},window.phoenixInstantiate=()=>{var e;try{window=Object.assign(window,window.fakeWindow),delete window.fakeWindow,window.window=window,document=window.document;const t=window.VWO;window.VWO._.isWorkerThread=!0;const i=window.VWOSettings;if(i[1]=Object.assign(i[1],cc.getPhoenixConfig()),window.VWO.consentMode){const e=jr.get;jr.get=function(...t){const i=window.VWO.consentMode;if(!i.dT){if(i.hT){const e=window.VWO.modules.utils.consentModeUtils.getGoalCookie(t[0]);if(e)return e}return e.apply(jr,t)}}}i[1].storages.cookies=jr;const n=new Q;window._vwo_exp=window.VWO._.allSettings.dataStore.campaigns,window._vwo_exp=n.register(p.Object,"_vwo_exp",window._vwo_exp),window.VWO._.allSettings.dataStore.campaigns=window._vwo_exp,n.register(p.Document,"cookie"),window._vwo_surveySettings=n.register(p.Object,"_vwo_surveySettings",window._vwo_surveySettings),window.tracklib=n.register(p.Object,"",{},"",!1),n.register("custom","localStorage"),i[0]=window.VWO._.allSettings,t.definePlugin("props",Tr),i[2]=t.pluginStorage,window.VWO.modules.eventHistHandler=Oc,window.VWO.modules.eventHistHandler.initialize(),window.phoenix=new Cs(i,{preDefinedEvents:fu}),Cu(window.phoenix.store.getters.serverUrl),window.phoenix.store.actions.addValues({currentSettings:window.phoenix.settings.currentSettings},"root"),window.VWO.addPhoenix(window.phoenix),od.addListenerForSessionInitComplete(),od.isBot2()||od.checkAndInitializeDomEvents(),window.phoenix.store.getters.flags=window.phoenix.store.getters.flags||{},window.phoenix.store.getters.flags.cookieLessModeEnabled=!!window.VWO._.cLFE,Cc.initialize(),window.VWO.modules.eventHistHandler.clearHistEventData(),window.VWO.modules.eventHistHandler.addListenersForHistoricalEvents(),au({event:void 0,data:void 0,getters:window.phoenix.store.getters,actions:window.phoenix.store.actions,vwoEvents:window.phoenix}),t.phoenix.operators.add("inlist",function(e,t){return!!Tu.f_in_list(e,t,window.VWO._.contentSyncService)}),t.phoenix.operators.add("ninlist",function(e,t){return!!Tu.f_nin_list(e,t,window.VWO._.contentSyncService)}),t.phoenix.operators.add("inloclist",function(e,t){return!!Tu.f_in_loc(e,t,window.VWO._.contentSyncService)}),t.phoenix.operators.add("ninloclist",function(e,t){return!Tu.f_nin_loc(e,t,window.VWO._.contentSyncService)}),window.isInsightsOnConsentEnabled&&(t._.insightsOnConsentPromise=new Promise(e=>{t.phoenix.on("trigger.InsightsOnConsentTrigger",e)})),window.VWO.phoenix.store.getters.settings.campaigns=window._vwo_exp,i[1].storages.cookies.domain=window.VWO.phoenix.store.getters.cookieDomain;const s=window.phoenix.store.getters,r=s.settings.plugins,o={vwoData:{accountJSInfo:null===(e=s.settings.vwoData)||void 0===e?void 0:e.accountJSInfo}};r&&(o.plugins={DACDNCONFIG:r.DACDNCONFIG}),window.phoenix.on(m.RETRACK_VISITOR,()=>{const{getters:e,actions:t}=window.VWO.phoenix.store;nc.resetExpParams(e,t,!0)}),Iu(),Na();const a=()=>{Vu(),window.VWO._.visibilityTriggered=new Promise(e=>{const t=window.phoenix.on(m.VISIBILITY_TRIGGERED,()=>{window.phoenix.off(t),e()})}),Jr()&&(window.VWO._.syncEventsCallCompleted=new Promise(e=>{const t=window.phoenix.on(m.SYNC_EVENTS_COMPLETED,()=>{window.phoenix.off(t),e()})})),R(()=>window.VWO._.insightsUtils.activateFunnels()),Jr()&&ya(t.phoenix,m.SEND_SYNC_CALL,{}),ya(t.phoenix,m.POST_INIT,{}).then(()=>{window.fetcher.getValue("VWO.modules.utils.libUtils.initAuxiliaryPageView")})};return queueMicrotask(a),{cookieDomain:s.cookieDomain,accountId:s.accountId,flags:s.flags,vwoInternalProperties:{},settings:o}}catch(e){window.vwo_libExecuted=!0,window.fetcher.setValue("vwo_libExecuted",!0),window.fetcher.getValue("window._removeVwoGlobalStyle"),$o.error("Error in phoenix initialization at worker:",e.stack)}}})();
