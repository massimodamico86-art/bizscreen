---
phase: 08-page-refactoring
plan: 10
type: execute
wave: 1
depends_on: []
files_modified:
  - src/pages/PlaylistEditorPage.jsx
  - src/pages/components/PlaylistEditorComponents.jsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "PlaylistEditorPage.jsx is under 700 lines"
    - "Inline components are extracted to separate file"
    - "Page functionality is unchanged after extraction"
  artifacts:
    - path: "src/pages/components/PlaylistEditorComponents.jsx"
      provides: "Extracted components for PlaylistEditorPage"
      exports: ["PlaylistStripItem", "LibraryMediaItem", "AiSuggestModal", "ApprovalModal", "PreviewLinksModal", "SaveAsTemplateModal"]
    - path: "src/pages/PlaylistEditorPage.jsx"
      provides: "Main page component"
      max_lines: 700
  key_links:
    - from: "src/pages/PlaylistEditorPage.jsx"
      to: "src/pages/components/PlaylistEditorComponents.jsx"
      via: "import statement"
      pattern: "from.*PlaylistEditorComponents"
---

<objective>
Extract inline components from PlaylistEditorPage.jsx to reach 700-line target.

Purpose: PlaylistEditorPage is 48% over target (1036 lines vs 700). Hook extraction (08-03) moved state logic out but inline UI components remain. Extracting only PlaylistStripItem (~110 lines) and LibraryMediaItem (~56 lines) would leave ~869 lines - STILL OVER TARGET. Additional modal extraction is required.

Output: PlaylistEditorPage.jsx under 700 lines with all inline components extracted to src/pages/components/PlaylistEditorComponents.jsx
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-page-refactoring/08-VERIFICATION.md
@src/pages/PlaylistEditorPage.jsx
@src/pages/hooks/usePlaylistEditor.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extract all inline components</name>
  <files>
    src/pages/components/PlaylistEditorComponents.jsx
    src/pages/PlaylistEditorPage.jsx
  </files>
  <action>
Create src/pages/components/PlaylistEditorComponents.jsx containing:

1. Move these inline components from PlaylistEditorPage.jsx:
   - PlaylistStripItem (lines 69-177, ~110 lines) - draggable strip item with duration control
   - LibraryMediaItem (lines 181-235, ~56 lines) - library media item for adding to playlist

2. ALSO extract these modals to reach target (REQUIRED - extracting only the above leaves 869 lines, still over 700):
   - AiSuggestModal (lines 752-841, ~90 lines) - AI slide generation modal
   - ApprovalModal (lines 843-873, ~31 lines) - Request approval modal
   - PreviewLinksModal (lines 875-962, ~88 lines) - Preview links management modal
   - SaveAsTemplateModal (lines 964-1031, ~68 lines) - Save playlist as template modal

3. Add necessary imports at top of new file:
   - React hooks (useRef, useState, useCallback)
   - Design system components (Button, Card)
   - Lucide icons (Image, Video, Music, FileText, Globe, GripVertical, X, Minus, Plus, Wand2, Sparkles, Loader2, Check, Send, Link2, Copy, ExternalLink, Trash2, BookmarkPlus, Grid3X3, Palette)
   - MEDIA_TYPE_ICONS constant (define in component file or accept as prop)

4. Export all 6 components.

5. Update PlaylistEditorPage.jsx:
   - Import all components from './components/PlaylistEditorComponents'
   - Remove all inline component definitions
   - Keep only: imports, MEDIA_TYPE_ICONS constant, FILTER_TABS constant, and main PlaylistEditorPage component

6. Ensure all modal props are passed through correctly:
   - AiSuggestModal: { showAiModal, setShowAiModal, aiGenerating, aiSlideCount, setAiSlideCount, aiSuggestion, setAiSuggestion, aiApplying, handleGenerateAiSlides, handleApplyAiSlides }
   - ApprovalModal: { showApprovalModal, setShowApprovalModal, approvalMessage, setApprovalMessage, submittingApproval, handleRequestApproval }
   - PreviewLinksModal: { showPreviewModal, setShowPreviewModal, previewLinks, loadingPreviewLinks, creatingPreviewLink, selectedExpiry, setSelectedExpiry, allowComments, setAllowComments, copiedLinkId, handleCreatePreviewLink, handleRevokePreviewLink, handleCopyLink }
   - SaveAsTemplateModal: { showTemplateModal, setShowTemplateModal, templateName, setTemplateName, templateDescription, setTemplateDescription, savingTemplate, handleSaveAsTemplate, items, formatDuration, getTotalDuration }

7. Line count math:
   - Current: 1036 lines
   - PlaylistStripItem + LibraryMediaItem: ~167 lines
   - AiSuggestModal: ~90 lines
   - ApprovalModal: ~31 lines
   - PreviewLinksModal: ~88 lines
   - SaveAsTemplateModal: ~68 lines
   - Total extraction: ~444 lines
   - Expected result: 1036 - 444 = ~592 lines (well under 700)
  </action>
  <verify>
    - `wc -l src/pages/PlaylistEditorPage.jsx` shows under 700 lines
    - `wc -l src/pages/components/PlaylistEditorComponents.jsx` shows ~450+ lines
    - `npm run lint -- src/pages/PlaylistEditorPage.jsx src/pages/components/PlaylistEditorComponents.jsx` passes
    - `npm run build` succeeds
  </verify>
  <done>PlaylistEditorPage.jsx is under 700 lines, all inline components extracted</done>
</task>

<task type="auto">
  <name>Task 2: Verify page functionality</name>
  <files>src/pages/PlaylistEditorPage.jsx</files>
  <action>
1. Run existing tests:
   - `npm test -- --run` (should pass all tests)

2. Check that imports resolve:
   - No "module not found" errors
   - All 6 components imported and used

3. Confirm drag-drop still works:
   - PlaylistStripItem receives drag handlers from parent
   - Drag state (isDragOver, isDragging) passed as props

4. Confirm all modals render:
   - AI Suggest Modal opens and closes
   - Approval Modal opens and closes
   - Preview Links Modal opens and closes
   - Save as Template Modal opens and closes
  </action>
  <verify>
    - `npm test -- --run` passes
    - `npm run build` succeeds
    - Grep confirms components imported: `grep "from.*PlaylistEditorComponents" src/pages/PlaylistEditorPage.jsx`
  </verify>
  <done>All tests pass, build succeeds, all functionality preserved</done>
</task>

</tasks>

<verification>
- PlaylistEditorPage.jsx line count under 700
- PlaylistEditorComponents.jsx exports all 6 components
- npm run lint passes for both files
- npm run build succeeds
- npm test passes
</verification>

<success_criteria>
1. PlaylistEditorPage.jsx is under 700 lines
2. All 6 components extracted: PlaylistStripItem, LibraryMediaItem, AiSuggestModal, ApprovalModal, PreviewLinksModal, SaveAsTemplateModal
3. Drag-drop functionality works (handlers passed as props)
4. All modals work (open, close, submit)
5. Build and tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/08-page-refactoring/08-10-SUMMARY.md`
</output>
