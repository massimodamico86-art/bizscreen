---
phase: 08-page-refactoring
plan: 11
type: execute
wave: 1
depends_on: []
files_modified:
  - src/pages/CampaignEditorPage.jsx
  - src/pages/components/CampaignEditorComponents.jsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "CampaignEditorPage.jsx is under 600 lines"
    - "All inline modal components are extracted"
    - "Page functionality is unchanged after extraction"
  artifacts:
    - path: "src/pages/components/CampaignEditorComponents.jsx"
      provides: "Extracted modals for CampaignEditorPage"
      exports: ["TargetPickerModal", "ContentPickerModal"]
    - path: "src/pages/CampaignEditorPage.jsx"
      provides: "Main page component"
      max_lines: 600
  key_links:
    - from: "src/pages/CampaignEditorPage.jsx"
      to: "src/pages/components/CampaignEditorComponents.jsx"
      via: "import statement"
      pattern: "from.*CampaignEditorComponents"
---

<objective>
Extract inline modal components from CampaignEditorPage.jsx to reach 600-line target.

Purpose: CampaignEditorPage is 76% over target (1054 lines vs 600). Hook extraction (08-02) moved state logic out but ~450 lines of inline modals remain: TargetPickerModal (~150 lines) and ContentPickerModal (~150 lines), plus approval/preview UI.

Output: CampaignEditorPage.jsx under 600 lines with modals extracted to src/pages/components/CampaignEditorComponents.jsx
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-page-refactoring/08-VERIFICATION.md
@src/pages/CampaignEditorPage.jsx
@src/pages/hooks/useCampaignEditor.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extract modal components</name>
  <files>
    src/pages/components/CampaignEditorComponents.jsx
    src/pages/CampaignEditorPage.jsx
  </files>
  <action>
Create src/pages/components/CampaignEditorComponents.jsx containing:

1. Move these inline components from CampaignEditorPage.jsx:
   - TargetPickerModal (line ~792, ~150 lines) - picks screens/groups/locations for campaign targets
   - ContentPickerModal (line ~943, ~110 lines) - picks playlists/layouts for campaign content

2. Add necessary imports at top of new file:
   - React hooks (useState, useMemo)
   - Design system components (Modal, ModalHeader, ModalTitle, ModalContent, ModalFooter, Button, Input, FormField)
   - Lucide icons (Search, Monitor, MapPin, Users, X, Check, etc.)

3. Export both modal components.

4. Update CampaignEditorPage.jsx:
   - Import TargetPickerModal and ContentPickerModal from './components/CampaignEditorComponents'
   - Remove inline modal function definitions
   - Keep main CampaignEditorPage component, useCampaignEditor import, and inline approval/preview UI

5. If page is still over 600 lines after extracting main modals:
   - Look for additional extractable UI sections
   - Consider extracting approval status display, preview panel, or other large inline blocks
   - Extract any helper functions that are UI-specific

6. Modal props interface should remain the same:
   - TargetPickerModal: { screens, screenGroups, locations, existingTargets, onSelect, onClose }
   - ContentPickerModal: { playlists, layouts, existingContents, onSelect, onClose }
  </action>
  <verify>
    - `wc -l src/pages/CampaignEditorPage.jsx` shows under 600 lines
    - `wc -l src/pages/components/CampaignEditorComponents.jsx` shows ~300+ lines
    - `npm run lint -- src/pages/CampaignEditorPage.jsx src/pages/components/CampaignEditorComponents.jsx` passes
    - `npm run build` succeeds
  </verify>
  <done>CampaignEditorPage.jsx is under 600 lines, modals extracted</done>
</task>

<task type="auto">
  <name>Task 2: Verify page functionality</name>
  <files>src/pages/CampaignEditorPage.jsx</files>
  <action>
1. Run existing tests:
   - `npm test -- --run` (should pass all tests)

2. Check that imports resolve:
   - No "module not found" errors
   - TargetPickerModal and ContentPickerModal imported and used

3. Confirm modal functionality:
   - Target picker shows screens, groups, locations
   - Content picker shows playlists, layouts
   - onSelect callbacks work correctly
   - onClose callbacks work correctly
  </action>
  <verify>
    - `npm test -- --run` passes
    - `npm run build` succeeds
    - Grep confirms modals imported: `grep "from.*CampaignEditorComponents" src/pages/CampaignEditorPage.jsx`
  </verify>
  <done>All tests pass, build succeeds, modal functionality preserved</done>
</task>

</tasks>

<verification>
- CampaignEditorPage.jsx line count under 600
- CampaignEditorComponents.jsx exports TargetPickerModal and ContentPickerModal
- npm run lint passes for both files
- npm run build succeeds
- npm test passes
</verification>

<success_criteria>
1. CampaignEditorPage.jsx is under 600 lines
2. TargetPickerModal and ContentPickerModal are extracted
3. Modal functionality works (picker selection, callbacks)
4. Build and tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/08-page-refactoring/08-11-SUMMARY.md`
</output>
