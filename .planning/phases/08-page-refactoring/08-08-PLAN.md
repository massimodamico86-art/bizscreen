---
phase: 08-page-refactoring
plan: 08
type: execute
wave: 1
depends_on: []
files_modified:
  - src/pages/MediaLibraryPage.jsx
  - src/pages/components/MediaLibraryComponents.jsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "MediaLibraryPage.jsx is under 800 lines"
    - "All inline components are removed from page file"
    - "Page imports and uses components from MediaLibraryComponents.jsx"
    - "Page functionality is unchanged after refactoring"
  artifacts:
    - path: "src/pages/MediaLibraryPage.jsx"
      provides: "Main page component using imported sub-components"
      max_lines: 800
    - path: "src/pages/components/MediaLibraryComponents.jsx"
      provides: "All extracted sub-components"
      exports: ["LimitWarningBanner", "MediaListRow", "MediaGridCard", "FolderGridCard", "FolderBreadcrumbs", "DeleteConfirmModal", "LimitReachedModal", "FolderCreateModal", "MoveToFolderModal", "AddToPlaylistModal", "SetToScreenModal"]
  key_links:
    - from: "src/pages/MediaLibraryPage.jsx"
      to: "src/pages/components/MediaLibraryComponents.jsx"
      via: "import statement"
      pattern: "from.*MediaLibraryComponents"
---

<objective>
Refactor MediaLibraryPage.jsx to use existing extracted components from MediaLibraryComponents.jsx.

Purpose: MediaLibraryPage is 104% over target (1629 lines vs 800). The extracted components file ALREADY EXISTS (src/pages/components/MediaLibraryComponents.jsx, 805 lines) with all the sub-components, but the page is NOT importing them. The inline definitions are duplicated. This plan wires the page to use the extracted components.

Output: MediaLibraryPage.jsx under 800 lines by removing inline component definitions and importing from MediaLibraryComponents.jsx
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-page-refactoring/08-VERIFICATION.md
@src/pages/MediaLibraryPage.jsx
@src/pages/components/MediaLibraryComponents.jsx
@src/pages/hooks/useMediaLibrary.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Wire page to use extracted components</name>
  <files>
    src/pages/MediaLibraryPage.jsx
    src/pages/components/MediaLibraryComponents.jsx
  </files>
  <action>
1. First, verify the exported components in MediaLibraryComponents.jsx match what the page needs:
   - LimitWarningBanner
   - MediaListRow
   - MediaGridCard
   - FolderGridCard
   - FolderBreadcrumbs
   - DeleteConfirmModal
   - LimitReachedModal
   - FolderCreateModal
   - MoveToFolderModal
   - AddToPlaylistModal
   - SetToScreenModal

2. In MediaLibraryPage.jsx:
   a. Add import statement:
      ```javascript
      import {
        LimitWarningBanner,
        MediaListRow,
        MediaGridCard,
        FolderGridCard,
        FolderBreadcrumbs,
        DeleteConfirmModal,
        LimitReachedModal,
        FolderCreateModal,
        MoveToFolderModal,
        AddToPlaylistModal,
        SetToScreenModal,
      } from './components/MediaLibraryComponents';
      ```

   b. Remove ALL inline component definitions:
      - const LimitWarningBanner (line ~130)
      - const MediaListRow (line ~152)
      - const MediaGridCard (line ~243)
      - const FolderGridCard (line ~380)
      - const FolderBreadcrumbs (line ~449)
      - const DeleteConfirmModal (line ~481)
      - const LimitReachedModal (line ~570)
      - const FolderCreateModal (line ~623)
      - const MoveToFolderModal (line ~667)
      - const AddToPlaylistModal (line ~736)
      - const SetToScreenModal (line ~801)

   c. Keep only:
      - Imports at top (add new component import)
      - MEDIA_TYPE_ICONS and MEDIA_TYPE_LABELS constants
      - MediaLibraryPage main component

3. If any props differ between inline and extracted versions, update the extracted component file to match what the page passes.

4. Ensure constants (MEDIA_TYPE_ICONS, MEDIA_TYPE_LABELS) are either:
   - Kept in page if only used there, OR
   - Added to MediaLibraryComponents.jsx and exported if used by sub-components
  </action>
  <verify>
    - `wc -l src/pages/MediaLibraryPage.jsx` shows under 800 lines
    - `grep "from.*MediaLibraryComponents" src/pages/MediaLibraryPage.jsx` shows import
    - `npm run lint -- src/pages/MediaLibraryPage.jsx` passes
    - `npm run build` succeeds
  </verify>
  <done>MediaLibraryPage.jsx is under 800 lines, imports components from MediaLibraryComponents.jsx</done>
</task>

<task type="auto">
  <name>Task 2: Verify page functionality</name>
  <files>src/pages/MediaLibraryPage.jsx</files>
  <action>
1. Run existing tests:
   - `npm test -- --run` (should pass all tests)

2. Verify build succeeds:
   - No "module not found" errors
   - No prop type mismatches in console

3. Confirm all modals and components render:
   - DeleteConfirmModal, LimitReachedModal, FolderCreateModal, MoveToFolderModal, AddToPlaylistModal, SetToScreenModal
   - MediaGridCard, MediaListRow, FolderGridCard, FolderBreadcrumbs, LimitWarningBanner
  </action>
  <verify>
    - `npm test -- --run` passes
    - `npm run build` succeeds without warnings
    - No inline const definitions for the 11 extracted components remain in page
  </verify>
  <done>All tests pass, build succeeds, page uses imported components exclusively</done>
</task>

</tasks>

<verification>
- MediaLibraryPage.jsx line count under 800
- Import from MediaLibraryComponents.jsx present
- No inline component definitions remain
- npm run lint passes
- npm run build succeeds
- npm test passes
</verification>

<success_criteria>
1. MediaLibraryPage.jsx is under 800 lines
2. Page imports all 11 sub-components from MediaLibraryComponents.jsx
3. No duplicate inline component definitions in page
4. Page functionality unchanged (grid/list views, modals, folders work)
5. Build and tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/08-page-refactoring/08-08-SUMMARY.md`
</output>
