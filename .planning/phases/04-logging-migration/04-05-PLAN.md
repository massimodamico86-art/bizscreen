---
phase: 04-logging-migration
plan: 05
type: execute
wave: 2
depends_on: ["04-01"]
files_modified:
  - src/Player.jsx
  - src/TV.jsx
  - src/App.jsx
  - src/supabase.js
  - src/hooks/*.js
  - src/contexts/*.jsx
  - src/components/**/*.jsx
  - src/pages/**/*.jsx
  - src/player/*.js
  - src/auth/*.jsx
  - src/config/*.js
  - src/utils/*.js
autonomous: true

must_haves:
  truths:
    - "Player.jsx and TV.jsx use structured logging for offline debugging"
    - "React components use useLogger hook"
    - "Pages use consistent logging patterns"
    - "Hooks use scoped logger"
  artifacts:
    - path: "src/Player.jsx"
      provides: "Player with structured logging"
      contains: "useLogger"
    - path: "src/TV.jsx"
      provides: "TV display with structured logging"
      contains: "useLogger"
    - path: "src/App.jsx"
      provides: "App root with structured logging"
      contains: "useLogger"
  key_links:
    - from: "src/Player.jsx"
      to: "src/hooks/useLogger.js"
      via: "import useLogger"
      pattern: "import.*useLogger"
    - from: "src/pages/MediaLibraryPage.jsx"
      to: "src/hooks/useLogger.js"
      via: "import useLogger"
      pattern: "import.*useLogger"
---

<objective>
Migrate Player, hooks, components, and pages to structured logging.

Purpose: Complete the frontend migration. Player.jsx is critical for offline debugging. Pages and components round out the migration. This is the largest batch (~500 console calls across ~120 files).

Output: All React components, pages, hooks, and utility files use structured logging.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-logging-migration/04-RESEARCH.md
@.planning/phases/04-logging-migration/04-01-SUMMARY.md
@src/hooks/useLogger.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Player, TV, App, and core files</name>
  <files>
    src/Player.jsx
    src/TV.jsx
    src/App.jsx
    src/supabase.js
    src/getConfig.js
    src/config/env.js
    src/player/cacheService.js
    src/player/offlineService.js
    src/auth/AuthCallbackPage.jsx
    src/i18n/I18nContext.jsx
    src/contexts/BrandingContext.jsx
  </files>
  <action>
Migrate core application files (~90 console calls):

1. For Player.jsx (47 calls - largest single file):
   - Add: `import { useLogger } from './hooks/useLogger.js';`
   - Add in component: `const logger = useLogger('Player');`
   - Transform all console calls:
     - Startup: logger.info('Player initialized', { screenId })
     - Content load: logger.debug('Loading content', { contentId })
     - Playback events: logger.debug('Content playing', { contentId, duration })
     - Offline switch: logger.warn('Switching to offline mode')
     - Errors: logger.error('Playback error', { error, contentId })
   - This component runs on player devices - logging is critical for debugging

2. For TV.jsx (6 calls):
   - Use useLogger hook
   - Display events: logger.info('Display mode changed', { mode })

3. For App.jsx (10 calls):
   - Use useLogger hook
   - App lifecycle: logger.info('App mounted')
   - Route changes: logger.debug if needed, or remove

4. For supabase.js (7 calls):
   - Use createScopedLogger (not useLogger - not a React component)
   - Connection events: logger.info/warn/error as appropriate

5. For config/env.js (5 calls):
   - These are validation/init logs - can use createScopedLogger
   - Or remove if truly one-time and not valuable

6. For player/ directory (cacheService, offlineService - 40 calls):
   - Use createScopedLogger (not React components)
   - Cache operations: logger.debug
   - Sync events: logger.info
   - Errors: logger.error

7. For contexts (BrandingContext, I18nContext):
   - Use useLogger hook inside Provider component

8. For auth/AuthCallbackPage.jsx:
   - Use useLogger hook
  </action>
  <verify>
1. `grep -c "console\." src/Player.jsx` returns 0
2. `grep -c "console\." src/TV.jsx` returns 0
3. `grep -c "console\." src/App.jsx` returns 0
4. `npm run build` succeeds
  </verify>
  <done>Core application files (11 files, ~90 calls) migrated to structured logging</done>
</task>

<task type="auto">
  <name>Task 2: Migrate hooks and utility files</name>
  <files>
    src/hooks/useFeatureFlag.jsx
    src/hooks/useLayout.js
    src/hooks/useLayoutTemplates.js
    src/hooks/useAdmin.js
    src/hooks/useCloudinaryUpload.js
    src/hooks/usePrefetch.js
    src/hooks/useS3Upload.jsx
    src/hooks/usePlayerMetrics.js
    src/hooks/useMediaFolders.js
    src/hooks/useMedia.js
    src/hooks/useAuditLogs.js
    src/hooks/useDataCache.js
    src/utils/errorTracking.js
    src/utils/logger.js
    src/utils/observability.js
    src/utils/errorMessages.js
    src/security/sanitize.js
    src/legacy/utils/performance.js
  </files>
  <action>
Migrate hooks and utilities (~55 console calls):

1. For hooks (12 files, 44 calls):
   - Hooks can use createScopedLogger (simpler than useLogger for non-rendering code)
   - Add at top: `import { createScopedLogger } from '../services/loggingService.js';`
   - Create logger: `const logger = createScopedLogger('useHookName');`

   - useMediaFolders (12 calls): Most verbose hook
     - Folder operations: logger.debug
     - Errors: logger.error

   - useMedia (7 calls): Media operations
     - Load/save: logger.debug
     - Errors: logger.error

   - useCloudinaryUpload (6 calls): Upload hook
     - Upload progress: logger.debug
     - Errors: logger.error

   - Other hooks: Apply same pattern

2. For utils/errorTracking.js (10 calls):
   - This is special - it initializes Sentry
   - Keep minimal console.warn for Sentry init failures (fallback when logging itself fails)
   - Other logs can use structured logger
   - Be careful not to create circular dependency with loggingService

3. For utils/logger.js (4 calls):
   - This is the OLD logger being deprecated
   - Mark with TODO comment for removal in Plan 06
   - Don't migrate - we're replacing it

4. For security/sanitize.js (1 call):
   - Use createScopedLogger

5. For legacy/utils/performance.js (2 calls):
   - Use createScopedLogger
  </action>
  <verify>
1. `grep -r "console\." src/hooks/*.js src/hooks/*.jsx | wc -l` returns 0 or near-zero
2. `npm run build` succeeds
  </verify>
  <done>Hooks and utilities (18 files, ~55 calls) migrated to structured logging</done>
</task>

<task type="auto">
  <name>Task 3: Migrate components and pages</name>
  <files>
    src/components/**/*.jsx
    src/pages/**/*.jsx
  </files>
  <action>
Migrate all remaining components and pages (~420 console calls across ~95 files):

This is the bulk migration. Use systematic approach:

1. For React components (39 files, 111 calls):
   - Use useLogger hook in each component:
     ```jsx
     import { useLogger } from '../hooks/useLogger.js';
     // or adjust path as needed

     function MyComponent() {
       const logger = useLogger('MyComponent');
       // ...
     }
     ```
   - High-call components to prioritize:
     - FabricSvgEditor.jsx (31 calls)
     - QRCodeManager.jsx (9 calls)
     - EditorCanvas.jsx (5 calls)
     - LeftSidebar.jsx (5 calls)

2. For pages (54 files, 311 calls):
   - Same pattern with useLogger
   - High-call pages to prioritize:
     - MediaLibraryPage.jsx (23 calls)
     - ScreensPage.jsx (20 calls)
     - PlaylistEditorPage.jsx (18 calls)
     - DataSourcesPage.jsx (16 calls)
     - CampaignEditorPage.jsx (16 calls)
     - Admin/AdminEditTemplatePage.jsx (14 calls)
     - LayoutEditorPage.jsx (12 calls)
     - PlaylistsPage.jsx (12 calls)
     - FeatureFlagsPage.jsx (12 calls)

3. Log level guidelines for UI code:
   - User actions: logger.info('Button clicked', { action })
   - Data loading: logger.debug('Loading data')
   - Errors: logger.error('Operation failed', { error })
   - Most routine UI logging can be logger.debug or removed entirely

4. Batch processing approach:
   - Process files alphabetically within each directory
   - For very large files (20+ calls), consider if all logs are necessary
   - Remove pure debugging logs that have no production value

5. Special handling:
   - HelpCenterPage.jsx already uses SafeHTML - logging is straightforward
   - Editor components may have canvas-related logs - keep as debug

Note: This is a large task. Focus on correctness over speed.
  </action>
  <verify>
1. `grep -r "console\." src/components/**/*.jsx | wc -l` returns 0
2. `grep -r "console\." src/pages/**/*.jsx | wc -l` returns 0
3. `npm run build` succeeds
4. `npm run lint` shows significantly fewer warnings
  </verify>
  <done>All components (39 files) and pages (54 files) migrated to structured logging</done>
</task>

</tasks>

<verification>
1. Total console calls in src/ (excluding services, which Plan 03+04 cover):
   `grep -r "console\." src/*.jsx src/*.js src/hooks src/components src/pages src/contexts src/player src/auth src/config src/utils src/security src/legacy src/i18n 2>/dev/null | grep -v node_modules | grep -v loggingService | wc -l`
   Should be 0 or near-zero

2. All React components import useLogger
3. All non-React files import createScopedLogger
4. `npm run build` succeeds
5. `npm run lint` shows dramatically fewer no-console warnings
</verification>

<success_criteria>
- Player.jsx, TV.jsx, App.jsx use structured logging
- All 12 hooks migrated
- All 39 components migrated
- All 54 pages migrated
- All utility files migrated
- Zero console.log calls in migrated files
- Build passes
</success_criteria>

<output>
After completion, create `.planning/phases/04-logging-migration/04-05-SUMMARY.md`
</output>
